24/01/2026 18:38:06 >> Namespace(dataset='physionet_2012', model='ablation_transformer_only', split_file='physionet_2012_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='/home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1', lr=0.0001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:0', seed=2026, transformer_hid_dim=64, transformer_num_layers=2, transformer_num_heads=4, transformer_dropout=0.1, fusion_hid_dim=256, fusion_dropout=0.2, logger=<utils.logger.Logger object at 0x7ef97501e140>)

24/01/2026 18:38:06 >> ============================================================
24/01/2026 18:38:06 >> Loading dataset...
24/01/2026 18:38:06 >> ============================================================

24/01/2026 18:38:06 >> Preparing dataset physionet_2012
24/01/2026 18:38:06 >> Using fold 1/5
24/01/2026 18:38:06 >> Loaded splits from physionet_2012_5fold.json
24/01/2026 18:38:07 >> # train, val, test TS: [7673, 1918, 2397]
24/01/2026 18:38:07 >> pos class weight: 6.0330
24/01/2026 18:38:07 >> % pos class in train, val, test splits: [0.1422, 0.1283, 0.1544]
24/01/2026 18:38:08 >> # static features: 8
24/01/2026 18:38:08 >> # TS variables (MedBiVT): 36
24/01/2026 18:38:10 >> # timesteps (MedBiVT): 49

24/01/2026 18:38:26 >> ============================================================
24/01/2026 18:38:26 >> Initializing ablation_transformer_only model...
24/01/2026 18:38:26 >> ============================================================

24/01/2026 18:38:26 >> Model details:
24/01/2026 18:38:26 >> # parameters: 200417
24/01/2026 18:38:26 >> # trainable parameters: 200417, 100.00%
24/01/2026 18:38:26 >> #params by dtype:
24/01/2026 18:38:26 >> torch.float32: 200417, 100.00%

24/01/2026 18:38:27 >> No. of training batches per epoch = 240

24/01/2026 18:38:27 >> ============================================================
24/01/2026 18:38:27 >>                Starting training...
24/01/2026 18:38:27 >> ============================================================
24/01/2026 18:38:27 >> >>> Epoch 1/20
24/01/2026 18:38:35 >> Epoch 1 completed | Avg Loss: 1.1387
24/01/2026 18:38:36 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.7177 | AUPRC: 0.2924 | MinRP: 0.3333
24/01/2026 18:38:37 >> VAL          Epoch:     1 | AUROC: 0.7166 | AUPRC: 0.2636 | MinRP: 0.3189
24/01/2026 18:38:37 >> AUPRC improved: 0.0000 ---> 0.2636 (+0.2636)
24/01/2026 18:38:37 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:38:37 >> ============================================================
24/01/2026 18:38:37 >> >>> Epoch 2/20
24/01/2026 18:38:46 >> Epoch 2 completed | Avg Loss: 0.9971
24/01/2026 18:38:47 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8130 | AUPRC: 0.4242 | MinRP: 0.4502
24/01/2026 18:38:47 >> VAL          Epoch:     2 | AUROC: 0.8036 | AUPRC: 0.3912 | MinRP: 0.4211
24/01/2026 18:38:47 >> AUPRC improved: 0.2636 ---> 0.3912 (+0.1276)
24/01/2026 18:38:47 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:38:47 >> ============================================================
24/01/2026 18:38:47 >> >>> Epoch 3/20
24/01/2026 18:38:56 >> Epoch 3 completed | Avg Loss: 0.8903
24/01/2026 18:38:57 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8398 | AUPRC: 0.4797 | MinRP: 0.4914
24/01/2026 18:38:58 >> VAL          Epoch:     3 | AUROC: 0.8308 | AUPRC: 0.4549 | MinRP: 0.4708
24/01/2026 18:38:58 >> AUPRC improved: 0.3912 ---> 0.4549 (+0.0637)
24/01/2026 18:38:58 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:38:58 >> ============================================================
24/01/2026 18:38:58 >> >>> Epoch 4/20
24/01/2026 18:39:06 >> Epoch 4 completed | Avg Loss: 0.8689
24/01/2026 18:39:07 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8484 | AUPRC: 0.4997 | MinRP: 0.4846
24/01/2026 18:39:08 >> VAL          Epoch:     4 | AUROC: 0.8377 | AUPRC: 0.4720 | MinRP: 0.4880
24/01/2026 18:39:08 >> AUPRC improved: 0.4549 ---> 0.4720 (+0.0171)
24/01/2026 18:39:08 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:39:08 >> ============================================================
24/01/2026 18:39:08 >> >>> Epoch 5/20
24/01/2026 18:39:17 >> Epoch 5 completed | Avg Loss: 0.8393
24/01/2026 18:39:18 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8551 | AUPRC: 0.5170 | MinRP: 0.5153
24/01/2026 18:39:18 >> VAL          Epoch:     5 | AUROC: 0.8444 | AUPRC: 0.4851 | MinRP: 0.4960
24/01/2026 18:39:18 >> AUPRC improved: 0.4720 ---> 0.4851 (+0.0131)
24/01/2026 18:39:18 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:39:18 >> ============================================================
24/01/2026 18:39:18 >> >>> Epoch 6/20
24/01/2026 18:39:27 >> Epoch 6 completed | Avg Loss: 0.8279
24/01/2026 18:39:28 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8594 | AUPRC: 0.5189 | MinRP: 0.5205
24/01/2026 18:39:29 >> VAL          Epoch:     6 | AUROC: 0.8491 | AUPRC: 0.5016 | MinRP: 0.5000
24/01/2026 18:39:29 >> AUPRC improved: 0.4851 ---> 0.5016 (+0.0166)
24/01/2026 18:39:29 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:39:29 >> ============================================================
24/01/2026 18:39:29 >> >>> Epoch 7/20
24/01/2026 18:39:37 >> Epoch 7 completed | Avg Loss: 0.8305
24/01/2026 18:39:38 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8627 | AUPRC: 0.5283 | MinRP: 0.5326
24/01/2026 18:39:39 >> VAL          Epoch:     7 | AUROC: 0.8488 | AUPRC: 0.5056 | MinRP: 0.5202
24/01/2026 18:39:39 >> AUPRC improved: 0.5016 ---> 0.5056 (+0.0039)
24/01/2026 18:39:39 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:39:39 >> ============================================================
24/01/2026 18:39:39 >> >>> Epoch 8/20
24/01/2026 18:39:48 >> Epoch 8 completed | Avg Loss: 0.8012
24/01/2026 18:39:49 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8660 | AUPRC: 0.5320 | MinRP: 0.5258
24/01/2026 18:39:49 >> VAL          Epoch:     8 | AUROC: 0.8520 | AUPRC: 0.5205 | MinRP: 0.5121
24/01/2026 18:39:49 >> AUPRC improved: 0.5056 ---> 0.5205 (+0.0149)
24/01/2026 18:39:49 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:39:49 >> ============================================================
24/01/2026 18:39:49 >> >>> Epoch 9/20
24/01/2026 18:39:58 >> Epoch 9 completed | Avg Loss: 0.8118
24/01/2026 18:39:59 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8692 | AUPRC: 0.5377 | MinRP: 0.5342
24/01/2026 18:40:00 >> VAL          Epoch:     9 | AUROC: 0.8541 | AUPRC: 0.5127 | MinRP: 0.5059
24/01/2026 18:40:00 >> No improvement. Wait: 4/5
24/01/2026 18:40:00 >> ============================================================
24/01/2026 18:40:00 >> >>> Epoch 10/20
24/01/2026 18:40:08 >> Epoch 10 completed | Avg Loss: 0.7932
24/01/2026 18:40:09 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8730 | AUPRC: 0.5428 | MinRP: 0.5395
24/01/2026 18:40:10 >> VAL          Epoch:    10 | AUROC: 0.8576 | AUPRC: 0.5173 | MinRP: 0.5101
24/01/2026 18:40:10 >> No improvement. Wait: 3/5
24/01/2026 18:40:10 >> ============================================================
24/01/2026 18:40:10 >> >>> Epoch 11/20
24/01/2026 18:40:19 >> Epoch 11 completed | Avg Loss: 0.7867
24/01/2026 18:40:20 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8751 | AUPRC: 0.5479 | MinRP: 0.5251
24/01/2026 18:40:21 >> VAL          Epoch:    11 | AUROC: 0.8579 | AUPRC: 0.5306 | MinRP: 0.5216
24/01/2026 18:40:21 >> AUPRC improved: 0.5205 ---> 0.5306 (+0.0101)
24/01/2026 18:40:21 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:40:21 >> ============================================================
24/01/2026 18:40:21 >> >>> Epoch 12/20
24/01/2026 18:40:29 >> Epoch 12 completed | Avg Loss: 0.7721
24/01/2026 18:40:30 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8767 | AUPRC: 0.5525 | MinRP: 0.5326
24/01/2026 18:40:31 >> VAL          Epoch:    12 | AUROC: 0.8587 | AUPRC: 0.5279 | MinRP: 0.5182
24/01/2026 18:40:31 >> No improvement. Wait: 4/5
24/01/2026 18:40:31 >> ============================================================
24/01/2026 18:40:31 >> >>> Epoch 13/20
24/01/2026 18:40:39 >> Epoch 13 completed | Avg Loss: 0.7817
24/01/2026 18:40:40 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8764 | AUPRC: 0.5469 | MinRP: 0.5326
24/01/2026 18:40:41 >> VAL          Epoch:    13 | AUROC: 0.8591 | AUPRC: 0.5311 | MinRP: 0.5142
24/01/2026 18:40:41 >> AUPRC improved: 0.5306 ---> 0.5311 (+0.0005)
24/01/2026 18:40:41 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:40:41 >> ============================================================
24/01/2026 18:40:41 >> >>> Epoch 14/20
24/01/2026 18:40:49 >> Epoch 14 completed | Avg Loss: 0.7897
24/01/2026 18:40:50 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8773 | AUPRC: 0.5443 | MinRP: 0.5351
24/01/2026 18:40:51 >> VAL          Epoch:    14 | AUROC: 0.8577 | AUPRC: 0.5269 | MinRP: 0.5160
24/01/2026 18:40:51 >> No improvement. Wait: 4/5
24/01/2026 18:40:51 >> ============================================================
24/01/2026 18:40:51 >> >>> Epoch 15/20
24/01/2026 18:41:00 >> Epoch 15 completed | Avg Loss: 0.7794
24/01/2026 18:41:01 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.8817 | AUPRC: 0.5574 | MinRP: 0.5464
24/01/2026 18:41:01 >> VAL          Epoch:    15 | AUROC: 0.8588 | AUPRC: 0.5289 | MinRP: 0.5061
24/01/2026 18:41:01 >> No improvement. Wait: 3/5
24/01/2026 18:41:01 >> ============================================================
24/01/2026 18:41:01 >> >>> Epoch 16/20
24/01/2026 18:41:10 >> Epoch 16 completed | Avg Loss: 0.7665
24/01/2026 18:41:11 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.8823 | AUPRC: 0.5574 | MinRP: 0.5395
24/01/2026 18:41:12 >> VAL          Epoch:    16 | AUROC: 0.8596 | AUPRC: 0.5283 | MinRP: 0.5122
24/01/2026 18:41:12 >> No improvement. Wait: 2/5
24/01/2026 18:41:12 >> ============================================================
24/01/2026 18:41:12 >> >>> Epoch 17/20
24/01/2026 18:41:20 >> Epoch 17 completed | Avg Loss: 0.7593
24/01/2026 18:41:21 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.8838 | AUPRC: 0.5645 | MinRP: 0.5377
24/01/2026 18:41:22 >> VAL          Epoch:    17 | AUROC: 0.8608 | AUPRC: 0.5317 | MinRP: 0.5122
24/01/2026 18:41:22 >> AUPRC improved: 0.5311 ---> 0.5317 (+0.0006)
24/01/2026 18:41:22 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:41:22 >> ============================================================
24/01/2026 18:41:22 >> >>> Epoch 18/20
24/01/2026 18:41:30 >> Epoch 18 completed | Avg Loss: 0.7618
24/01/2026 18:41:31 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.8840 | AUPRC: 0.5617 | MinRP: 0.5464
24/01/2026 18:41:32 >> VAL          Epoch:    18 | AUROC: 0.8598 | AUPRC: 0.5337 | MinRP: 0.5095
24/01/2026 18:41:32 >> AUPRC improved: 0.5317 ---> 0.5337 (+0.0020)
24/01/2026 18:41:32 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:41:32 >> ============================================================
24/01/2026 18:41:32 >> >>> Epoch 19/20
24/01/2026 18:41:41 >> Epoch 19 completed | Avg Loss: 0.7570
24/01/2026 18:41:42 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.8859 | AUPRC: 0.5647 | MinRP: 0.5395
24/01/2026 18:41:42 >> VAL          Epoch:    19 | AUROC: 0.8613 | AUPRC: 0.5326 | MinRP: 0.5020
24/01/2026 18:41:42 >> No improvement. Wait: 4/5
24/01/2026 18:41:42 >> ============================================================
24/01/2026 18:41:42 >> >>> Epoch 20/20
24/01/2026 18:41:51 >> Epoch 20 completed | Avg Loss: 0.7510
24/01/2026 18:41:52 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.8862 | AUPRC: 0.5635 | MinRP: 0.5361
24/01/2026 18:41:53 >> VAL          Epoch:    20 | AUROC: 0.8612 | AUPRC: 0.5358 | MinRP: 0.5195
24/01/2026 18:41:53 >> AUPRC improved: 0.5337 ---> 0.5358 (+0.0021)
24/01/2026 18:41:53 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:41:53 >> ============================================================

24/01/2026 18:41:53 >> ============================================================
24/01/2026 18:41:53 >> TRAINING COMPLETED
24/01/2026 18:41:53 >> ============================================================
24/01/2026 18:41:53 >> Best Validation Results:
24/01/2026 18:41:53 >>   AUROC: 0.8612 | AUPRC: 0.5358 | MinRP: 0.5195
24/01/2026 18:41:53 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_transformer_only|fold:1/checkpoint_best.bin
24/01/2026 18:41:53 >> Evaluating on test set...
24/01/2026 18:41:54 >> TEST         AUROC: 0.8670 | AUPRC: 0.5788 | MinRP: 0.5649 | Accuracy: 0.8081

24/01/2026 18:41:54 >> ============================================================
24/01/2026 18:41:54 >> Classification Report:
24/01/2026 18:41:54 >>               precision    recall  f1-score   support
24/01/2026 18:41:54 >> 
24/01/2026 18:41:54 >>          0.0     0.9434    0.8224    0.8788      2027
24/01/2026 18:41:54 >>          1.0     0.4286    0.7297    0.5400       370
24/01/2026 18:41:54 >> 
24/01/2026 18:41:54 >>     accuracy                         0.8081      2397
24/01/2026 18:41:54 >>    macro avg     0.6860    0.7761    0.7094      2397
24/01/2026 18:41:54 >> weighted avg     0.8639    0.8081    0.8265      2397
24/01/2026 18:41:54 >> 
24/01/2026 18:41:54 >> Confusion Matrix:
24/01/2026 18:41:54 >> [1667, 360]
24/01/2026 18:41:54 >> [100, 270]
24/01/2026 18:41:54 >> ============================================================
24/01/2026 18:41:54 >> ============================================================
24/01/2026 18:41:54 >> Final Test Results:
24/01/2026 18:41:54 >>   AUROC: 0.8670 | AUPRC: 0.5788 | MinRP: 0.5649 | Accuracy: 0.8081
24/01/2026 18:41:54 >> ============================================================
