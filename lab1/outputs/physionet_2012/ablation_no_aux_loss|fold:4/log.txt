24/01/2026 18:52:39 >> Namespace(dataset='physionet_2012', model='ablation_no_aux_loss', split_file='physionet_2012_5fold.json', fold=4, root_dir='/home/xiejun/codeLib/miccai', output_dir='/home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4', lr=0.0001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, gru_hid_dim=256, gru_dropout=0.2, transformer_hid_dim=64, transformer_num_layers=2, transformer_num_heads=4, transformer_dropout=0.1, fusion_hid_dim=256, fusion_dropout=0.2, use_parallel=True, logger=<utils.logger.Logger object at 0x74752b41e140>)

24/01/2026 18:52:39 >> ============================================================
24/01/2026 18:52:39 >> Loading dataset...
24/01/2026 18:52:39 >> ============================================================

24/01/2026 18:52:39 >> Preparing dataset physionet_2012
24/01/2026 18:52:39 >> Using fold 4/5
24/01/2026 18:52:39 >> Loaded splits from physionet_2012_5fold.json
24/01/2026 18:52:40 >> # train, val, test TS: [7673, 1918, 2397]
24/01/2026 18:52:40 >> pos class weight: 6.0201
24/01/2026 18:52:40 >> % pos class in train, val, test splits: [0.1424, 0.1423, 0.1423]
24/01/2026 18:52:41 >> # static features: 8
24/01/2026 18:52:41 >> # TS variables (MedBiVT): 36
24/01/2026 18:52:43 >> # timesteps (MedBiVT): 49

24/01/2026 18:53:00 >> ============================================================
24/01/2026 18:53:00 >> Initializing ablation_no_aux_loss model...
24/01/2026 18:53:00 >> ============================================================

24/01/2026 18:53:00 >> Model details:
24/01/2026 18:53:00 >> # parameters: 703849
24/01/2026 18:53:00 >> # trainable parameters: 703849, 100.00%
24/01/2026 18:53:00 >> #params by dtype:
24/01/2026 18:53:00 >> torch.float32: 703849, 100.00%

24/01/2026 18:53:00 >> No. of training batches per epoch = 240

24/01/2026 18:53:00 >> ============================================================
24/01/2026 18:53:00 >>                Starting training...
24/01/2026 18:53:00 >> ============================================================
24/01/2026 18:53:00 >> >>> Epoch 1/20
24/01/2026 18:53:15 >> Epoch 1 completed | Avg Loss: 1.0239
24/01/2026 18:53:17 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8416 | AUPRC: 0.5129 | MinRP: 0.4933
24/01/2026 18:53:17 >> VAL          Epoch:     1 | AUROC: 0.8238 | AUPRC: 0.4638 | MinRP: 0.4762
24/01/2026 18:53:17 >> AUPRC improved: 0.0000 ---> 0.4638 (+0.4638)
24/01/2026 18:53:17 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:53:17 >> ============================================================
24/01/2026 18:53:17 >> >>> Epoch 2/20
24/01/2026 18:53:30 >> Epoch 2 completed | Avg Loss: 0.8725
24/01/2026 18:53:30 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8539 | AUPRC: 0.5517 | MinRP: 0.5033
24/01/2026 18:53:31 >> VAL          Epoch:     2 | AUROC: 0.8349 | AUPRC: 0.5090 | MinRP: 0.4982
24/01/2026 18:53:31 >> AUPRC improved: 0.4638 ---> 0.5090 (+0.0452)
24/01/2026 18:53:31 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:53:31 >> ============================================================
24/01/2026 18:53:31 >> >>> Epoch 3/20
24/01/2026 18:53:44 >> Epoch 3 completed | Avg Loss: 0.8549
24/01/2026 18:53:45 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8608 | AUPRC: 0.5647 | MinRP: 0.5133
24/01/2026 18:53:46 >> VAL          Epoch:     3 | AUROC: 0.8409 | AUPRC: 0.5241 | MinRP: 0.5018
24/01/2026 18:53:46 >> AUPRC improved: 0.5090 ---> 0.5241 (+0.0151)
24/01/2026 18:53:46 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:53:46 >> ============================================================
24/01/2026 18:53:46 >> >>> Epoch 4/20
24/01/2026 18:53:58 >> Epoch 4 completed | Avg Loss: 0.8511
24/01/2026 18:53:59 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8663 | AUPRC: 0.5703 | MinRP: 0.5265
24/01/2026 18:54:00 >> VAL          Epoch:     4 | AUROC: 0.8455 | AUPRC: 0.5295 | MinRP: 0.4964
24/01/2026 18:54:00 >> AUPRC improved: 0.5241 ---> 0.5295 (+0.0054)
24/01/2026 18:54:00 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:54:00 >> ============================================================
24/01/2026 18:54:00 >> >>> Epoch 5/20
24/01/2026 18:54:12 >> Epoch 5 completed | Avg Loss: 0.8247
24/01/2026 18:54:13 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8706 | AUPRC: 0.5799 | MinRP: 0.5400
24/01/2026 18:54:13 >> VAL          Epoch:     5 | AUROC: 0.8518 | AUPRC: 0.5469 | MinRP: 0.4982
24/01/2026 18:54:13 >> AUPRC improved: 0.5295 ---> 0.5469 (+0.0174)
24/01/2026 18:54:13 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:54:13 >> ============================================================
24/01/2026 18:54:13 >> >>> Epoch 6/20
24/01/2026 18:54:26 >> Epoch 6 completed | Avg Loss: 0.7936
24/01/2026 18:54:27 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8748 | AUPRC: 0.5859 | MinRP: 0.5300
24/01/2026 18:54:27 >> VAL          Epoch:     6 | AUROC: 0.8519 | AUPRC: 0.5409 | MinRP: 0.5055
24/01/2026 18:54:27 >> No improvement. Wait: 4/5
24/01/2026 18:54:27 >> ============================================================
24/01/2026 18:54:27 >> >>> Epoch 7/20
24/01/2026 18:54:40 >> Epoch 7 completed | Avg Loss: 0.7824
24/01/2026 18:54:41 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8754 | AUPRC: 0.5913 | MinRP: 0.5300
24/01/2026 18:54:41 >> VAL          Epoch:     7 | AUROC: 0.8505 | AUPRC: 0.5336 | MinRP: 0.5238
24/01/2026 18:54:41 >> No improvement. Wait: 3/5
24/01/2026 18:54:41 >> ============================================================
24/01/2026 18:54:41 >> >>> Epoch 8/20
24/01/2026 18:54:54 >> Epoch 8 completed | Avg Loss: 0.7732
24/01/2026 18:54:55 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8822 | AUPRC: 0.6036 | MinRP: 0.5600
24/01/2026 18:54:55 >> VAL          Epoch:     8 | AUROC: 0.8542 | AUPRC: 0.5479 | MinRP: 0.5201
24/01/2026 18:54:55 >> AUPRC improved: 0.5469 ---> 0.5479 (+0.0010)
24/01/2026 18:54:55 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:54:55 >> ============================================================
24/01/2026 18:54:55 >> >>> Epoch 9/20
24/01/2026 18:55:08 >> Epoch 9 completed | Avg Loss: 0.7708
24/01/2026 18:55:09 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8855 | AUPRC: 0.6139 | MinRP: 0.5578
24/01/2026 18:55:09 >> VAL          Epoch:     9 | AUROC: 0.8598 | AUPRC: 0.5514 | MinRP: 0.5348
24/01/2026 18:55:09 >> AUPRC improved: 0.5479 ---> 0.5514 (+0.0035)
24/01/2026 18:55:09 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:55:09 >> ============================================================
24/01/2026 18:55:09 >> >>> Epoch 10/20
24/01/2026 18:55:22 >> Epoch 10 completed | Avg Loss: 0.7423
24/01/2026 18:55:22 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8884 | AUPRC: 0.6218 | MinRP: 0.5776
24/01/2026 18:55:23 >> VAL          Epoch:    10 | AUROC: 0.8627 | AUPRC: 0.5615 | MinRP: 0.5458
24/01/2026 18:55:23 >> AUPRC improved: 0.5514 ---> 0.5615 (+0.0100)
24/01/2026 18:55:23 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:55:23 >> ============================================================
24/01/2026 18:55:23 >> >>> Epoch 11/20
24/01/2026 18:55:35 >> Epoch 11 completed | Avg Loss: 0.7362
24/01/2026 18:55:36 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8929 | AUPRC: 0.6281 | MinRP: 0.5861
24/01/2026 18:55:37 >> VAL          Epoch:    11 | AUROC: 0.8606 | AUPRC: 0.5630 | MinRP: 0.5458
24/01/2026 18:55:37 >> AUPRC improved: 0.5615 ---> 0.5630 (+0.0016)
24/01/2026 18:55:37 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:55:37 >> ============================================================
24/01/2026 18:55:37 >> >>> Epoch 12/20
24/01/2026 18:55:49 >> Epoch 12 completed | Avg Loss: 0.7312
24/01/2026 18:55:50 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8952 | AUPRC: 0.6318 | MinRP: 0.5880
24/01/2026 18:55:51 >> VAL          Epoch:    12 | AUROC: 0.8621 | AUPRC: 0.5642 | MinRP: 0.5495
24/01/2026 18:55:51 >> AUPRC improved: 0.5630 ---> 0.5642 (+0.0011)
24/01/2026 18:55:51 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:55:51 >> ============================================================
24/01/2026 18:55:51 >> >>> Epoch 13/20
24/01/2026 18:56:03 >> Epoch 13 completed | Avg Loss: 0.7214
24/01/2026 18:56:04 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8982 | AUPRC: 0.6422 | MinRP: 0.5933
24/01/2026 18:56:05 >> VAL          Epoch:    13 | AUROC: 0.8641 | AUPRC: 0.5735 | MinRP: 0.5365
24/01/2026 18:56:05 >> AUPRC improved: 0.5642 ---> 0.5735 (+0.0093)
24/01/2026 18:56:05 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:56:05 >> ============================================================
24/01/2026 18:56:05 >> >>> Epoch 14/20
24/01/2026 18:56:17 >> Epoch 14 completed | Avg Loss: 0.7106
24/01/2026 18:56:18 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9010 | AUPRC: 0.6443 | MinRP: 0.5867
24/01/2026 18:56:19 >> VAL          Epoch:    14 | AUROC: 0.8633 | AUPRC: 0.5689 | MinRP: 0.5426
24/01/2026 18:56:19 >> No improvement. Wait: 4/5
24/01/2026 18:56:19 >> ============================================================
24/01/2026 18:56:19 >> >>> Epoch 15/20
24/01/2026 18:56:31 >> Epoch 15 completed | Avg Loss: 0.7117
24/01/2026 18:56:32 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9006 | AUPRC: 0.6482 | MinRP: 0.5933
24/01/2026 18:56:33 >> VAL          Epoch:    15 | AUROC: 0.8645 | AUPRC: 0.5679 | MinRP: 0.5421
24/01/2026 18:56:33 >> No improvement. Wait: 3/5
24/01/2026 18:56:33 >> ============================================================
24/01/2026 18:56:33 >> >>> Epoch 16/20
24/01/2026 18:56:45 >> Epoch 16 completed | Avg Loss: 0.6993
24/01/2026 18:56:46 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9049 | AUPRC: 0.6523 | MinRP: 0.5941
24/01/2026 18:56:47 >> VAL          Epoch:    16 | AUROC: 0.8614 | AUPRC: 0.5684 | MinRP: 0.5435
24/01/2026 18:56:47 >> No improvement. Wait: 2/5
24/01/2026 18:56:47 >> ============================================================
24/01/2026 18:56:47 >> >>> Epoch 17/20
24/01/2026 18:56:59 >> Epoch 17 completed | Avg Loss: 0.6983
24/01/2026 18:56:59 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9048 | AUPRC: 0.6531 | MinRP: 0.5933
24/01/2026 18:57:00 >> VAL          Epoch:    17 | AUROC: 0.8626 | AUPRC: 0.5629 | MinRP: 0.5238
24/01/2026 18:57:00 >> No improvement. Wait: 1/5
24/01/2026 18:57:00 >> ============================================================
24/01/2026 18:57:00 >> >>> Epoch 18/20
24/01/2026 18:57:12 >> Epoch 18 completed | Avg Loss: 0.7017
24/01/2026 18:57:12 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9067 | AUPRC: 0.6517 | MinRP: 0.5933
24/01/2026 18:57:13 >> VAL          Epoch:    18 | AUROC: 0.8603 | AUPRC: 0.5539 | MinRP: 0.5311
24/01/2026 18:57:13 >> No improvement. Wait: 0/5
24/01/2026 18:57:13 >> Patience reached. Early stopping.

24/01/2026 18:57:13 >> ============================================================
24/01/2026 18:57:13 >> TRAINING COMPLETED
24/01/2026 18:57:13 >> ============================================================
24/01/2026 18:57:13 >> Best Validation Results:
24/01/2026 18:57:13 >>   AUROC: 0.8641 | AUPRC: 0.5735 | MinRP: 0.5365
24/01/2026 18:57:13 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ablation_no_aux_loss|fold:4/checkpoint_best.bin
24/01/2026 18:57:13 >> Evaluating on test set...
24/01/2026 18:57:14 >> TEST         AUROC: 0.8564 | AUPRC: 0.5098 | MinRP: 0.5367 | Accuracy: 0.7605

24/01/2026 18:57:14 >> ============================================================
24/01/2026 18:57:14 >> Classification Report:
24/01/2026 18:57:14 >>               precision    recall  f1-score   support
24/01/2026 18:57:14 >> 
24/01/2026 18:57:14 >>          0.0     0.9574    0.7544    0.8439      2056
24/01/2026 18:57:14 >>          1.0     0.3501    0.7977    0.4866       341
24/01/2026 18:57:14 >> 
24/01/2026 18:57:14 >>     accuracy                         0.7605      2397
24/01/2026 18:57:14 >>    macro avg     0.6537    0.7760    0.6652      2397
24/01/2026 18:57:14 >> weighted avg     0.8710    0.7605    0.7930      2397
24/01/2026 18:57:14 >> 
24/01/2026 18:57:14 >> Confusion Matrix:
24/01/2026 18:57:14 >> [1551, 505]
24/01/2026 18:57:14 >> [69, 272]
24/01/2026 18:57:14 >> ============================================================
24/01/2026 18:57:14 >> ============================================================
24/01/2026 18:57:14 >> Final Test Results:
24/01/2026 18:57:14 >>   AUROC: 0.8564 | AUPRC: 0.5098 | MinRP: 0.5367 | Accuracy: 0.7605
24/01/2026 18:57:14 >> ============================================================
