25/01/2026 16:16:48 >> Namespace(dataset='mimic_iii', model='ours1', split_file='mimic_iii_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='/home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1', lr=0.0003, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:0', seed=2026, grud_hid_dim=128, grud_dropout=0.2, transformer_hid_dim=64, transformer_num_layers=4, transformer_num_heads=4, transformer_dropout=0.2, fusion_hid_dim=256, fusion_dropout=0.15, lambda_aux=1.0, lambda_cos=0.7, logger=<utils.logger.Logger object at 0x7fac0ec1e140>)

25/01/2026 16:16:48 >> ============================================================
25/01/2026 16:16:48 >> Loading dataset...
25/01/2026 16:16:48 >> ============================================================

25/01/2026 16:16:48 >> Preparing dataset mimic_iii
25/01/2026 16:16:52 >> Using fold 1/5
25/01/2026 16:16:52 >> Loaded splits from mimic_iii_5fold.json
25/01/2026 16:17:20 >> # train, val, test TS: [33817, 8471, 10583]
25/01/2026 16:17:42 >> pos class weight: 7.1487
25/01/2026 16:17:42 >> % pos class in train, val, test splits: [0.1227, 0.1277, 0.1204]
25/01/2026 16:17:44 >> # static features: 3
25/01/2026 16:17:45 >> # TS variables (MedBiVT): 127
25/01/2026 16:17:52 >> # timesteps (MedBiVT): 25

25/01/2026 16:19:38 >> ============================================================
25/01/2026 16:19:38 >> Initializing ours1 model...
25/01/2026 16:19:38 >> ============================================================

25/01/2026 16:19:39 >> Model details:
25/01/2026 16:19:39 >> # parameters: 575905
25/01/2026 16:19:39 >> # trainable parameters: 575905, 100.00%
25/01/2026 16:19:39 >> #params by dtype:
25/01/2026 16:19:39 >> torch.float32: 575905, 100.00%

25/01/2026 16:19:39 >> No. of training batches per epoch = 1057

25/01/2026 16:19:39 >> ============================================================
25/01/2026 16:19:39 >>                Starting training...
25/01/2026 16:19:39 >> ============================================================
25/01/2026 16:19:39 >> >>> Epoch 1/20
25/01/2026 16:22:59 >> Epoch 1 completed | Avg Loss: 2.4734
25/01/2026 16:23:05 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9215 | AUPRC: 0.7090 | MinRP: 0.6356
25/01/2026 16:23:21 >> VAL          Epoch:     1 | AUROC: 0.9043 | AUPRC: 0.6566 | MinRP: 0.5924
25/01/2026 16:23:21 >> AUPRC improved: 0.0000 ---> 0.6566 (+0.6566)
25/01/2026 16:23:21 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
25/01/2026 16:23:21 >> ============================================================
25/01/2026 16:23:21 >> >>> Epoch 2/20
25/01/2026 16:26:43 >> Epoch 2 completed | Avg Loss: 2.2222
25/01/2026 16:26:47 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9268 | AUPRC: 0.7279 | MinRP: 0.6478
25/01/2026 16:27:05 >> VAL          Epoch:     2 | AUROC: 0.9080 | AUPRC: 0.6691 | MinRP: 0.5980
25/01/2026 16:27:05 >> AUPRC improved: 0.6566 ---> 0.6691 (+0.0125)
25/01/2026 16:27:05 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
25/01/2026 16:27:05 >> ============================================================
25/01/2026 16:27:05 >> >>> Epoch 3/20
25/01/2026 16:30:26 >> Epoch 3 completed | Avg Loss: 2.1434
25/01/2026 16:30:30 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9281 | AUPRC: 0.7317 | MinRP: 0.6446
25/01/2026 16:30:47 >> VAL          Epoch:     3 | AUROC: 0.9079 | AUPRC: 0.6744 | MinRP: 0.6054
25/01/2026 16:30:47 >> AUPRC improved: 0.6691 ---> 0.6744 (+0.0053)
25/01/2026 16:30:47 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
25/01/2026 16:30:47 >> ============================================================
25/01/2026 16:30:47 >> >>> Epoch 4/20
25/01/2026 16:34:10 >> Epoch 4 completed | Avg Loss: 2.1154
25/01/2026 16:34:14 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9331 | AUPRC: 0.7463 | MinRP: 0.6709
25/01/2026 16:34:32 >> VAL          Epoch:     4 | AUROC: 0.9077 | AUPRC: 0.6800 | MinRP: 0.6061
25/01/2026 16:34:32 >> AUPRC improved: 0.6744 ---> 0.6800 (+0.0057)
25/01/2026 16:34:32 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
25/01/2026 16:34:32 >> ============================================================
25/01/2026 16:34:32 >> >>> Epoch 5/20
25/01/2026 16:37:53 >> Epoch 5 completed | Avg Loss: 2.0752
25/01/2026 16:37:58 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9345 | AUPRC: 0.7492 | MinRP: 0.6751
25/01/2026 16:38:15 >> VAL          Epoch:     5 | AUROC: 0.9078 | AUPRC: 0.6773 | MinRP: 0.6081
25/01/2026 16:38:15 >> No improvement. Wait: 4/5
25/01/2026 16:38:15 >> ============================================================
25/01/2026 16:38:15 >> >>> Epoch 6/20
25/01/2026 16:41:37 >> Epoch 6 completed | Avg Loss: 2.0420
25/01/2026 16:41:42 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9379 | AUPRC: 0.7582 | MinRP: 0.6708
25/01/2026 16:41:59 >> VAL          Epoch:     6 | AUROC: 0.9134 | AUPRC: 0.6911 | MinRP: 0.6127
25/01/2026 16:41:59 >> AUPRC improved: 0.6800 ---> 0.6911 (+0.0110)
25/01/2026 16:41:59 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
25/01/2026 16:41:59 >> ============================================================
25/01/2026 16:41:59 >> >>> Epoch 7/20
25/01/2026 16:45:24 >> Epoch 7 completed | Avg Loss: 2.0203
25/01/2026 16:45:28 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9405 | AUPRC: 0.7594 | MinRP: 0.6822
25/01/2026 16:45:45 >> VAL          Epoch:     7 | AUROC: 0.9108 | AUPRC: 0.6836 | MinRP: 0.6072
25/01/2026 16:45:45 >> No improvement. Wait: 4/5
25/01/2026 16:45:45 >> ============================================================
25/01/2026 16:45:45 >> >>> Epoch 8/20
25/01/2026 16:49:07 >> Epoch 8 completed | Avg Loss: 2.0095
25/01/2026 16:49:12 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9396 | AUPRC: 0.7675 | MinRP: 0.6780
25/01/2026 16:49:29 >> VAL          Epoch:     8 | AUROC: 0.9116 | AUPRC: 0.6902 | MinRP: 0.6118
25/01/2026 16:49:29 >> No improvement. Wait: 3/5
25/01/2026 16:49:29 >> ============================================================
25/01/2026 16:49:29 >> >>> Epoch 9/20
25/01/2026 16:52:53 >> Epoch 9 completed | Avg Loss: 1.9703
25/01/2026 16:52:57 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9415 | AUPRC: 0.7721 | MinRP: 0.6933
25/01/2026 16:53:14 >> VAL          Epoch:     9 | AUROC: 0.9105 | AUPRC: 0.6874 | MinRP: 0.6128
25/01/2026 16:53:14 >> No improvement. Wait: 2/5
25/01/2026 16:53:14 >> ============================================================
25/01/2026 16:53:14 >> >>> Epoch 10/20
25/01/2026 16:56:38 >> Epoch 10 completed | Avg Loss: 1.9519
25/01/2026 16:56:42 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9447 | AUPRC: 0.7869 | MinRP: 0.7119
25/01/2026 16:57:00 >> VAL          Epoch:    10 | AUROC: 0.9123 | AUPRC: 0.6932 | MinRP: 0.6128
25/01/2026 16:57:00 >> AUPRC improved: 0.6911 ---> 0.6932 (+0.0022)
25/01/2026 16:57:00 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
25/01/2026 16:57:00 >> ============================================================
25/01/2026 16:57:00 >> >>> Epoch 11/20
25/01/2026 17:00:23 >> Epoch 11 completed | Avg Loss: 1.9385
25/01/2026 17:00:28 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9463 | AUPRC: 0.7841 | MinRP: 0.7034
25/01/2026 17:00:45 >> VAL          Epoch:    11 | AUROC: 0.9130 | AUPRC: 0.6912 | MinRP: 0.6133
25/01/2026 17:00:45 >> No improvement. Wait: 4/5
25/01/2026 17:00:45 >> ============================================================
25/01/2026 17:00:45 >> >>> Epoch 12/20
25/01/2026 17:04:09 >> Epoch 12 completed | Avg Loss: 1.9243
25/01/2026 17:04:13 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9498 | AUPRC: 0.7909 | MinRP: 0.7119
25/01/2026 17:04:31 >> VAL          Epoch:    12 | AUROC: 0.9115 | AUPRC: 0.6936 | MinRP: 0.6072
25/01/2026 17:04:31 >> AUPRC improved: 0.6932 ---> 0.6936 (+0.0004)
25/01/2026 17:04:31 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
25/01/2026 17:04:31 >> ============================================================
25/01/2026 17:04:31 >> >>> Epoch 13/20
25/01/2026 17:07:55 >> Epoch 13 completed | Avg Loss: 1.8913
25/01/2026 17:07:59 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9513 | AUPRC: 0.7985 | MinRP: 0.7203
25/01/2026 17:08:16 >> VAL          Epoch:    13 | AUROC: 0.9114 | AUPRC: 0.6943 | MinRP: 0.6128
25/01/2026 17:08:16 >> AUPRC improved: 0.6936 ---> 0.6943 (+0.0007)
25/01/2026 17:08:16 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
25/01/2026 17:08:16 >> ============================================================
25/01/2026 17:08:16 >> >>> Epoch 14/20
25/01/2026 17:11:40 >> Epoch 14 completed | Avg Loss: 1.8702
25/01/2026 17:11:45 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9527 | AUPRC: 0.8003 | MinRP: 0.7373
25/01/2026 17:12:02 >> VAL          Epoch:    14 | AUROC: 0.9132 | AUPRC: 0.6979 | MinRP: 0.6174
25/01/2026 17:12:02 >> AUPRC improved: 0.6943 ---> 0.6979 (+0.0035)
25/01/2026 17:12:02 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
25/01/2026 17:12:02 >> ============================================================
25/01/2026 17:12:02 >> >>> Epoch 15/20
25/01/2026 17:15:26 >> Epoch 15 completed | Avg Loss: 1.8533
25/01/2026 17:15:30 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9569 | AUPRC: 0.8127 | MinRP: 0.7373
25/01/2026 17:15:48 >> VAL          Epoch:    15 | AUROC: 0.9143 | AUPRC: 0.6966 | MinRP: 0.6201
25/01/2026 17:15:48 >> No improvement. Wait: 4/5
25/01/2026 17:15:48 >> ============================================================
25/01/2026 17:15:48 >> >>> Epoch 16/20
25/01/2026 17:19:13 >> Epoch 16 completed | Avg Loss: 1.8456
25/01/2026 17:19:17 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9601 | AUPRC: 0.8234 | MinRP: 0.7458
25/01/2026 17:19:35 >> VAL          Epoch:    16 | AUROC: 0.9121 | AUPRC: 0.6888 | MinRP: 0.6103
25/01/2026 17:19:35 >> No improvement. Wait: 3/5
25/01/2026 17:19:35 >> ============================================================
25/01/2026 17:19:35 >> >>> Epoch 17/20
25/01/2026 17:22:59 >> Epoch 17 completed | Avg Loss: 1.8355
25/01/2026 17:23:03 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9598 | AUPRC: 0.8251 | MinRP: 0.7468
25/01/2026 17:23:21 >> VAL          Epoch:    17 | AUROC: 0.9121 | AUPRC: 0.6912 | MinRP: 0.6103
25/01/2026 17:23:21 >> No improvement. Wait: 2/5
25/01/2026 17:23:21 >> ============================================================
25/01/2026 17:23:21 >> >>> Epoch 18/20
25/01/2026 17:26:48 >> Epoch 18 completed | Avg Loss: 1.8002
25/01/2026 17:26:52 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9665 | AUPRC: 0.8451 | MinRP: 0.7797
25/01/2026 17:27:09 >> VAL          Epoch:    18 | AUROC: 0.9102 | AUPRC: 0.6900 | MinRP: 0.6072
25/01/2026 17:27:09 >> No improvement. Wait: 1/5
25/01/2026 17:27:09 >> ============================================================
25/01/2026 17:27:09 >> >>> Epoch 19/20
25/01/2026 17:30:36 >> Epoch 19 completed | Avg Loss: 1.7930
25/01/2026 17:30:40 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9671 | AUPRC: 0.8488 | MinRP: 0.7712
25/01/2026 17:30:58 >> VAL          Epoch:    19 | AUROC: 0.9124 | AUPRC: 0.6905 | MinRP: 0.6098
25/01/2026 17:30:58 >> No improvement. Wait: 0/5
25/01/2026 17:30:58 >> Patience reached. Early stopping.

25/01/2026 17:30:58 >> ============================================================
25/01/2026 17:30:58 >> TRAINING COMPLETED
25/01/2026 17:30:58 >> ============================================================
25/01/2026 17:30:58 >> Best Validation Results:
25/01/2026 17:30:58 >>   AUROC: 0.9132 | AUPRC: 0.6979 | MinRP: 0.6174
25/01/2026 17:30:58 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
25/01/2026 17:30:58 >> Evaluating on test set...
25/01/2026 17:31:20 >> TEST         AUROC: 0.9113 | AUPRC: 0.6821 | MinRP: 0.6047 | Accuracy: 0.8797

25/01/2026 17:31:20 >> ============================================================
25/01/2026 17:31:20 >> Classification Report:
25/01/2026 17:31:20 >>               precision    recall  f1-score   support
25/01/2026 17:31:20 >> 
25/01/2026 17:31:20 >>          0.0     0.9596    0.9012    0.9295      9309
25/01/2026 17:31:20 >>          1.0     0.5003    0.7229    0.5913      1274
25/01/2026 17:31:20 >> 
25/01/2026 17:31:20 >>     accuracy                         0.8797     10583
25/01/2026 17:31:20 >>    macro avg     0.7299    0.8120    0.7604     10583
25/01/2026 17:31:20 >> weighted avg     0.9043    0.8797    0.8888     10583
25/01/2026 17:31:20 >> 
25/01/2026 17:31:20 >> Confusion Matrix:
25/01/2026 17:31:20 >> [8389, 920]
25/01/2026 17:31:20 >> [353, 921]
25/01/2026 17:31:20 >> ============================================================
25/01/2026 17:31:20 >> ============================================================
25/01/2026 17:31:20 >> Final Test Results:
25/01/2026 17:31:20 >>   AUROC: 0.9113 | AUPRC: 0.6821 | MinRP: 0.6047 | Accuracy: 0.8797
25/01/2026 17:31:20 >> ============================================================
26/01/2026 10:11:37 >> Namespace(dataset='mimic_iii', model='ours1', split_file='mimic_iii_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='/home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1', lr=0.0003, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:0', seed=2026, grud_hid_dim=128, grud_dropout=0.2, transformer_hid_dim=64, transformer_num_layers=4, transformer_num_heads=4, transformer_dropout=0.2, fusion_hid_dim=256, fusion_dropout=0.1, lambda_aux=0.8, lambda_cos=0.6, logger=<utils.logger.Logger object at 0x702f8bba7fa0>)

26/01/2026 10:11:37 >> ============================================================
26/01/2026 10:11:37 >> Loading dataset...
26/01/2026 10:11:37 >> ============================================================

26/01/2026 10:11:37 >> Preparing dataset mimic_iii
26/01/2026 10:11:41 >> Using fold 1/5
26/01/2026 10:11:41 >> Loaded splits from mimic_iii_5fold.json
26/01/2026 10:12:07 >> # train, val, test TS: [33817, 8471, 10583]
26/01/2026 10:12:28 >> pos class weight: 7.1487
26/01/2026 10:12:28 >> % pos class in train, val, test splits: [0.1227, 0.1277, 0.1204]
26/01/2026 10:12:29 >> # static features: 3
26/01/2026 10:12:30 >> # TS variables (MedBiVT): 127
26/01/2026 10:12:37 >> # timesteps (MedBiVT): 25

26/01/2026 10:14:16 >> ============================================================
26/01/2026 10:14:16 >> Initializing ours1 model...
26/01/2026 10:14:16 >> ============================================================

26/01/2026 10:14:16 >> Model details:
26/01/2026 10:14:16 >> # parameters: 575905
26/01/2026 10:14:16 >> # trainable parameters: 575905, 100.00%
26/01/2026 10:14:16 >> #params by dtype:
26/01/2026 10:14:16 >> torch.float32: 575905, 100.00%

26/01/2026 10:14:16 >> No. of training batches per epoch = 1057

26/01/2026 10:14:16 >> ============================================================
26/01/2026 10:14:16 >>                Starting training...
26/01/2026 10:14:16 >> ============================================================
26/01/2026 10:14:16 >> >>> Epoch 1/20
26/01/2026 10:17:41 >> Epoch 1 completed | Avg Loss: 2.1353
26/01/2026 10:17:46 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9220 | AUPRC: 0.7098 | MinRP: 0.6356
26/01/2026 10:18:03 >> VAL          Epoch:     1 | AUROC: 0.9044 | AUPRC: 0.6568 | MinRP: 0.5917
26/01/2026 10:18:03 >> AUPRC improved: 0.0000 ---> 0.6568 (+0.6568)
26/01/2026 10:18:03 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:18:03 >> ============================================================
26/01/2026 10:18:03 >> >>> Epoch 2/20
26/01/2026 10:21:27 >> Epoch 2 completed | Avg Loss: 1.9218
26/01/2026 10:21:31 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9268 | AUPRC: 0.7298 | MinRP: 0.6568
26/01/2026 10:21:48 >> VAL          Epoch:     2 | AUROC: 0.9079 | AUPRC: 0.6688 | MinRP: 0.5978
26/01/2026 10:21:48 >> AUPRC improved: 0.6568 ---> 0.6688 (+0.0120)
26/01/2026 10:21:48 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:21:48 >> ============================================================
26/01/2026 10:21:48 >> >>> Epoch 3/20
26/01/2026 10:25:12 >> Epoch 3 completed | Avg Loss: 1.8540
26/01/2026 10:25:16 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9278 | AUPRC: 0.7316 | MinRP: 0.6569
26/01/2026 10:25:33 >> VAL          Epoch:     3 | AUROC: 0.9081 | AUPRC: 0.6736 | MinRP: 0.6046
26/01/2026 10:25:33 >> AUPRC improved: 0.6688 ---> 0.6736 (+0.0048)
26/01/2026 10:25:33 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:25:33 >> ============================================================
26/01/2026 10:25:33 >> >>> Epoch 4/20
26/01/2026 10:28:56 >> Epoch 4 completed | Avg Loss: 1.8310
26/01/2026 10:29:00 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9329 | AUPRC: 0.7463 | MinRP: 0.6667
26/01/2026 10:29:18 >> VAL          Epoch:     4 | AUROC: 0.9075 | AUPRC: 0.6799 | MinRP: 0.6081
26/01/2026 10:29:18 >> AUPRC improved: 0.6736 ---> 0.6799 (+0.0063)
26/01/2026 10:29:18 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:29:18 >> ============================================================
26/01/2026 10:29:18 >> >>> Epoch 5/20
26/01/2026 10:32:41 >> Epoch 5 completed | Avg Loss: 1.7934
26/01/2026 10:32:46 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9341 | AUPRC: 0.7497 | MinRP: 0.6695
26/01/2026 10:33:03 >> VAL          Epoch:     5 | AUROC: 0.9078 | AUPRC: 0.6766 | MinRP: 0.6091
26/01/2026 10:33:03 >> No improvement. Wait: 4/5
26/01/2026 10:33:03 >> ============================================================
26/01/2026 10:33:03 >> >>> Epoch 6/20
26/01/2026 10:36:26 >> Epoch 6 completed | Avg Loss: 1.7676
26/01/2026 10:36:30 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9385 | AUPRC: 0.7571 | MinRP: 0.6653
26/01/2026 10:36:48 >> VAL          Epoch:     6 | AUROC: 0.9128 | AUPRC: 0.6896 | MinRP: 0.6109
26/01/2026 10:36:48 >> AUPRC improved: 0.6799 ---> 0.6896 (+0.0097)
26/01/2026 10:36:48 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:36:48 >> ============================================================
26/01/2026 10:36:48 >> >>> Epoch 7/20
26/01/2026 10:40:11 >> Epoch 7 completed | Avg Loss: 1.7476
26/01/2026 10:40:16 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9412 | AUPRC: 0.7593 | MinRP: 0.6822
26/01/2026 10:40:33 >> VAL          Epoch:     7 | AUROC: 0.9108 | AUPRC: 0.6838 | MinRP: 0.6057
26/01/2026 10:40:33 >> No improvement. Wait: 4/5
26/01/2026 10:40:33 >> ============================================================
26/01/2026 10:40:33 >> >>> Epoch 8/20
26/01/2026 10:43:57 >> Epoch 8 completed | Avg Loss: 1.7394
26/01/2026 10:44:01 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9389 | AUPRC: 0.7638 | MinRP: 0.6695
26/01/2026 10:44:18 >> VAL          Epoch:     8 | AUROC: 0.9112 | AUPRC: 0.6886 | MinRP: 0.6085
26/01/2026 10:44:18 >> No improvement. Wait: 3/5
26/01/2026 10:44:18 >> ============================================================
26/01/2026 10:44:18 >> >>> Epoch 9/20
26/01/2026 10:47:44 >> Epoch 9 completed | Avg Loss: 1.7030
26/01/2026 10:47:48 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9417 | AUPRC: 0.7716 | MinRP: 0.7034
26/01/2026 10:48:06 >> VAL          Epoch:     9 | AUROC: 0.9105 | AUPRC: 0.6883 | MinRP: 0.6049
26/01/2026 10:48:06 >> No improvement. Wait: 2/5
26/01/2026 10:48:06 >> ============================================================
26/01/2026 10:48:06 >> >>> Epoch 10/20
26/01/2026 10:51:33 >> Epoch 10 completed | Avg Loss: 1.6859
26/01/2026 10:51:37 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9455 | AUPRC: 0.7892 | MinRP: 0.7173
26/01/2026 10:51:55 >> VAL          Epoch:    10 | AUROC: 0.9124 | AUPRC: 0.6919 | MinRP: 0.6135
26/01/2026 10:51:55 >> AUPRC improved: 0.6896 ---> 0.6919 (+0.0023)
26/01/2026 10:51:55 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:51:55 >> ============================================================
26/01/2026 10:51:55 >> >>> Epoch 11/20
26/01/2026 10:55:22 >> Epoch 11 completed | Avg Loss: 1.6748
26/01/2026 10:55:26 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9465 | AUPRC: 0.7869 | MinRP: 0.6992
26/01/2026 10:55:44 >> VAL          Epoch:    11 | AUROC: 0.9127 | AUPRC: 0.6901 | MinRP: 0.6118
26/01/2026 10:55:44 >> No improvement. Wait: 4/5
26/01/2026 10:55:44 >> ============================================================
26/01/2026 10:55:44 >> >>> Epoch 12/20
26/01/2026 10:59:11 >> Epoch 12 completed | Avg Loss: 1.6646
26/01/2026 10:59:15 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9504 | AUPRC: 0.7951 | MinRP: 0.7288
26/01/2026 10:59:33 >> VAL          Epoch:    12 | AUROC: 0.9097 | AUPRC: 0.6917 | MinRP: 0.6101
26/01/2026 10:59:33 >> No improvement. Wait: 3/5
26/01/2026 10:59:33 >> ============================================================
26/01/2026 10:59:33 >> >>> Epoch 13/20
26/01/2026 11:03:00 >> Epoch 13 completed | Avg Loss: 1.6318
26/01/2026 11:03:04 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9523 | AUPRC: 0.8032 | MinRP: 0.7292
26/01/2026 11:03:22 >> VAL          Epoch:    13 | AUROC: 0.9107 | AUPRC: 0.6947 | MinRP: 0.6201
26/01/2026 11:03:22 >> AUPRC improved: 0.6919 ---> 0.6947 (+0.0028)
26/01/2026 11:03:22 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 11:03:22 >> ============================================================
26/01/2026 11:03:22 >> >>> Epoch 14/20
26/01/2026 11:06:48 >> Epoch 14 completed | Avg Loss: 1.6140
26/01/2026 11:06:53 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9544 | AUPRC: 0.8103 | MinRP: 0.7458
26/01/2026 11:07:10 >> VAL          Epoch:    14 | AUROC: 0.9133 | AUPRC: 0.6996 | MinRP: 0.6183
26/01/2026 11:07:10 >> AUPRC improved: 0.6947 ---> 0.6996 (+0.0050)
26/01/2026 11:07:10 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 11:07:10 >> ============================================================
26/01/2026 11:07:10 >> >>> Epoch 15/20
26/01/2026 11:10:37 >> Epoch 15 completed | Avg Loss: 1.5953
26/01/2026 11:10:41 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9567 | AUPRC: 0.8141 | MinRP: 0.7500
26/01/2026 11:10:59 >> VAL          Epoch:    15 | AUROC: 0.9139 | AUPRC: 0.6971 | MinRP: 0.6160
26/01/2026 11:10:59 >> No improvement. Wait: 4/5
26/01/2026 11:10:59 >> ============================================================
26/01/2026 11:10:59 >> >>> Epoch 16/20
26/01/2026 11:14:24 >> Epoch 16 completed | Avg Loss: 1.5945
26/01/2026 11:14:28 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9616 | AUPRC: 0.8255 | MinRP: 0.7426
26/01/2026 11:14:46 >> VAL          Epoch:    16 | AUROC: 0.9125 | AUPRC: 0.6876 | MinRP: 0.6103
26/01/2026 11:14:46 >> No improvement. Wait: 3/5
26/01/2026 11:14:46 >> ============================================================
26/01/2026 11:14:46 >> >>> Epoch 17/20
26/01/2026 11:18:13 >> Epoch 17 completed | Avg Loss: 1.5863
26/01/2026 11:18:18 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9617 | AUPRC: 0.8287 | MinRP: 0.7521
26/01/2026 11:18:35 >> VAL          Epoch:    17 | AUROC: 0.9119 | AUPRC: 0.6884 | MinRP: 0.6066
26/01/2026 11:18:35 >> No improvement. Wait: 2/5
26/01/2026 11:18:35 >> ============================================================
26/01/2026 11:18:35 >> >>> Epoch 18/20
26/01/2026 11:22:00 >> Epoch 18 completed | Avg Loss: 1.5544
26/01/2026 11:22:04 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9663 | AUPRC: 0.8466 | MinRP: 0.7669
26/01/2026 11:22:22 >> VAL          Epoch:    18 | AUROC: 0.9102 | AUPRC: 0.6891 | MinRP: 0.6109
26/01/2026 11:22:22 >> No improvement. Wait: 1/5
26/01/2026 11:22:22 >> ============================================================
26/01/2026 11:22:22 >> >>> Epoch 19/20
26/01/2026 11:25:44 >> Epoch 19 completed | Avg Loss: 1.5415
26/01/2026 11:25:48 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9675 | AUPRC: 0.8518 | MinRP: 0.7669
26/01/2026 11:26:05 >> VAL          Epoch:    19 | AUROC: 0.9108 | AUPRC: 0.6897 | MinRP: 0.6196
26/01/2026 11:26:05 >> No improvement. Wait: 0/5
26/01/2026 11:26:05 >> Patience reached. Early stopping.

26/01/2026 11:26:05 >> ============================================================
26/01/2026 11:26:05 >> TRAINING COMPLETED
26/01/2026 11:26:05 >> ============================================================
26/01/2026 11:26:05 >> Best Validation Results:
26/01/2026 11:26:05 >>   AUROC: 0.9133 | AUPRC: 0.6996 | MinRP: 0.6183
26/01/2026 11:26:05 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 11:26:05 >> Evaluating on test set...
26/01/2026 11:26:27 >> TEST         AUROC: 0.9111 | AUPRC: 0.6815 | MinRP: 0.6034 | Accuracy: 0.8819

26/01/2026 11:26:27 >> ============================================================
26/01/2026 11:26:27 >> Classification Report:
26/01/2026 11:26:27 >>               precision    recall  f1-score   support
26/01/2026 11:26:27 >> 
26/01/2026 11:26:27 >>          0.0     0.9578    0.9056    0.9310      9309
26/01/2026 11:26:27 >>          1.0     0.5067    0.7088    0.5910      1274
26/01/2026 11:26:27 >> 
26/01/2026 11:26:27 >>     accuracy                         0.8819     10583
26/01/2026 11:26:27 >>    macro avg     0.7323    0.8072    0.7610     10583
26/01/2026 11:26:27 >> weighted avg     0.9035    0.8819    0.8900     10583
26/01/2026 11:26:27 >> 
26/01/2026 11:26:27 >> Confusion Matrix:
26/01/2026 11:26:27 >> [8430, 879]
26/01/2026 11:26:27 >> [371, 903]
26/01/2026 11:26:27 >> ============================================================
26/01/2026 11:26:27 >> ============================================================
26/01/2026 11:26:27 >> Final Test Results:
26/01/2026 11:26:27 >>   AUROC: 0.9111 | AUPRC: 0.6815 | MinRP: 0.6034 | Accuracy: 0.8819
26/01/2026 11:26:27 >> ============================================================
