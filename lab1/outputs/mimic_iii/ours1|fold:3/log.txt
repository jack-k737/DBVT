25/01/2026 16:16:48 >> Namespace(dataset='mimic_iii', model='ours1', split_file='mimic_iii_5fold.json', fold=3, root_dir='/home/xiejun/codeLib/miccai', output_dir='/home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3', lr=0.0003, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:1', seed=2026, grud_hid_dim=128, grud_dropout=0.2, transformer_hid_dim=64, transformer_num_layers=4, transformer_num_heads=4, transformer_dropout=0.2, fusion_hid_dim=256, fusion_dropout=0.15, lambda_aux=1.0, lambda_cos=0.7, logger=<utils.logger.Logger object at 0x7a9b59906140>)

25/01/2026 16:16:48 >> ============================================================
25/01/2026 16:16:48 >> Loading dataset...
25/01/2026 16:16:48 >> ============================================================

25/01/2026 16:16:48 >> Preparing dataset mimic_iii
25/01/2026 16:16:52 >> Using fold 3/5
25/01/2026 16:16:52 >> Loaded splits from mimic_iii_5fold.json
25/01/2026 16:17:20 >> # train, val, test TS: [33866, 8436, 10569]
25/01/2026 16:17:42 >> pos class weight: 7.0423
25/01/2026 16:17:42 >> % pos class in train, val, test splits: [0.1243, 0.1193, 0.1220]
25/01/2026 16:17:44 >> # static features: 3
25/01/2026 16:17:44 >> # TS variables (MedBiVT): 127
25/01/2026 16:17:52 >> # timesteps (MedBiVT): 25

25/01/2026 16:19:38 >> ============================================================
25/01/2026 16:19:38 >> Initializing ours1 model...
25/01/2026 16:19:38 >> ============================================================

25/01/2026 16:19:39 >> Model details:
25/01/2026 16:19:39 >> # parameters: 575905
25/01/2026 16:19:39 >> # trainable parameters: 575905, 100.00%
25/01/2026 16:19:39 >> #params by dtype:
25/01/2026 16:19:39 >> torch.float32: 575905, 100.00%

25/01/2026 16:19:39 >> No. of training batches per epoch = 1059

25/01/2026 16:19:39 >> ============================================================
25/01/2026 16:19:39 >>                Starting training...
25/01/2026 16:19:39 >> ============================================================
25/01/2026 16:19:39 >> >>> Epoch 1/20
25/01/2026 16:23:01 >> Epoch 1 completed | Avg Loss: 2.5123
25/01/2026 16:23:06 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9258 | AUPRC: 0.6904 | MinRP: 0.6085
25/01/2026 16:23:23 >> VAL          Epoch:     1 | AUROC: 0.9041 | AUPRC: 0.6400 | MinRP: 0.5915
25/01/2026 16:23:23 >> AUPRC improved: 0.0000 ---> 0.6400 (+0.6400)
25/01/2026 16:23:23 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
25/01/2026 16:23:23 >> ============================================================
25/01/2026 16:23:23 >> >>> Epoch 2/20
25/01/2026 16:26:45 >> Epoch 2 completed | Avg Loss: 2.2145
25/01/2026 16:26:49 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9321 | AUPRC: 0.7083 | MinRP: 0.6255
25/01/2026 16:27:07 >> VAL          Epoch:     2 | AUROC: 0.9077 | AUPRC: 0.6588 | MinRP: 0.5978
25/01/2026 16:27:07 >> AUPRC improved: 0.6400 ---> 0.6588 (+0.0188)
25/01/2026 16:27:07 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
25/01/2026 16:27:07 >> ============================================================
25/01/2026 16:27:07 >> >>> Epoch 3/20
25/01/2026 16:30:28 >> Epoch 3 completed | Avg Loss: 2.1488
25/01/2026 16:30:33 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9326 | AUPRC: 0.7136 | MinRP: 0.6356
25/01/2026 16:30:50 >> VAL          Epoch:     3 | AUROC: 0.9072 | AUPRC: 0.6596 | MinRP: 0.5888
25/01/2026 16:30:50 >> AUPRC improved: 0.6588 ---> 0.6596 (+0.0008)
25/01/2026 16:30:50 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
25/01/2026 16:30:50 >> ============================================================
25/01/2026 16:30:50 >> >>> Epoch 4/20
25/01/2026 16:34:12 >> Epoch 4 completed | Avg Loss: 2.0959
25/01/2026 16:34:16 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9379 | AUPRC: 0.7254 | MinRP: 0.6511
25/01/2026 16:34:34 >> VAL          Epoch:     4 | AUROC: 0.9107 | AUPRC: 0.6711 | MinRP: 0.6044
25/01/2026 16:34:34 >> AUPRC improved: 0.6596 ---> 0.6711 (+0.0115)
25/01/2026 16:34:34 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
25/01/2026 16:34:34 >> ============================================================
25/01/2026 16:34:34 >> >>> Epoch 5/20
25/01/2026 16:37:52 >> Epoch 5 completed | Avg Loss: 2.0738
25/01/2026 16:37:56 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9416 | AUPRC: 0.7404 | MinRP: 0.6638
25/01/2026 16:38:14 >> VAL          Epoch:     5 | AUROC: 0.9105 | AUPRC: 0.6713 | MinRP: 0.5996
25/01/2026 16:38:14 >> AUPRC improved: 0.6711 ---> 0.6713 (+0.0002)
25/01/2026 16:38:14 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
25/01/2026 16:38:14 >> ============================================================
25/01/2026 16:38:14 >> >>> Epoch 6/20
25/01/2026 16:41:36 >> Epoch 6 completed | Avg Loss: 2.0482
25/01/2026 16:41:40 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9445 | AUPRC: 0.7464 | MinRP: 0.6723
25/01/2026 16:41:57 >> VAL          Epoch:     6 | AUROC: 0.9107 | AUPRC: 0.6721 | MinRP: 0.6074
25/01/2026 16:41:57 >> AUPRC improved: 0.6713 ---> 0.6721 (+0.0008)
25/01/2026 16:41:57 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
25/01/2026 16:41:57 >> ============================================================
25/01/2026 16:41:57 >> >>> Epoch 7/20
25/01/2026 16:45:21 >> Epoch 7 completed | Avg Loss: 2.0336
25/01/2026 16:45:25 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9430 | AUPRC: 0.7446 | MinRP: 0.6610
25/01/2026 16:45:43 >> VAL          Epoch:     7 | AUROC: 0.9116 | AUPRC: 0.6721 | MinRP: 0.6048
25/01/2026 16:45:43 >> No improvement. Wait: 4/5
25/01/2026 16:45:43 >> ============================================================
25/01/2026 16:45:43 >> >>> Epoch 8/20
25/01/2026 16:49:05 >> Epoch 8 completed | Avg Loss: 1.9973
25/01/2026 16:49:09 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9462 | AUPRC: 0.7486 | MinRP: 0.6680
25/01/2026 16:49:27 >> VAL          Epoch:     8 | AUROC: 0.9108 | AUPRC: 0.6738 | MinRP: 0.6054
25/01/2026 16:49:27 >> AUPRC improved: 0.6721 ---> 0.6738 (+0.0016)
25/01/2026 16:49:27 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
25/01/2026 16:49:27 >> ============================================================
25/01/2026 16:49:27 >> >>> Epoch 9/20
25/01/2026 16:52:48 >> Epoch 9 completed | Avg Loss: 1.9828
25/01/2026 16:52:52 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9489 | AUPRC: 0.7613 | MinRP: 0.6809
25/01/2026 16:53:09 >> VAL          Epoch:     9 | AUROC: 0.9100 | AUPRC: 0.6737 | MinRP: 0.5984
25/01/2026 16:53:09 >> No improvement. Wait: 4/5
25/01/2026 16:53:09 >> ============================================================
25/01/2026 16:53:09 >> >>> Epoch 10/20
25/01/2026 16:56:33 >> Epoch 10 completed | Avg Loss: 1.9467
25/01/2026 16:56:37 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9483 | AUPRC: 0.7629 | MinRP: 0.6875
25/01/2026 16:56:54 >> VAL          Epoch:    10 | AUROC: 0.9124 | AUPRC: 0.6781 | MinRP: 0.6028
25/01/2026 16:56:54 >> AUPRC improved: 0.6738 ---> 0.6781 (+0.0044)
25/01/2026 16:56:54 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
25/01/2026 16:56:54 >> ============================================================
25/01/2026 16:56:54 >> >>> Epoch 11/20
25/01/2026 17:00:18 >> Epoch 11 completed | Avg Loss: 1.9253
25/01/2026 17:00:22 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9520 | AUPRC: 0.7723 | MinRP: 0.6849
25/01/2026 17:00:39 >> VAL          Epoch:    11 | AUROC: 0.9131 | AUPRC: 0.6840 | MinRP: 0.6103
25/01/2026 17:00:39 >> AUPRC improved: 0.6781 ---> 0.6840 (+0.0059)
25/01/2026 17:00:39 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
25/01/2026 17:00:39 >> ============================================================
25/01/2026 17:00:39 >> >>> Epoch 12/20
25/01/2026 17:04:02 >> Epoch 12 completed | Avg Loss: 1.9150
25/01/2026 17:04:06 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9540 | AUPRC: 0.7773 | MinRP: 0.6936
25/01/2026 17:04:24 >> VAL          Epoch:    12 | AUROC: 0.9118 | AUPRC: 0.6822 | MinRP: 0.6054
25/01/2026 17:04:24 >> No improvement. Wait: 4/5
25/01/2026 17:04:24 >> ============================================================
25/01/2026 17:04:24 >> >>> Epoch 13/20
25/01/2026 17:07:48 >> Epoch 13 completed | Avg Loss: 1.8906
25/01/2026 17:07:52 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9541 | AUPRC: 0.7796 | MinRP: 0.7021
25/01/2026 17:08:09 >> VAL          Epoch:    13 | AUROC: 0.9126 | AUPRC: 0.6827 | MinRP: 0.6103
25/01/2026 17:08:09 >> No improvement. Wait: 3/5
25/01/2026 17:08:09 >> ============================================================
25/01/2026 17:08:09 >> >>> Epoch 14/20
25/01/2026 17:11:33 >> Epoch 14 completed | Avg Loss: 1.8792
25/01/2026 17:11:37 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9549 | AUPRC: 0.7866 | MinRP: 0.7076
25/01/2026 17:11:55 >> VAL          Epoch:    14 | AUROC: 0.9113 | AUPRC: 0.6778 | MinRP: 0.6008
25/01/2026 17:11:55 >> No improvement. Wait: 2/5
25/01/2026 17:11:55 >> ============================================================
25/01/2026 17:11:55 >> >>> Epoch 15/20
25/01/2026 17:15:19 >> Epoch 15 completed | Avg Loss: 1.8638
25/01/2026 17:15:23 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9593 | AUPRC: 0.7961 | MinRP: 0.7106
25/01/2026 17:15:41 >> VAL          Epoch:    15 | AUROC: 0.9113 | AUPRC: 0.6765 | MinRP: 0.6018
25/01/2026 17:15:41 >> No improvement. Wait: 1/5
25/01/2026 17:15:41 >> ============================================================
25/01/2026 17:15:41 >> >>> Epoch 16/20
25/01/2026 17:19:06 >> Epoch 16 completed | Avg Loss: 1.8458
25/01/2026 17:19:10 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9599 | AUPRC: 0.7965 | MinRP: 0.7149
25/01/2026 17:19:28 >> VAL          Epoch:    16 | AUROC: 0.9101 | AUPRC: 0.6752 | MinRP: 0.5934
25/01/2026 17:19:28 >> No improvement. Wait: 0/5
25/01/2026 17:19:28 >> Patience reached. Early stopping.

25/01/2026 17:19:28 >> ============================================================
25/01/2026 17:19:28 >> TRAINING COMPLETED
25/01/2026 17:19:28 >> ============================================================
25/01/2026 17:19:28 >> Best Validation Results:
25/01/2026 17:19:28 >>   AUROC: 0.9131 | AUPRC: 0.6840 | MinRP: 0.6103
25/01/2026 17:19:28 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
25/01/2026 17:19:28 >> Evaluating on test set...
25/01/2026 17:19:50 >> TEST         AUROC: 0.9156 | AUPRC: 0.7030 | MinRP: 0.6191 | Accuracy: 0.8524

25/01/2026 17:19:50 >> ============================================================
25/01/2026 17:19:50 >> Classification Report:
25/01/2026 17:19:50 >>               precision    recall  f1-score   support
25/01/2026 17:19:50 >> 
25/01/2026 17:19:50 >>          0.0     0.9682    0.8601    0.9110      9280
25/01/2026 17:19:50 >>          1.0     0.4417    0.7967    0.5683      1289
25/01/2026 17:19:50 >> 
25/01/2026 17:19:50 >>     accuracy                         0.8524     10569
25/01/2026 17:19:50 >>    macro avg     0.7050    0.8284    0.7397     10569
25/01/2026 17:19:50 >> weighted avg     0.9040    0.8524    0.8692     10569
25/01/2026 17:19:50 >> 
25/01/2026 17:19:50 >> Confusion Matrix:
25/01/2026 17:19:50 >> [7982, 1298]
25/01/2026 17:19:50 >> [262, 1027]
25/01/2026 17:19:50 >> ============================================================
25/01/2026 17:19:50 >> ============================================================
25/01/2026 17:19:50 >> Final Test Results:
25/01/2026 17:19:50 >>   AUROC: 0.9156 | AUPRC: 0.7030 | MinRP: 0.6191 | Accuracy: 0.8524
25/01/2026 17:19:50 >> ============================================================
26/01/2026 10:11:37 >> Namespace(dataset='mimic_iii', model='ours1', split_file='mimic_iii_5fold.json', fold=3, root_dir='/home/xiejun/codeLib/miccai', output_dir='/home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3', lr=0.0003, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:1', seed=2026, grud_hid_dim=128, grud_dropout=0.2, transformer_hid_dim=64, transformer_num_layers=4, transformer_num_heads=4, transformer_dropout=0.2, fusion_hid_dim=256, fusion_dropout=0.1, lambda_aux=0.8, lambda_cos=0.6, logger=<utils.logger.Logger object at 0x77ac21dabfa0>)

26/01/2026 10:11:37 >> ============================================================
26/01/2026 10:11:37 >> Loading dataset...
26/01/2026 10:11:37 >> ============================================================

26/01/2026 10:11:37 >> Preparing dataset mimic_iii
26/01/2026 10:11:41 >> Using fold 3/5
26/01/2026 10:11:41 >> Loaded splits from mimic_iii_5fold.json
26/01/2026 10:12:06 >> # train, val, test TS: [33866, 8436, 10569]
26/01/2026 10:12:26 >> pos class weight: 7.0423
26/01/2026 10:12:26 >> % pos class in train, val, test splits: [0.1243, 0.1193, 0.1220]
26/01/2026 10:12:28 >> # static features: 3
26/01/2026 10:12:28 >> # TS variables (MedBiVT): 127
26/01/2026 10:12:36 >> # timesteps (MedBiVT): 25

26/01/2026 10:14:11 >> ============================================================
26/01/2026 10:14:11 >> Initializing ours1 model...
26/01/2026 10:14:11 >> ============================================================

26/01/2026 10:14:11 >> Model details:
26/01/2026 10:14:11 >> # parameters: 575905
26/01/2026 10:14:11 >> # trainable parameters: 575905, 100.00%
26/01/2026 10:14:11 >> #params by dtype:
26/01/2026 10:14:11 >> torch.float32: 575905, 100.00%

26/01/2026 10:14:12 >> No. of training batches per epoch = 1059

26/01/2026 10:14:12 >> ============================================================
26/01/2026 10:14:12 >>                Starting training...
26/01/2026 10:14:12 >> ============================================================
26/01/2026 10:14:12 >> >>> Epoch 1/20
26/01/2026 10:17:34 >> Epoch 1 completed | Avg Loss: 2.1721
26/01/2026 10:17:39 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9261 | AUPRC: 0.6907 | MinRP: 0.6255
26/01/2026 10:17:56 >> VAL          Epoch:     1 | AUROC: 0.9039 | AUPRC: 0.6403 | MinRP: 0.5944
26/01/2026 10:17:56 >> AUPRC improved: 0.0000 ---> 0.6403 (+0.6403)
26/01/2026 10:17:56 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 10:17:56 >> ============================================================
26/01/2026 10:17:56 >> >>> Epoch 2/20
26/01/2026 10:21:19 >> Epoch 2 completed | Avg Loss: 1.9147
26/01/2026 10:21:23 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9320 | AUPRC: 0.7066 | MinRP: 0.6234
26/01/2026 10:21:41 >> VAL          Epoch:     2 | AUROC: 0.9077 | AUPRC: 0.6588 | MinRP: 0.5974
26/01/2026 10:21:41 >> AUPRC improved: 0.6403 ---> 0.6588 (+0.0186)
26/01/2026 10:21:41 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 10:21:41 >> ============================================================
26/01/2026 10:21:41 >> >>> Epoch 3/20
26/01/2026 10:25:04 >> Epoch 3 completed | Avg Loss: 1.8581
26/01/2026 10:25:08 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9328 | AUPRC: 0.7165 | MinRP: 0.6349
26/01/2026 10:25:25 >> VAL          Epoch:     3 | AUROC: 0.9078 | AUPRC: 0.6612 | MinRP: 0.5915
26/01/2026 10:25:25 >> AUPRC improved: 0.6588 ---> 0.6612 (+0.0023)
26/01/2026 10:25:25 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 10:25:25 >> ============================================================
26/01/2026 10:25:25 >> >>> Epoch 4/20
26/01/2026 10:28:48 >> Epoch 4 completed | Avg Loss: 1.8122
26/01/2026 10:28:53 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9385 | AUPRC: 0.7274 | MinRP: 0.6511
26/01/2026 10:29:10 >> VAL          Epoch:     4 | AUROC: 0.9100 | AUPRC: 0.6702 | MinRP: 0.5994
26/01/2026 10:29:10 >> AUPRC improved: 0.6612 ---> 0.6702 (+0.0090)
26/01/2026 10:29:10 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 10:29:10 >> ============================================================
26/01/2026 10:29:10 >> >>> Epoch 5/20
26/01/2026 10:32:33 >> Epoch 5 completed | Avg Loss: 1.7944
26/01/2026 10:32:37 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9417 | AUPRC: 0.7431 | MinRP: 0.6653
26/01/2026 10:32:54 >> VAL          Epoch:     5 | AUROC: 0.9102 | AUPRC: 0.6719 | MinRP: 0.5964
26/01/2026 10:32:54 >> AUPRC improved: 0.6702 ---> 0.6719 (+0.0017)
26/01/2026 10:32:54 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 10:32:54 >> ============================================================
26/01/2026 10:32:54 >> >>> Epoch 6/20
26/01/2026 10:36:18 >> Epoch 6 completed | Avg Loss: 1.7718
26/01/2026 10:36:22 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9453 | AUPRC: 0.7498 | MinRP: 0.6723
26/01/2026 10:36:39 >> VAL          Epoch:     6 | AUROC: 0.9105 | AUPRC: 0.6717 | MinRP: 0.6032
26/01/2026 10:36:39 >> No improvement. Wait: 4/5
26/01/2026 10:36:39 >> ============================================================
26/01/2026 10:36:39 >> >>> Epoch 7/20
26/01/2026 10:40:02 >> Epoch 7 completed | Avg Loss: 1.7562
26/01/2026 10:40:07 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9437 | AUPRC: 0.7466 | MinRP: 0.6695
26/01/2026 10:40:24 >> VAL          Epoch:     7 | AUROC: 0.9113 | AUPRC: 0.6720 | MinRP: 0.6034
26/01/2026 10:40:24 >> AUPRC improved: 0.6719 ---> 0.6720 (+0.0001)
26/01/2026 10:40:24 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 10:40:24 >> ============================================================
26/01/2026 10:40:24 >> >>> Epoch 8/20
26/01/2026 10:43:47 >> Epoch 8 completed | Avg Loss: 1.7282
26/01/2026 10:43:51 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9459 | AUPRC: 0.7507 | MinRP: 0.6809
26/01/2026 10:44:08 >> VAL          Epoch:     8 | AUROC: 0.9109 | AUPRC: 0.6757 | MinRP: 0.6044
26/01/2026 10:44:08 >> AUPRC improved: 0.6720 ---> 0.6757 (+0.0037)
26/01/2026 10:44:08 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 10:44:08 >> ============================================================
26/01/2026 10:44:08 >> >>> Epoch 9/20
26/01/2026 10:47:34 >> Epoch 9 completed | Avg Loss: 1.7151
26/01/2026 10:47:38 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9480 | AUPRC: 0.7603 | MinRP: 0.6766
26/01/2026 10:47:56 >> VAL          Epoch:     9 | AUROC: 0.9104 | AUPRC: 0.6760 | MinRP: 0.6014
26/01/2026 10:47:56 >> AUPRC improved: 0.6757 ---> 0.6760 (+0.0003)
26/01/2026 10:47:56 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 10:47:56 >> ============================================================
26/01/2026 10:47:56 >> >>> Epoch 10/20
26/01/2026 10:51:22 >> Epoch 10 completed | Avg Loss: 1.6804
26/01/2026 10:51:27 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9481 | AUPRC: 0.7617 | MinRP: 0.6809
26/01/2026 10:51:44 >> VAL          Epoch:    10 | AUROC: 0.9128 | AUPRC: 0.6797 | MinRP: 0.6083
26/01/2026 10:51:44 >> AUPRC improved: 0.6760 ---> 0.6797 (+0.0037)
26/01/2026 10:51:44 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 10:51:44 >> ============================================================
26/01/2026 10:51:44 >> >>> Epoch 11/20
26/01/2026 10:55:11 >> Epoch 11 completed | Avg Loss: 1.6620
26/01/2026 10:55:15 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9514 | AUPRC: 0.7695 | MinRP: 0.6851
26/01/2026 10:55:32 >> VAL          Epoch:    11 | AUROC: 0.9136 | AUPRC: 0.6847 | MinRP: 0.6113
26/01/2026 10:55:32 >> AUPRC improved: 0.6797 ---> 0.6847 (+0.0050)
26/01/2026 10:55:32 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 10:55:32 >> ============================================================
26/01/2026 10:55:32 >> >>> Epoch 12/20
26/01/2026 10:58:58 >> Epoch 12 completed | Avg Loss: 1.6514
26/01/2026 10:59:03 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9538 | AUPRC: 0.7781 | MinRP: 0.6851
26/01/2026 10:59:20 >> VAL          Epoch:    12 | AUROC: 0.9119 | AUPRC: 0.6828 | MinRP: 0.6113
26/01/2026 10:59:20 >> No improvement. Wait: 4/5
26/01/2026 10:59:20 >> ============================================================
26/01/2026 10:59:20 >> >>> Epoch 13/20
26/01/2026 11:02:45 >> Epoch 13 completed | Avg Loss: 1.6283
26/01/2026 11:02:49 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9543 | AUPRC: 0.7799 | MinRP: 0.7034
26/01/2026 11:03:07 >> VAL          Epoch:    13 | AUROC: 0.9132 | AUPRC: 0.6849 | MinRP: 0.6101
26/01/2026 11:03:07 >> AUPRC improved: 0.6847 ---> 0.6849 (+0.0002)
26/01/2026 11:03:07 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 11:03:07 >> ============================================================
26/01/2026 11:03:07 >> >>> Epoch 14/20
26/01/2026 11:06:33 >> Epoch 14 completed | Avg Loss: 1.6241
26/01/2026 11:06:38 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9553 | AUPRC: 0.7875 | MinRP: 0.7149
26/01/2026 11:06:55 >> VAL          Epoch:    14 | AUROC: 0.9111 | AUPRC: 0.6774 | MinRP: 0.6014
26/01/2026 11:06:55 >> No improvement. Wait: 4/5
26/01/2026 11:06:55 >> ============================================================
26/01/2026 11:06:55 >> >>> Epoch 15/20
26/01/2026 11:10:22 >> Epoch 15 completed | Avg Loss: 1.6073
26/01/2026 11:10:26 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9599 | AUPRC: 0.7945 | MinRP: 0.7106
26/01/2026 11:10:44 >> VAL          Epoch:    15 | AUROC: 0.9106 | AUPRC: 0.6752 | MinRP: 0.5978
26/01/2026 11:10:44 >> No improvement. Wait: 3/5
26/01/2026 11:10:44 >> ============================================================
26/01/2026 11:10:44 >> >>> Epoch 16/20
26/01/2026 11:14:10 >> Epoch 16 completed | Avg Loss: 1.5902
26/01/2026 11:14:14 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9615 | AUPRC: 0.8002 | MinRP: 0.7234
26/01/2026 11:14:32 >> VAL          Epoch:    16 | AUROC: 0.9098 | AUPRC: 0.6730 | MinRP: 0.5984
26/01/2026 11:14:32 >> No improvement. Wait: 2/5
26/01/2026 11:14:32 >> ============================================================
26/01/2026 11:14:32 >> >>> Epoch 17/20
26/01/2026 11:17:58 >> Epoch 17 completed | Avg Loss: 1.5768
26/01/2026 11:18:03 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9623 | AUPRC: 0.8054 | MinRP: 0.7234
26/01/2026 11:18:20 >> VAL          Epoch:    17 | AUROC: 0.9111 | AUPRC: 0.6792 | MinRP: 0.6083
26/01/2026 11:18:20 >> No improvement. Wait: 1/5
26/01/2026 11:18:20 >> ============================================================
26/01/2026 11:18:20 >> >>> Epoch 18/20
26/01/2026 11:20:12 >> Epoch 18 completed | Avg Loss: 1.5645
26/01/2026 11:20:14 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9660 | AUPRC: 0.8263 | MinRP: 0.7532
26/01/2026 11:20:22 >> VAL          Epoch:    18 | AUROC: 0.9101 | AUPRC: 0.6769 | MinRP: 0.6052
26/01/2026 11:20:22 >> No improvement. Wait: 0/5
26/01/2026 11:20:22 >> Patience reached. Early stopping.

26/01/2026 11:20:22 >> ============================================================
26/01/2026 11:20:22 >> TRAINING COMPLETED
26/01/2026 11:20:22 >> ============================================================
26/01/2026 11:20:22 >> Best Validation Results:
26/01/2026 11:20:22 >>   AUROC: 0.9132 | AUPRC: 0.6849 | MinRP: 0.6101
26/01/2026 11:20:22 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:3/checkpoint_best.bin
26/01/2026 11:20:22 >> Evaluating on test set...
26/01/2026 11:20:33 >> TEST         AUROC: 0.9168 | AUPRC: 0.7040 | MinRP: 0.6175 | Accuracy: 0.8682

26/01/2026 11:20:33 >> ============================================================
26/01/2026 11:20:33 >> Classification Report:
26/01/2026 11:20:33 >>               precision    recall  f1-score   support
26/01/2026 11:20:33 >> 
26/01/2026 11:20:33 >>          0.0     0.9627    0.8842    0.9218      9280
26/01/2026 11:20:33 >>          1.0     0.4746    0.7533    0.5823      1289
26/01/2026 11:20:33 >> 
26/01/2026 11:20:33 >>     accuracy                         0.8682     10569
26/01/2026 11:20:33 >>    macro avg     0.7186    0.8187    0.7520     10569
26/01/2026 11:20:33 >> weighted avg     0.9032    0.8682    0.8804     10569
26/01/2026 11:20:33 >> 
26/01/2026 11:20:33 >> Confusion Matrix:
26/01/2026 11:20:33 >> [8205, 1075]
26/01/2026 11:20:33 >> [318, 971]
26/01/2026 11:20:33 >> ============================================================
26/01/2026 11:20:33 >> ============================================================
26/01/2026 11:20:33 >> Final Test Results:
26/01/2026 11:20:33 >>   AUROC: 0.9168 | AUPRC: 0.7040 | MinRP: 0.6175 | Accuracy: 0.8682
26/01/2026 11:20:33 >> ============================================================
