26/01/2026 10:11:37 >> ============================================================
26/01/2026 10:11:37 >> Loading dataset...
26/01/2026 10:11:37 >> ============================================================

26/01/2026 10:11:37 >> Preparing dataset mimic_iii
26/01/2026 10:11:41 >> Using fold 1/5
26/01/2026 10:11:41 >> Loaded splits from mimic_iii_5fold.json
26/01/2026 10:12:07 >> # train, val, test TS: [33817, 8471, 10583]
26/01/2026 10:12:28 >> pos class weight: 7.1487
26/01/2026 10:12:28 >> % pos class in train, val, test splits: [0.1227, 0.1277, 0.1204]
26/01/2026 10:12:29 >> # static features: 3
26/01/2026 10:12:30 >> # TS variables (MedBiVT): 127
26/01/2026 10:12:37 >> # timesteps (MedBiVT): 25

26/01/2026 10:14:16 >> ============================================================
26/01/2026 10:14:16 >> Initializing ours1 model...
26/01/2026 10:14:16 >> ============================================================

26/01/2026 10:14:16 >> Model details:
26/01/2026 10:14:16 >> # parameters: 575905
26/01/2026 10:14:16 >> # trainable parameters: 575905, 100.00%
26/01/2026 10:14:16 >> #params by dtype:
26/01/2026 10:14:16 >> torch.float32: 575905, 100.00%

26/01/2026 10:14:16 >> No. of training batches per epoch = 1057

26/01/2026 10:14:16 >> ============================================================
26/01/2026 10:14:16 >>                Starting training...
26/01/2026 10:14:16 >> ============================================================
26/01/2026 10:14:16 >> >>> Epoch 1/20
26/01/2026 10:17:41 >> Epoch 1 completed | Avg Loss: 2.1353
26/01/2026 10:17:46 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9220 | AUPRC: 0.7098 | MinRP: 0.6356
26/01/2026 10:18:03 >> VAL          Epoch:     1 | AUROC: 0.9044 | AUPRC: 0.6568 | MinRP: 0.5917
26/01/2026 10:18:03 >> AUPRC improved: 0.0000 ---> 0.6568 (+0.6568)
26/01/2026 10:18:03 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:18:03 >> ============================================================
26/01/2026 10:18:03 >> >>> Epoch 2/20
26/01/2026 10:21:27 >> Epoch 2 completed | Avg Loss: 1.9218
26/01/2026 10:21:31 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9268 | AUPRC: 0.7298 | MinRP: 0.6568
26/01/2026 10:21:48 >> VAL          Epoch:     2 | AUROC: 0.9079 | AUPRC: 0.6688 | MinRP: 0.5978
26/01/2026 10:21:48 >> AUPRC improved: 0.6568 ---> 0.6688 (+0.0120)
26/01/2026 10:21:48 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:21:48 >> ============================================================
26/01/2026 10:21:48 >> >>> Epoch 3/20
26/01/2026 10:25:12 >> Epoch 3 completed | Avg Loss: 1.8540
26/01/2026 10:25:16 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9278 | AUPRC: 0.7316 | MinRP: 0.6569
26/01/2026 10:25:33 >> VAL          Epoch:     3 | AUROC: 0.9081 | AUPRC: 0.6736 | MinRP: 0.6046
26/01/2026 10:25:33 >> AUPRC improved: 0.6688 ---> 0.6736 (+0.0048)
26/01/2026 10:25:33 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:25:33 >> ============================================================
26/01/2026 10:25:33 >> >>> Epoch 4/20
26/01/2026 10:28:56 >> Epoch 4 completed | Avg Loss: 1.8310
26/01/2026 10:29:00 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9329 | AUPRC: 0.7463 | MinRP: 0.6667
26/01/2026 10:29:18 >> VAL          Epoch:     4 | AUROC: 0.9075 | AUPRC: 0.6799 | MinRP: 0.6081
26/01/2026 10:29:18 >> AUPRC improved: 0.6736 ---> 0.6799 (+0.0063)
26/01/2026 10:29:18 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:29:18 >> ============================================================
26/01/2026 10:29:18 >> >>> Epoch 5/20
26/01/2026 10:32:41 >> Epoch 5 completed | Avg Loss: 1.7934
26/01/2026 10:32:46 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9341 | AUPRC: 0.7497 | MinRP: 0.6695
26/01/2026 10:33:03 >> VAL          Epoch:     5 | AUROC: 0.9078 | AUPRC: 0.6766 | MinRP: 0.6091
26/01/2026 10:33:03 >> No improvement. Wait: 4/5
26/01/2026 10:33:03 >> ============================================================
26/01/2026 10:33:03 >> >>> Epoch 6/20
26/01/2026 10:36:26 >> Epoch 6 completed | Avg Loss: 1.7676
26/01/2026 10:36:30 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9385 | AUPRC: 0.7571 | MinRP: 0.6653
26/01/2026 10:36:48 >> VAL          Epoch:     6 | AUROC: 0.9128 | AUPRC: 0.6896 | MinRP: 0.6109
26/01/2026 10:36:48 >> AUPRC improved: 0.6799 ---> 0.6896 (+0.0097)
26/01/2026 10:36:48 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:36:48 >> ============================================================
26/01/2026 10:36:48 >> >>> Epoch 7/20
26/01/2026 10:40:11 >> Epoch 7 completed | Avg Loss: 1.7476
26/01/2026 10:40:16 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9412 | AUPRC: 0.7593 | MinRP: 0.6822
26/01/2026 10:40:33 >> VAL          Epoch:     7 | AUROC: 0.9108 | AUPRC: 0.6838 | MinRP: 0.6057
26/01/2026 10:40:33 >> No improvement. Wait: 4/5
26/01/2026 10:40:33 >> ============================================================
26/01/2026 10:40:33 >> >>> Epoch 8/20
26/01/2026 10:43:57 >> Epoch 8 completed | Avg Loss: 1.7394
26/01/2026 10:44:01 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9389 | AUPRC: 0.7638 | MinRP: 0.6695
26/01/2026 10:44:18 >> VAL          Epoch:     8 | AUROC: 0.9112 | AUPRC: 0.6886 | MinRP: 0.6085
26/01/2026 10:44:18 >> No improvement. Wait: 3/5
26/01/2026 10:44:18 >> ============================================================
26/01/2026 10:44:18 >> >>> Epoch 9/20
26/01/2026 10:47:44 >> Epoch 9 completed | Avg Loss: 1.7030
26/01/2026 10:47:48 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9417 | AUPRC: 0.7716 | MinRP: 0.7034
26/01/2026 10:48:06 >> VAL          Epoch:     9 | AUROC: 0.9105 | AUPRC: 0.6883 | MinRP: 0.6049
26/01/2026 10:48:06 >> No improvement. Wait: 2/5
26/01/2026 10:48:06 >> ============================================================
26/01/2026 10:48:06 >> >>> Epoch 10/20
26/01/2026 10:51:33 >> Epoch 10 completed | Avg Loss: 1.6859
26/01/2026 10:51:37 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9455 | AUPRC: 0.7892 | MinRP: 0.7173
26/01/2026 10:51:55 >> VAL          Epoch:    10 | AUROC: 0.9124 | AUPRC: 0.6919 | MinRP: 0.6135
26/01/2026 10:51:55 >> AUPRC improved: 0.6896 ---> 0.6919 (+0.0023)
26/01/2026 10:51:55 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 10:51:55 >> ============================================================
26/01/2026 10:51:55 >> >>> Epoch 11/20
26/01/2026 10:55:22 >> Epoch 11 completed | Avg Loss: 1.6748
26/01/2026 10:55:26 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9465 | AUPRC: 0.7869 | MinRP: 0.6992
26/01/2026 10:55:44 >> VAL          Epoch:    11 | AUROC: 0.9127 | AUPRC: 0.6901 | MinRP: 0.6118
26/01/2026 10:55:44 >> No improvement. Wait: 4/5
26/01/2026 10:55:44 >> ============================================================
26/01/2026 10:55:44 >> >>> Epoch 12/20
26/01/2026 10:59:11 >> Epoch 12 completed | Avg Loss: 1.6646
26/01/2026 10:59:15 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9504 | AUPRC: 0.7951 | MinRP: 0.7288
26/01/2026 10:59:33 >> VAL          Epoch:    12 | AUROC: 0.9097 | AUPRC: 0.6917 | MinRP: 0.6101
26/01/2026 10:59:33 >> No improvement. Wait: 3/5
26/01/2026 10:59:33 >> ============================================================
26/01/2026 10:59:33 >> >>> Epoch 13/20
26/01/2026 11:03:00 >> Epoch 13 completed | Avg Loss: 1.6318
26/01/2026 11:03:04 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9523 | AUPRC: 0.8032 | MinRP: 0.7292
26/01/2026 11:03:22 >> VAL          Epoch:    13 | AUROC: 0.9107 | AUPRC: 0.6947 | MinRP: 0.6201
26/01/2026 11:03:22 >> AUPRC improved: 0.6919 ---> 0.6947 (+0.0028)
26/01/2026 11:03:22 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 11:03:22 >> ============================================================
26/01/2026 11:03:22 >> >>> Epoch 14/20
26/01/2026 11:06:48 >> Epoch 14 completed | Avg Loss: 1.6140
26/01/2026 11:06:53 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9544 | AUPRC: 0.8103 | MinRP: 0.7458
26/01/2026 11:07:10 >> VAL          Epoch:    14 | AUROC: 0.9133 | AUPRC: 0.6996 | MinRP: 0.6183
26/01/2026 11:07:10 >> AUPRC improved: 0.6947 ---> 0.6996 (+0.0050)
26/01/2026 11:07:10 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 11:07:10 >> ============================================================
26/01/2026 11:07:10 >> >>> Epoch 15/20
26/01/2026 11:10:37 >> Epoch 15 completed | Avg Loss: 1.5953
26/01/2026 11:10:41 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9567 | AUPRC: 0.8141 | MinRP: 0.7500
26/01/2026 11:10:59 >> VAL          Epoch:    15 | AUROC: 0.9139 | AUPRC: 0.6971 | MinRP: 0.6160
26/01/2026 11:10:59 >> No improvement. Wait: 4/5
26/01/2026 11:10:59 >> ============================================================
26/01/2026 11:10:59 >> >>> Epoch 16/20
26/01/2026 11:14:24 >> Epoch 16 completed | Avg Loss: 1.5945
26/01/2026 11:14:28 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9616 | AUPRC: 0.8255 | MinRP: 0.7426
26/01/2026 11:14:46 >> VAL          Epoch:    16 | AUROC: 0.9125 | AUPRC: 0.6876 | MinRP: 0.6103
26/01/2026 11:14:46 >> No improvement. Wait: 3/5
26/01/2026 11:14:46 >> ============================================================
26/01/2026 11:14:46 >> >>> Epoch 17/20
26/01/2026 11:18:13 >> Epoch 17 completed | Avg Loss: 1.5863
26/01/2026 11:18:18 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9617 | AUPRC: 0.8287 | MinRP: 0.7521
26/01/2026 11:18:35 >> VAL          Epoch:    17 | AUROC: 0.9119 | AUPRC: 0.6884 | MinRP: 0.6066
26/01/2026 11:18:35 >> No improvement. Wait: 2/5
26/01/2026 11:18:35 >> ============================================================
26/01/2026 11:18:35 >> >>> Epoch 18/20
26/01/2026 11:22:00 >> Epoch 18 completed | Avg Loss: 1.5544
26/01/2026 11:22:04 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9663 | AUPRC: 0.8466 | MinRP: 0.7669
26/01/2026 11:22:22 >> VAL          Epoch:    18 | AUROC: 0.9102 | AUPRC: 0.6891 | MinRP: 0.6109
26/01/2026 11:22:22 >> No improvement. Wait: 1/5
26/01/2026 11:22:22 >> ============================================================
26/01/2026 11:22:22 >> >>> Epoch 19/20
26/01/2026 11:25:44 >> Epoch 19 completed | Avg Loss: 1.5415
26/01/2026 11:25:48 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9675 | AUPRC: 0.8518 | MinRP: 0.7669
26/01/2026 11:26:05 >> VAL          Epoch:    19 | AUROC: 0.9108 | AUPRC: 0.6897 | MinRP: 0.6196
26/01/2026 11:26:05 >> No improvement. Wait: 0/5
26/01/2026 11:26:05 >> Patience reached. Early stopping.

26/01/2026 11:26:05 >> ============================================================
26/01/2026 11:26:05 >> TRAINING COMPLETED
26/01/2026 11:26:05 >> ============================================================
26/01/2026 11:26:05 >> Best Validation Results:
26/01/2026 11:26:05 >>   AUROC: 0.9133 | AUPRC: 0.6996 | MinRP: 0.6183
26/01/2026 11:26:05 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:1/checkpoint_best.bin
26/01/2026 11:26:05 >> Evaluating on test set...
26/01/2026 11:26:27 >> TEST         AUROC: 0.9111 | AUPRC: 0.6815 | MinRP: 0.6034 | Accuracy: 0.8819

26/01/2026 11:26:27 >> ============================================================
26/01/2026 11:26:27 >> Classification Report:
26/01/2026 11:26:27 >>               precision    recall  f1-score   support
26/01/2026 11:26:27 >> 
26/01/2026 11:26:27 >>          0.0     0.9578    0.9056    0.9310      9309
26/01/2026 11:26:27 >>          1.0     0.5067    0.7088    0.5910      1274
26/01/2026 11:26:27 >> 
26/01/2026 11:26:27 >>     accuracy                         0.8819     10583
26/01/2026 11:26:27 >>    macro avg     0.7323    0.8072    0.7610     10583
26/01/2026 11:26:27 >> weighted avg     0.9035    0.8819    0.8900     10583
26/01/2026 11:26:27 >> 
26/01/2026 11:26:27 >> Confusion Matrix:
26/01/2026 11:26:27 >> [8430, 879]
26/01/2026 11:26:27 >> [371, 903]
26/01/2026 11:26:27 >> ============================================================
26/01/2026 11:26:27 >> ============================================================
26/01/2026 11:26:27 >> Final Test Results:
26/01/2026 11:26:27 >>   AUROC: 0.9111 | AUPRC: 0.6815 | MinRP: 0.6034 | Accuracy: 0.8819
26/01/2026 11:26:27 >> ============================================================
