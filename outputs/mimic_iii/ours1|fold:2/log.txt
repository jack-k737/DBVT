26/01/2026 10:11:37 >> ============================================================
26/01/2026 10:11:37 >> Loading dataset...
26/01/2026 10:11:37 >> ============================================================

26/01/2026 10:11:37 >> Preparing dataset mimic_iii
26/01/2026 10:11:41 >> Using fold 2/5
26/01/2026 10:11:41 >> Loaded splits from mimic_iii_5fold.json
26/01/2026 10:12:06 >> # train, val, test TS: [33915, 8436, 10520]
26/01/2026 10:12:27 >> pos class weight: 7.1762
26/01/2026 10:12:27 >> % pos class in train, val, test splits: [0.1223, 0.1193, 0.1285]
26/01/2026 10:12:29 >> # static features: 3
26/01/2026 10:12:30 >> # TS variables (MedBiVT): 127
26/01/2026 10:12:37 >> # timesteps (MedBiVT): 25

26/01/2026 10:14:13 >> ============================================================
26/01/2026 10:14:13 >> Initializing ours1 model...
26/01/2026 10:14:13 >> ============================================================

26/01/2026 10:14:14 >> Model details:
26/01/2026 10:14:14 >> # parameters: 575905
26/01/2026 10:14:14 >> # trainable parameters: 575905, 100.00%
26/01/2026 10:14:14 >> #params by dtype:
26/01/2026 10:14:14 >> torch.float32: 575905, 100.00%

26/01/2026 10:14:14 >> No. of training batches per epoch = 1060

26/01/2026 10:14:14 >> ============================================================
26/01/2026 10:14:14 >>                Starting training...
26/01/2026 10:14:14 >> ============================================================
26/01/2026 10:14:14 >> >>> Epoch 1/20
26/01/2026 10:17:39 >> Epoch 1 completed | Avg Loss: 2.1552
26/01/2026 10:17:44 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9180 | AUPRC: 0.6834 | MinRP: 0.6018
26/01/2026 10:18:01 >> VAL          Epoch:     1 | AUROC: 0.9004 | AUPRC: 0.6381 | MinRP: 0.5690
26/01/2026 10:18:01 >> AUPRC improved: 0.0000 ---> 0.6381 (+0.6381)
26/01/2026 10:18:01 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:2/checkpoint_best.bin
26/01/2026 10:18:01 >> ============================================================
26/01/2026 10:18:01 >> >>> Epoch 2/20
26/01/2026 10:21:25 >> Epoch 2 completed | Avg Loss: 1.9325
26/01/2026 10:21:29 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9209 | AUPRC: 0.6918 | MinRP: 0.6018
26/01/2026 10:21:46 >> VAL          Epoch:     2 | AUROC: 0.9048 | AUPRC: 0.6477 | MinRP: 0.5944
26/01/2026 10:21:46 >> AUPRC improved: 0.6381 ---> 0.6477 (+0.0096)
26/01/2026 10:21:46 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:2/checkpoint_best.bin
26/01/2026 10:21:46 >> ============================================================
26/01/2026 10:21:46 >> >>> Epoch 3/20
26/01/2026 10:25:09 >> Epoch 3 completed | Avg Loss: 1.8958
26/01/2026 10:25:14 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9311 | AUPRC: 0.7187 | MinRP: 0.6244
26/01/2026 10:25:31 >> VAL          Epoch:     3 | AUROC: 0.9062 | AUPRC: 0.6532 | MinRP: 0.5899
26/01/2026 10:25:31 >> AUPRC improved: 0.6477 ---> 0.6532 (+0.0055)
26/01/2026 10:25:31 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:2/checkpoint_best.bin
26/01/2026 10:25:31 >> ============================================================
26/01/2026 10:25:31 >> >>> Epoch 4/20
26/01/2026 10:28:54 >> Epoch 4 completed | Avg Loss: 1.8409
26/01/2026 10:28:59 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9343 | AUPRC: 0.7306 | MinRP: 0.6425
26/01/2026 10:29:16 >> VAL          Epoch:     4 | AUROC: 0.9080 | AUPRC: 0.6616 | MinRP: 0.6062
26/01/2026 10:29:16 >> AUPRC improved: 0.6532 ---> 0.6616 (+0.0084)
26/01/2026 10:29:16 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:2/checkpoint_best.bin
26/01/2026 10:29:16 >> ============================================================
26/01/2026 10:29:16 >> >>> Epoch 5/20
26/01/2026 10:32:39 >> Epoch 5 completed | Avg Loss: 1.8208
26/01/2026 10:32:43 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9357 | AUPRC: 0.7330 | MinRP: 0.6425
26/01/2026 10:33:00 >> VAL          Epoch:     5 | AUROC: 0.9080 | AUPRC: 0.6598 | MinRP: 0.5933
26/01/2026 10:33:00 >> No improvement. Wait: 4/5
26/01/2026 10:33:00 >> ============================================================
26/01/2026 10:33:00 >> >>> Epoch 6/20
26/01/2026 10:36:24 >> Epoch 6 completed | Avg Loss: 1.7974
26/01/2026 10:36:28 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9390 | AUPRC: 0.7445 | MinRP: 0.6622
26/01/2026 10:36:46 >> VAL          Epoch:     6 | AUROC: 0.9123 | AUPRC: 0.6696 | MinRP: 0.5978
26/01/2026 10:36:46 >> AUPRC improved: 0.6616 ---> 0.6696 (+0.0080)
26/01/2026 10:36:46 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:2/checkpoint_best.bin
26/01/2026 10:36:46 >> ============================================================
26/01/2026 10:36:46 >> >>> Epoch 7/20
26/01/2026 10:40:09 >> Epoch 7 completed | Avg Loss: 1.7621
26/01/2026 10:40:13 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9361 | AUPRC: 0.7474 | MinRP: 0.6712
26/01/2026 10:40:30 >> VAL          Epoch:     7 | AUROC: 0.9091 | AUPRC: 0.6649 | MinRP: 0.5859
26/01/2026 10:40:30 >> No improvement. Wait: 4/5
26/01/2026 10:40:30 >> ============================================================
26/01/2026 10:40:30 >> >>> Epoch 8/20
26/01/2026 10:43:53 >> Epoch 8 completed | Avg Loss: 1.7445
26/01/2026 10:43:58 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9442 | AUPRC: 0.7578 | MinRP: 0.6652
26/01/2026 10:44:15 >> VAL          Epoch:     8 | AUROC: 0.9124 | AUPRC: 0.6751 | MinRP: 0.5972
26/01/2026 10:44:15 >> AUPRC improved: 0.6696 ---> 0.6751 (+0.0055)
26/01/2026 10:44:15 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:2/checkpoint_best.bin
26/01/2026 10:44:15 >> ============================================================
26/01/2026 10:44:15 >> >>> Epoch 9/20
26/01/2026 10:47:41 >> Epoch 9 completed | Avg Loss: 1.7305
26/01/2026 10:47:45 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9452 | AUPRC: 0.7630 | MinRP: 0.6667
26/01/2026 10:48:02 >> VAL          Epoch:     9 | AUROC: 0.9120 | AUPRC: 0.6736 | MinRP: 0.5974
26/01/2026 10:48:02 >> No improvement. Wait: 4/5
26/01/2026 10:48:02 >> ============================================================
26/01/2026 10:48:02 >> >>> Epoch 10/20
26/01/2026 10:51:29 >> Epoch 10 completed | Avg Loss: 1.7123
26/01/2026 10:51:33 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9467 | AUPRC: 0.7679 | MinRP: 0.6682
26/01/2026 10:51:50 >> VAL          Epoch:    10 | AUROC: 0.9093 | AUPRC: 0.6684 | MinRP: 0.5964
26/01/2026 10:51:50 >> No improvement. Wait: 3/5
26/01/2026 10:51:50 >> ============================================================
26/01/2026 10:51:50 >> >>> Epoch 11/20
26/01/2026 10:55:17 >> Epoch 11 completed | Avg Loss: 1.6883
26/01/2026 10:55:22 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9506 | AUPRC: 0.7818 | MinRP: 0.6968
26/01/2026 10:55:39 >> VAL          Epoch:    11 | AUROC: 0.9111 | AUPRC: 0.6728 | MinRP: 0.5885
26/01/2026 10:55:39 >> No improvement. Wait: 2/5
26/01/2026 10:55:39 >> ============================================================
26/01/2026 10:55:39 >> >>> Epoch 12/20
26/01/2026 10:59:05 >> Epoch 12 completed | Avg Loss: 1.6702
26/01/2026 10:59:10 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9517 | AUPRC: 0.7825 | MinRP: 0.6787
26/01/2026 10:59:27 >> VAL          Epoch:    12 | AUROC: 0.9113 | AUPRC: 0.6757 | MinRP: 0.5958
26/01/2026 10:59:27 >> AUPRC improved: 0.6751 ---> 0.6757 (+0.0007)
26/01/2026 10:59:27 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:2/checkpoint_best.bin
26/01/2026 10:59:27 >> ============================================================
26/01/2026 10:59:27 >> >>> Epoch 13/20
26/01/2026 11:02:52 >> Epoch 13 completed | Avg Loss: 1.6598
26/01/2026 11:02:56 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9538 | AUPRC: 0.7964 | MinRP: 0.6964
26/01/2026 11:03:14 >> VAL          Epoch:    13 | AUROC: 0.9098 | AUPRC: 0.6711 | MinRP: 0.6024
26/01/2026 11:03:14 >> No improvement. Wait: 4/5
26/01/2026 11:03:14 >> ============================================================
26/01/2026 11:03:14 >> >>> Epoch 14/20
26/01/2026 11:06:40 >> Epoch 14 completed | Avg Loss: 1.6356
26/01/2026 11:06:44 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9569 | AUPRC: 0.7998 | MinRP: 0.6861
26/01/2026 11:07:01 >> VAL          Epoch:    14 | AUROC: 0.9100 | AUPRC: 0.6746 | MinRP: 0.6002
26/01/2026 11:07:01 >> No improvement. Wait: 3/5
26/01/2026 11:07:01 >> ============================================================
26/01/2026 11:07:01 >> >>> Epoch 15/20
26/01/2026 11:10:28 >> Epoch 15 completed | Avg Loss: 1.6250
26/01/2026 11:10:32 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9578 | AUPRC: 0.8015 | MinRP: 0.7104
26/01/2026 11:10:50 >> VAL          Epoch:    15 | AUROC: 0.9087 | AUPRC: 0.6705 | MinRP: 0.5971
26/01/2026 11:10:50 >> No improvement. Wait: 2/5
26/01/2026 11:10:50 >> ============================================================
26/01/2026 11:10:50 >> >>> Epoch 16/20
26/01/2026 11:14:16 >> Epoch 16 completed | Avg Loss: 1.6015
26/01/2026 11:14:20 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9602 | AUPRC: 0.8117 | MinRP: 0.7104
26/01/2026 11:14:38 >> VAL          Epoch:    16 | AUROC: 0.9087 | AUPRC: 0.6721 | MinRP: 0.5918
26/01/2026 11:14:38 >> No improvement. Wait: 1/5
26/01/2026 11:14:38 >> ============================================================
26/01/2026 11:14:38 >> >>> Epoch 17/20
26/01/2026 11:18:04 >> Epoch 17 completed | Avg Loss: 1.5873
26/01/2026 11:18:09 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9621 | AUPRC: 0.8196 | MinRP: 0.7149
26/01/2026 11:18:26 >> VAL          Epoch:    17 | AUROC: 0.9102 | AUPRC: 0.6726 | MinRP: 0.5984
26/01/2026 11:18:26 >> No improvement. Wait: 0/5
26/01/2026 11:18:26 >> Patience reached. Early stopping.

26/01/2026 11:18:26 >> ============================================================
26/01/2026 11:18:26 >> TRAINING COMPLETED
26/01/2026 11:18:26 >> ============================================================
26/01/2026 11:18:26 >> Best Validation Results:
26/01/2026 11:18:26 >>   AUROC: 0.9113 | AUPRC: 0.6757 | MinRP: 0.5958
26/01/2026 11:18:26 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/mimic_iii/ours1|fold:2/checkpoint_best.bin
26/01/2026 11:18:26 >> Evaluating on test set...
26/01/2026 11:18:48 >> TEST         AUROC: 0.9145 | AUPRC: 0.7029 | MinRP: 0.6302 | Accuracy: 0.8467

26/01/2026 11:18:48 >> ============================================================
26/01/2026 11:18:48 >> Classification Report:
26/01/2026 11:18:48 >>               precision    recall  f1-score   support
26/01/2026 11:18:48 >> 
26/01/2026 11:18:48 >>          0.0     0.9668    0.8534    0.9066      9168
26/01/2026 11:18:48 >>          1.0     0.4462    0.8010    0.5732      1352
26/01/2026 11:18:48 >> 
26/01/2026 11:18:48 >>     accuracy                         0.8467     10520
26/01/2026 11:18:48 >>    macro avg     0.7065    0.8272    0.7399     10520
26/01/2026 11:18:48 >> weighted avg     0.8999    0.8467    0.8637     10520
26/01/2026 11:18:48 >> 
26/01/2026 11:18:48 >> Confusion Matrix:
26/01/2026 11:18:48 >> [7824, 1344]
26/01/2026 11:18:48 >> [269, 1083]
26/01/2026 11:18:48 >> ============================================================
26/01/2026 11:18:48 >> ============================================================
26/01/2026 11:18:48 >> Final Test Results:
26/01/2026 11:18:48 >>   AUROC: 0.9145 | AUPRC: 0.7029 | MinRP: 0.6302 | Accuracy: 0.8467
26/01/2026 11:18:48 >> ============================================================
