24/01/2026 06:58:40 >> Namespace(dataset='mimic_iii', model_type='sand', split_file='mimic_iii_5fold.json', fold=5, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/mimic_iii/sand|fold:5', lr=0.0005, train_batch_size=64, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=128, num_layers=2, num_heads=4, dropout=0.2, r=10, M=16, logger=<utils.logger.Logger object at 0x7a001a306140>)

24/01/2026 06:58:40 >> Preparing dataset mimic_iii
24/01/2026 06:58:44 >> Using fold 5/5
24/01/2026 06:58:44 >> Loaded splits from mimic_iii_5fold.json
24/01/2026 06:59:13 >> # train, val, test TS: [33910, 8435, 10526]
24/01/2026 06:59:37 >> pos class weight: 7.0451
24/01/2026 06:59:37 >> % pos class in train, val, test splits: [0.1243, 0.1191, 0.1222]
24/01/2026 06:59:38 >> # static features: 3
24/01/2026 06:59:39 >> # TS variables (SAND): 127
24/01/2026 06:59:47 >> # timesteps (hours): 25
24/01/2026 07:00:11 >> Input shape: [N, 25, 381]

24/01/2026 07:00:11 >> Model details:
24/01/2026 07:00:11 >> # parameters: 353154
24/01/2026 07:00:11 >> # trainable parameters: 352129, 99.70975834904885%
24/01/2026 07:00:11 >> #params by dtype:
24/01/2026 07:00:11 >> torch.float32: 353154, 100.0%

24/01/2026 07:00:11 >> No. of training batches per epoch = 530

24/01/2026 07:00:11 >> ============================================================
24/01/2026 07:00:11 >>                Starting training...
24/01/2026 07:00:11 >> ============================================================
24/01/2026 07:00:11 >> >>> Epoch 1/20
24/01/2026 07:00:15 >> Epoch 1 completed | Avg Loss: 0.9615
24/01/2026 07:00:15 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9153 | AUPRC: 0.6368 | MinRP: 0.6000
24/01/2026 07:00:16 >> VAL          Epoch:     1 | AUROC: 0.8855 | AUPRC: 0.5710 | MinRP: 0.5631
24/01/2026 07:00:16 >> AUPRC improved: 0.0000 ---> 0.5710 (+0.5710)
24/01/2026 07:00:16 >> Saving checkpoint to ../outputs/mimic_iii/sand|fold:5/checkpoint_best.bin
24/01/2026 07:00:16 >> ============================================================
24/01/2026 07:00:16 >> >>> Epoch 2/20
24/01/2026 07:00:19 >> Epoch 2 completed | Avg Loss: 0.8297
24/01/2026 07:00:19 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9152 | AUPRC: 0.6335 | MinRP: 0.5957
24/01/2026 07:00:20 >> VAL          Epoch:     2 | AUROC: 0.8865 | AUPRC: 0.5781 | MinRP: 0.5592
24/01/2026 07:00:20 >> AUPRC improved: 0.5710 ---> 0.5781 (+0.0072)
24/01/2026 07:00:20 >> Saving checkpoint to ../outputs/mimic_iii/sand|fold:5/checkpoint_best.bin
24/01/2026 07:00:20 >> ============================================================
24/01/2026 07:00:20 >> >>> Epoch 3/20
24/01/2026 07:00:23 >> Epoch 3 completed | Avg Loss: 0.8022
24/01/2026 07:00:23 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9159 | AUPRC: 0.6192 | MinRP: 0.5787
24/01/2026 07:00:23 >> VAL          Epoch:     3 | AUROC: 0.8876 | AUPRC: 0.5646 | MinRP: 0.5682
24/01/2026 07:00:23 >> No improvement. Wait: 4/5
24/01/2026 07:00:23 >> ============================================================
24/01/2026 07:00:23 >> >>> Epoch 4/20
24/01/2026 07:00:27 >> Epoch 4 completed | Avg Loss: 0.7754
24/01/2026 07:00:27 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9184 | AUPRC: 0.6390 | MinRP: 0.6000
24/01/2026 07:00:27 >> VAL          Epoch:     4 | AUROC: 0.8843 | AUPRC: 0.5696 | MinRP: 0.5473
24/01/2026 07:00:27 >> No improvement. Wait: 3/5
24/01/2026 07:00:27 >> ============================================================
24/01/2026 07:00:27 >> >>> Epoch 5/20
24/01/2026 07:00:30 >> Epoch 5 completed | Avg Loss: 0.7695
24/01/2026 07:00:30 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9236 | AUPRC: 0.6604 | MinRP: 0.6125
24/01/2026 07:00:30 >> VAL          Epoch:     5 | AUROC: 0.8877 | AUPRC: 0.5851 | MinRP: 0.5618
24/01/2026 07:00:30 >> AUPRC improved: 0.5781 ---> 0.5851 (+0.0070)
24/01/2026 07:00:30 >> Saving checkpoint to ../outputs/mimic_iii/sand|fold:5/checkpoint_best.bin
24/01/2026 07:00:30 >> ============================================================
24/01/2026 07:00:30 >> >>> Epoch 6/20
24/01/2026 07:00:34 >> Epoch 6 completed | Avg Loss: 0.7543
24/01/2026 07:00:34 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9226 | AUPRC: 0.6557 | MinRP: 0.6255
24/01/2026 07:00:34 >> VAL          Epoch:     6 | AUROC: 0.8893 | AUPRC: 0.5776 | MinRP: 0.5585
24/01/2026 07:00:34 >> No improvement. Wait: 4/5
24/01/2026 07:00:34 >> ============================================================
24/01/2026 07:00:34 >> >>> Epoch 7/20
24/01/2026 07:00:38 >> Epoch 7 completed | Avg Loss: 0.7533
24/01/2026 07:00:38 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9293 | AUPRC: 0.6723 | MinRP: 0.6213
24/01/2026 07:00:38 >> VAL          Epoch:     7 | AUROC: 0.8900 | AUPRC: 0.5924 | MinRP: 0.5711
24/01/2026 07:00:38 >> AUPRC improved: 0.5851 ---> 0.5924 (+0.0073)
24/01/2026 07:00:38 >> Saving checkpoint to ../outputs/mimic_iii/sand|fold:5/checkpoint_best.bin
24/01/2026 07:00:38 >> ============================================================
24/01/2026 07:00:38 >> >>> Epoch 8/20
24/01/2026 07:00:41 >> Epoch 8 completed | Avg Loss: 0.7409
24/01/2026 07:00:41 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9294 | AUPRC: 0.6734 | MinRP: 0.6213
24/01/2026 07:00:42 >> VAL          Epoch:     8 | AUROC: 0.8924 | AUPRC: 0.5882 | MinRP: 0.5771
24/01/2026 07:00:42 >> No improvement. Wait: 4/5
24/01/2026 07:00:42 >> ============================================================
24/01/2026 07:00:42 >> >>> Epoch 9/20
24/01/2026 07:00:45 >> Epoch 9 completed | Avg Loss: 0.7289
24/01/2026 07:00:45 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9297 | AUPRC: 0.6764 | MinRP: 0.6261
24/01/2026 07:00:45 >> VAL          Epoch:     9 | AUROC: 0.8938 | AUPRC: 0.6044 | MinRP: 0.5755
24/01/2026 07:00:45 >> AUPRC improved: 0.5924 ---> 0.6044 (+0.0120)
24/01/2026 07:00:45 >> Saving checkpoint to ../outputs/mimic_iii/sand|fold:5/checkpoint_best.bin
24/01/2026 07:00:45 >> ============================================================
24/01/2026 07:00:45 >> >>> Epoch 10/20
24/01/2026 07:00:49 >> Epoch 10 completed | Avg Loss: 0.7108
24/01/2026 07:00:49 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9352 | AUPRC: 0.6867 | MinRP: 0.6229
24/01/2026 07:00:50 >> VAL          Epoch:    10 | AUROC: 0.8938 | AUPRC: 0.6132 | MinRP: 0.5710
24/01/2026 07:00:50 >> AUPRC improved: 0.6044 ---> 0.6132 (+0.0088)
24/01/2026 07:00:50 >> Saving checkpoint to ../outputs/mimic_iii/sand|fold:5/checkpoint_best.bin
24/01/2026 07:00:50 >> ============================================================
24/01/2026 07:00:50 >> >>> Epoch 11/20
24/01/2026 07:00:53 >> Epoch 11 completed | Avg Loss: 0.7034
24/01/2026 07:00:53 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9347 | AUPRC: 0.6932 | MinRP: 0.6213
24/01/2026 07:00:54 >> VAL          Epoch:    11 | AUROC: 0.8934 | AUPRC: 0.6130 | MinRP: 0.5690
24/01/2026 07:00:54 >> No improvement. Wait: 4/5
24/01/2026 07:00:54 >> ============================================================
24/01/2026 07:00:54 >> >>> Epoch 12/20
24/01/2026 07:00:57 >> Epoch 12 completed | Avg Loss: 0.6947
24/01/2026 07:00:57 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9345 | AUPRC: 0.6709 | MinRP: 0.6213
24/01/2026 07:00:58 >> VAL          Epoch:    12 | AUROC: 0.8901 | AUPRC: 0.5775 | MinRP: 0.5612
24/01/2026 07:00:58 >> No improvement. Wait: 3/5
24/01/2026 07:00:58 >> ============================================================
24/01/2026 07:00:58 >> >>> Epoch 13/20
24/01/2026 07:01:01 >> Epoch 13 completed | Avg Loss: 0.6862
24/01/2026 07:01:01 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9380 | AUPRC: 0.7151 | MinRP: 0.6417
24/01/2026 07:01:01 >> VAL          Epoch:    13 | AUROC: 0.8915 | AUPRC: 0.6081 | MinRP: 0.5721
24/01/2026 07:01:01 >> No improvement. Wait: 2/5
24/01/2026 07:01:01 >> ============================================================
24/01/2026 07:01:01 >> >>> Epoch 14/20
24/01/2026 07:01:05 >> Epoch 14 completed | Avg Loss: 0.6737
24/01/2026 07:01:05 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9407 | AUPRC: 0.7175 | MinRP: 0.6441
24/01/2026 07:01:05 >> VAL          Epoch:    14 | AUROC: 0.8949 | AUPRC: 0.6208 | MinRP: 0.5831
24/01/2026 07:01:05 >> AUPRC improved: 0.6132 ---> 0.6208 (+0.0076)
24/01/2026 07:01:05 >> Saving checkpoint to ../outputs/mimic_iii/sand|fold:5/checkpoint_best.bin
24/01/2026 07:01:05 >> ============================================================
24/01/2026 07:01:05 >> >>> Epoch 15/20
24/01/2026 07:01:09 >> Epoch 15 completed | Avg Loss: 0.6751
24/01/2026 07:01:09 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9434 | AUPRC: 0.7213 | MinRP: 0.6511
24/01/2026 07:01:09 >> VAL          Epoch:    15 | AUROC: 0.8960 | AUPRC: 0.6203 | MinRP: 0.5780
24/01/2026 07:01:09 >> No improvement. Wait: 4/5
24/01/2026 07:01:09 >> ============================================================
24/01/2026 07:01:09 >> >>> Epoch 16/20
24/01/2026 07:01:12 >> Epoch 16 completed | Avg Loss: 0.6638
24/01/2026 07:01:12 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9425 | AUPRC: 0.7263 | MinRP: 0.6444
24/01/2026 07:01:13 >> VAL          Epoch:    16 | AUROC: 0.8917 | AUPRC: 0.6149 | MinRP: 0.5660
24/01/2026 07:01:13 >> No improvement. Wait: 3/5
24/01/2026 07:01:13 >> ============================================================
24/01/2026 07:01:13 >> >>> Epoch 17/20
24/01/2026 07:01:16 >> Epoch 17 completed | Avg Loss: 0.6544
24/01/2026 07:01:17 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9497 | AUPRC: 0.7453 | MinRP: 0.6681
24/01/2026 07:01:17 >> VAL          Epoch:    17 | AUROC: 0.8916 | AUPRC: 0.6109 | MinRP: 0.5701
24/01/2026 07:01:17 >> No improvement. Wait: 2/5
24/01/2026 07:01:17 >> ============================================================
24/01/2026 07:01:17 >> >>> Epoch 18/20
24/01/2026 07:01:20 >> Epoch 18 completed | Avg Loss: 0.6465
24/01/2026 07:01:20 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9494 | AUPRC: 0.7380 | MinRP: 0.6653
24/01/2026 07:01:20 >> VAL          Epoch:    18 | AUROC: 0.8913 | AUPRC: 0.5976 | MinRP: 0.5666
24/01/2026 07:01:20 >> No improvement. Wait: 1/5
24/01/2026 07:01:20 >> ============================================================
24/01/2026 07:01:20 >> >>> Epoch 19/20
24/01/2026 07:01:24 >> Epoch 19 completed | Avg Loss: 0.6432
24/01/2026 07:01:24 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9478 | AUPRC: 0.7488 | MinRP: 0.6511
24/01/2026 07:01:24 >> VAL          Epoch:    19 | AUROC: 0.8901 | AUPRC: 0.6016 | MinRP: 0.5652
24/01/2026 07:01:24 >> No improvement. Wait: 0/5
24/01/2026 07:01:24 >> Patience reached. Early stopping.

24/01/2026 07:01:24 >> ============================================================
24/01/2026 07:01:24 >> TRAINING COMPLETED
24/01/2026 07:01:24 >> ============================================================
24/01/2026 07:01:24 >> Best Validation Results:
24/01/2026 07:01:24 >>   AUROC: 0.8949 | AUPRC: 0.6208 | MinRP: 0.5831
24/01/2026 07:01:24 >> Loading best model from ../outputs/mimic_iii/sand|fold:5/checkpoint_best.bin
24/01/2026 07:01:24 >> Evaluating on test set...
24/01/2026 07:01:24 >> TEST         AUROC: 0.8999 | AUPRC: 0.6323 | MinRP: 0.5731 | Accuracy: 0.8631

24/01/2026 07:01:24 >> ============================================================
24/01/2026 07:01:24 >> Classification Report:
24/01/2026 07:01:25 >>               precision    recall  f1-score   support
24/01/2026 07:01:25 >> 
24/01/2026 07:01:25 >>          0.0     0.9561    0.8846    0.9190      9240
24/01/2026 07:01:25 >>          1.0     0.4608    0.7084    0.5584      1286
24/01/2026 07:01:25 >> 
24/01/2026 07:01:25 >>     accuracy                         0.8631     10526
24/01/2026 07:01:25 >>    macro avg     0.7085    0.7965    0.7387     10526
24/01/2026 07:01:25 >> weighted avg     0.8956    0.8631    0.8749     10526
24/01/2026 07:01:25 >> 
24/01/2026 07:01:25 >> Confusion Matrix:
24/01/2026 07:01:25 >> [8174, 1066]
24/01/2026 07:01:25 >> [375, 911]
24/01/2026 07:01:25 >> ============================================================
24/01/2026 07:01:25 >> Final Test Results:
24/01/2026 07:01:25 >>   AUROC: 0.8999 | AUPRC: 0.6323 | MinRP: 0.5731 | Accuracy: 0.8631
24/01/2026 07:01:25 >> ============================================================
