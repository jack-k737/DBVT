24/01/2026 07:09:57 >> Namespace(dataset='mimic_iii', model_type='tcn', split_file='mimic_iii_5fold.json', fold=5, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/mimic_iii/tcn|fold:5', lr=0.0005, train_batch_size=64, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=128, num_layers=4, kernel_size=3, dropout=0.2, logger=<utils.logger.Logger object at 0x7e51bda1e140>)

24/01/2026 07:09:57 >> Preparing dataset mimic_iii
24/01/2026 07:10:01 >> Using fold 5/5
24/01/2026 07:10:01 >> Loaded splits from mimic_iii_5fold.json
24/01/2026 07:10:29 >> # train, val, test TS: [33910, 8435, 10526]
24/01/2026 07:10:52 >> pos class weight: 7.0451
24/01/2026 07:10:52 >> % pos class in train, val, test splits: [0.1243, 0.1191, 0.1222]
24/01/2026 07:10:54 >> # static features: 3
24/01/2026 07:10:54 >> # TS variables (TCN/SAND): 127
24/01/2026 07:11:02 >> # timesteps (hours): 25
24/01/2026 07:11:25 >> Input shape: [N, 25, 381]

24/01/2026 07:11:25 >> Model details:
24/01/2026 07:11:25 >> # parameters: 575489
24/01/2026 07:11:25 >> # trainable parameters: 575489, 100.0%
24/01/2026 07:11:25 >> #params by dtype:
24/01/2026 07:11:25 >> torch.float32: 575489, 100.0%

24/01/2026 07:11:25 >> No. of training batches per epoch = 530

24/01/2026 07:11:25 >> ============================================================
24/01/2026 07:11:25 >>                Starting training...
24/01/2026 07:11:25 >> ============================================================
24/01/2026 07:11:25 >> >>> Epoch 1/20
24/01/2026 07:11:29 >> Epoch 1 completed | Avg Loss: 0.8251
24/01/2026 07:11:29 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9249 | AUPRC: 0.6646 | MinRP: 0.6170
24/01/2026 07:11:29 >> VAL          Epoch:     1 | AUROC: 0.8917 | AUPRC: 0.5864 | MinRP: 0.5672
24/01/2026 07:11:29 >> AUPRC improved: 0.0000 ---> 0.5864 (+0.5864)
24/01/2026 07:11:29 >> Saving checkpoint to ../outputs/mimic_iii/tcn|fold:5/checkpoint_best.bin
24/01/2026 07:11:29 >> ============================================================
24/01/2026 07:11:29 >> >>> Epoch 2/20
24/01/2026 07:11:32 >> Epoch 2 completed | Avg Loss: 0.7163
24/01/2026 07:11:33 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9271 | AUPRC: 0.6872 | MinRP: 0.6382
24/01/2026 07:11:33 >> VAL          Epoch:     2 | AUROC: 0.8942 | AUPRC: 0.6116 | MinRP: 0.5701
24/01/2026 07:11:33 >> AUPRC improved: 0.5864 ---> 0.6116 (+0.0252)
24/01/2026 07:11:33 >> Saving checkpoint to ../outputs/mimic_iii/tcn|fold:5/checkpoint_best.bin
24/01/2026 07:11:33 >> ============================================================
24/01/2026 07:11:33 >> >>> Epoch 3/20
24/01/2026 07:11:36 >> Epoch 3 completed | Avg Loss: 0.6748
24/01/2026 07:11:36 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9417 | AUPRC: 0.7178 | MinRP: 0.6553
24/01/2026 07:11:36 >> VAL          Epoch:     3 | AUROC: 0.8955 | AUPRC: 0.6143 | MinRP: 0.5771
24/01/2026 07:11:36 >> AUPRC improved: 0.6116 ---> 0.6143 (+0.0026)
24/01/2026 07:11:36 >> Saving checkpoint to ../outputs/mimic_iii/tcn|fold:5/checkpoint_best.bin
24/01/2026 07:11:36 >> ============================================================
24/01/2026 07:11:36 >> >>> Epoch 4/20
24/01/2026 07:11:40 >> Epoch 4 completed | Avg Loss: 0.6393
24/01/2026 07:11:40 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9450 | AUPRC: 0.7394 | MinRP: 0.6681
24/01/2026 07:11:40 >> VAL          Epoch:     4 | AUROC: 0.8907 | AUPRC: 0.6311 | MinRP: 0.5769
24/01/2026 07:11:40 >> AUPRC improved: 0.6143 ---> 0.6311 (+0.0169)
24/01/2026 07:11:40 >> Saving checkpoint to ../outputs/mimic_iii/tcn|fold:5/checkpoint_best.bin
24/01/2026 07:11:40 >> ============================================================
24/01/2026 07:11:40 >> >>> Epoch 5/20
24/01/2026 07:11:43 >> Epoch 5 completed | Avg Loss: 0.6069
24/01/2026 07:11:43 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9602 | AUPRC: 0.8036 | MinRP: 0.7076
24/01/2026 07:11:44 >> VAL          Epoch:     5 | AUROC: 0.8879 | AUPRC: 0.6291 | MinRP: 0.5736
24/01/2026 07:11:44 >> No improvement. Wait: 4/5
24/01/2026 07:11:44 >> ============================================================
24/01/2026 07:11:44 >> >>> Epoch 6/20
24/01/2026 07:11:47 >> Epoch 6 completed | Avg Loss: 0.5581
24/01/2026 07:11:47 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9662 | AUPRC: 0.8112 | MinRP: 0.7215
24/01/2026 07:11:47 >> VAL          Epoch:     6 | AUROC: 0.8723 | AUPRC: 0.5911 | MinRP: 0.5552
24/01/2026 07:11:47 >> No improvement. Wait: 3/5
24/01/2026 07:11:47 >> ============================================================
24/01/2026 07:11:47 >> >>> Epoch 7/20
24/01/2026 07:11:51 >> Epoch 7 completed | Avg Loss: 0.4908
24/01/2026 07:11:51 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9782 | AUPRC: 0.8668 | MinRP: 0.7764
24/01/2026 07:11:51 >> VAL          Epoch:     7 | AUROC: 0.8720 | AUPRC: 0.6030 | MinRP: 0.5761
24/01/2026 07:11:51 >> No improvement. Wait: 2/5
24/01/2026 07:11:51 >> ============================================================
24/01/2026 07:11:51 >> >>> Epoch 8/20
24/01/2026 07:11:54 >> Epoch 8 completed | Avg Loss: 0.4340
24/01/2026 07:11:54 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9824 | AUPRC: 0.8887 | MinRP: 0.8000
24/01/2026 07:11:55 >> VAL          Epoch:     8 | AUROC: 0.8648 | AUPRC: 0.5746 | MinRP: 0.5506
24/01/2026 07:11:55 >> No improvement. Wait: 1/5
24/01/2026 07:11:55 >> ============================================================
24/01/2026 07:11:55 >> >>> Epoch 9/20
24/01/2026 07:11:58 >> Epoch 9 completed | Avg Loss: 0.3850
24/01/2026 07:11:58 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9870 | AUPRC: 0.9110 | MinRP: 0.8445
24/01/2026 07:11:58 >> VAL          Epoch:     9 | AUROC: 0.8604 | AUPRC: 0.5895 | MinRP: 0.5433
24/01/2026 07:11:58 >> No improvement. Wait: 0/5
24/01/2026 07:11:58 >> Patience reached. Early stopping.

24/01/2026 07:11:58 >> ============================================================
24/01/2026 07:11:58 >> TRAINING COMPLETED
24/01/2026 07:11:58 >> ============================================================
24/01/2026 07:11:58 >> Best Validation Results:
24/01/2026 07:11:58 >>   AUROC: 0.8907 | AUPRC: 0.6311 | MinRP: 0.5769
24/01/2026 07:11:58 >> Loading best model from ../outputs/mimic_iii/tcn|fold:5/checkpoint_best.bin
24/01/2026 07:11:58 >> Evaluating on test set...
24/01/2026 07:11:59 >> TEST         AUROC: 0.8985 | AUPRC: 0.6346 | MinRP: 0.5816 | Accuracy: 0.8644

24/01/2026 07:11:59 >> ============================================================
24/01/2026 07:11:59 >> Classification Report:
24/01/2026 07:11:59 >>               precision    recall  f1-score   support
24/01/2026 07:11:59 >> 
24/01/2026 07:11:59 >>          0.0     0.9580    0.8843    0.9197      9240
24/01/2026 07:11:59 >>          1.0     0.4647    0.7216    0.5653      1286
24/01/2026 07:11:59 >> 
24/01/2026 07:11:59 >>     accuracy                         0.8644     10526
24/01/2026 07:11:59 >>    macro avg     0.7114    0.8030    0.7425     10526
24/01/2026 07:11:59 >> weighted avg     0.8978    0.8644    0.8764     10526
24/01/2026 07:11:59 >> 
24/01/2026 07:11:59 >> Confusion Matrix:
24/01/2026 07:11:59 >> [8171, 1069]
24/01/2026 07:11:59 >> [358, 928]
24/01/2026 07:11:59 >> ============================================================
24/01/2026 07:11:59 >> Final Test Results:
24/01/2026 07:11:59 >>   AUROC: 0.8985 | AUPRC: 0.6346 | MinRP: 0.5816 | Accuracy: 0.8644
24/01/2026 07:11:59 >> ============================================================
