24/01/2026 22:13:49 >> Namespace(dataset='mimic_iii', model_type='grud', split_file='mimic_iii_5fold.json', fold=2, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/mimic_iii/grud|fold:2', lr=0.0005, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=3.0, max_obs=880, max_timesteps=880, device='cuda:0', seed=2026, hid_dim=64, dropout=0.2, logger=<utils.logger.Logger object at 0x7855daa1e140>)

24/01/2026 22:13:49 >> Preparing dataset mimic_iii
24/01/2026 22:13:53 >> Using fold 2/5
24/01/2026 22:13:53 >> Loaded splits from mimic_iii_5fold.json
24/01/2026 22:14:23 >> # train, val, test TS: [33915, 8436, 10520]
24/01/2026 22:14:46 >> pos class weight: 7.1762
24/01/2026 22:14:46 >> % pos class in train, val, test splits: [0.1223, 0.1193, 0.1285]
24/01/2026 22:14:48 >> # static features: 3
24/01/2026 22:14:49 >> [GRU-D] # TS variables: 127
24/01/2026 22:14:57 >> [GRU-D] # timesteps (hourly): 25

24/01/2026 22:16:03 >> Model details:
24/01/2026 22:16:03 >> # parameters: 78591
24/01/2026 22:16:03 >> # trainable parameters: 78591, 100.0%
24/01/2026 22:16:03 >> #params by dtype:
24/01/2026 22:16:03 >> torch.float32: 78591, 100.0%

24/01/2026 22:16:03 >> No. of training batches per epoch = 1060

24/01/2026 22:16:03 >> ============================================================
24/01/2026 22:16:03 >>                Starting training...
24/01/2026 22:16:03 >> ============================================================
24/01/2026 22:16:03 >> >>> Epoch 1/20
24/01/2026 22:16:42 >> Epoch 1 completed | Avg Loss: 0.8029
24/01/2026 22:16:44 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9149 | AUPRC: 0.6522 | MinRP: 0.6126
24/01/2026 22:16:46 >> VAL          Epoch:     1 | AUROC: 0.8957 | AUPRC: 0.6031 | MinRP: 0.5675
24/01/2026 22:16:46 >> AUPRC improved: 0.0000 ---> 0.6031 (+0.6031)
24/01/2026 22:16:46 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:16:46 >> ============================================================
24/01/2026 22:16:46 >> >>> Epoch 2/20
24/01/2026 22:17:22 >> Epoch 2 completed | Avg Loss: 0.7263
24/01/2026 22:17:23 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9231 | AUPRC: 0.6777 | MinRP: 0.6290
24/01/2026 22:17:25 >> VAL          Epoch:     2 | AUROC: 0.9010 | AUPRC: 0.6187 | MinRP: 0.5783
24/01/2026 22:17:25 >> AUPRC improved: 0.6031 ---> 0.6187 (+0.0156)
24/01/2026 22:17:25 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:17:25 >> ============================================================
24/01/2026 22:17:25 >> >>> Epoch 3/20
24/01/2026 22:18:03 >> Epoch 3 completed | Avg Loss: 0.7011
24/01/2026 22:18:03 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9290 | AUPRC: 0.7031 | MinRP: 0.6742
24/01/2026 22:18:05 >> VAL          Epoch:     3 | AUROC: 0.9020 | AUPRC: 0.6321 | MinRP: 0.5903
24/01/2026 22:18:05 >> AUPRC improved: 0.6187 ---> 0.6321 (+0.0134)
24/01/2026 22:18:05 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:18:05 >> ============================================================
24/01/2026 22:18:05 >> >>> Epoch 4/20
24/01/2026 22:18:43 >> Epoch 4 completed | Avg Loss: 0.6778
24/01/2026 22:18:43 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9364 | AUPRC: 0.7219 | MinRP: 0.6697
24/01/2026 22:18:45 >> VAL          Epoch:     4 | AUROC: 0.9043 | AUPRC: 0.6371 | MinRP: 0.5865
24/01/2026 22:18:45 >> AUPRC improved: 0.6321 ---> 0.6371 (+0.0050)
24/01/2026 22:18:45 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:18:45 >> ============================================================
24/01/2026 22:18:45 >> >>> Epoch 5/20
24/01/2026 22:19:22 >> Epoch 5 completed | Avg Loss: 0.6575
24/01/2026 22:19:23 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9362 | AUPRC: 0.7297 | MinRP: 0.6742
24/01/2026 22:19:25 >> VAL          Epoch:     5 | AUROC: 0.9027 | AUPRC: 0.6375 | MinRP: 0.5828
24/01/2026 22:19:25 >> AUPRC improved: 0.6371 ---> 0.6375 (+0.0003)
24/01/2026 22:19:25 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:19:25 >> ============================================================
24/01/2026 22:19:25 >> >>> Epoch 6/20
24/01/2026 22:20:02 >> Epoch 6 completed | Avg Loss: 0.6490
24/01/2026 22:20:03 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9449 | AUPRC: 0.7476 | MinRP: 0.6878
24/01/2026 22:20:05 >> VAL          Epoch:     6 | AUROC: 0.9047 | AUPRC: 0.6421 | MinRP: 0.5795
24/01/2026 22:20:05 >> AUPRC improved: 0.6375 ---> 0.6421 (+0.0047)
24/01/2026 22:20:05 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:20:05 >> ============================================================
24/01/2026 22:20:05 >> >>> Epoch 7/20
24/01/2026 22:20:42 >> Epoch 7 completed | Avg Loss: 0.6376
24/01/2026 22:20:43 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9433 | AUPRC: 0.7431 | MinRP: 0.6830
24/01/2026 22:20:44 >> VAL          Epoch:     7 | AUROC: 0.9033 | AUPRC: 0.6403 | MinRP: 0.5730
24/01/2026 22:20:44 >> No improvement. Wait: 4/5
24/01/2026 22:20:44 >> ============================================================
24/01/2026 22:20:44 >> >>> Epoch 8/20
24/01/2026 22:21:22 >> Epoch 8 completed | Avg Loss: 0.6267
24/01/2026 22:21:22 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9507 | AUPRC: 0.7659 | MinRP: 0.6886
24/01/2026 22:21:24 >> VAL          Epoch:     8 | AUROC: 0.9053 | AUPRC: 0.6448 | MinRP: 0.5802
24/01/2026 22:21:24 >> AUPRC improved: 0.6421 ---> 0.6448 (+0.0027)
24/01/2026 22:21:24 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:21:24 >> ============================================================
24/01/2026 22:21:24 >> >>> Epoch 9/20
24/01/2026 22:22:01 >> Epoch 9 completed | Avg Loss: 0.6127
24/01/2026 22:22:02 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9548 | AUPRC: 0.7820 | MinRP: 0.7059
24/01/2026 22:22:03 >> VAL          Epoch:     9 | AUROC: 0.9037 | AUPRC: 0.6462 | MinRP: 0.5795
24/01/2026 22:22:03 >> AUPRC improved: 0.6448 ---> 0.6462 (+0.0013)
24/01/2026 22:22:03 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:22:03 >> ============================================================
24/01/2026 22:22:03 >> >>> Epoch 10/20
24/01/2026 22:22:40 >> Epoch 10 completed | Avg Loss: 0.5967
24/01/2026 22:22:40 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9538 | AUPRC: 0.7819 | MinRP: 0.7207
24/01/2026 22:22:42 >> VAL          Epoch:    10 | AUROC: 0.9028 | AUPRC: 0.6431 | MinRP: 0.5764
24/01/2026 22:22:42 >> No improvement. Wait: 4/5
24/01/2026 22:22:42 >> ============================================================
24/01/2026 22:22:42 >> >>> Epoch 11/20
24/01/2026 22:23:19 >> Epoch 11 completed | Avg Loss: 0.5954
24/01/2026 22:23:20 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9575 | AUPRC: 0.7902 | MinRP: 0.7027
24/01/2026 22:23:22 >> VAL          Epoch:    11 | AUROC: 0.9031 | AUPRC: 0.6438 | MinRP: 0.5726
24/01/2026 22:23:22 >> No improvement. Wait: 3/5
24/01/2026 22:23:22 >> ============================================================
24/01/2026 22:23:22 >> >>> Epoch 12/20
24/01/2026 22:23:59 >> Epoch 12 completed | Avg Loss: 0.5785
24/01/2026 22:23:59 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9582 | AUPRC: 0.7975 | MinRP: 0.7240
24/01/2026 22:24:01 >> VAL          Epoch:    12 | AUROC: 0.9031 | AUPRC: 0.6461 | MinRP: 0.5736
24/01/2026 22:24:01 >> No improvement. Wait: 2/5
24/01/2026 22:24:01 >> ============================================================
24/01/2026 22:24:01 >> >>> Epoch 13/20
24/01/2026 22:24:39 >> Epoch 13 completed | Avg Loss: 0.5706
24/01/2026 22:24:39 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9611 | AUPRC: 0.8064 | MinRP: 0.7297
24/01/2026 22:24:42 >> VAL          Epoch:    13 | AUROC: 0.9023 | AUPRC: 0.6462 | MinRP: 0.5776
24/01/2026 22:24:42 >> AUPRC improved: 0.6462 ---> 0.6462 (+0.0001)
24/01/2026 22:24:42 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:24:42 >> ============================================================
24/01/2026 22:24:42 >> >>> Epoch 14/20
24/01/2026 22:25:19 >> Epoch 14 completed | Avg Loss: 0.5617
24/01/2026 22:25:19 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9670 | AUPRC: 0.8197 | MinRP: 0.7342
24/01/2026 22:25:21 >> VAL          Epoch:    14 | AUROC: 0.9001 | AUPRC: 0.6395 | MinRP: 0.5686
24/01/2026 22:25:21 >> No improvement. Wait: 4/5
24/01/2026 22:25:21 >> ============================================================
24/01/2026 22:25:21 >> >>> Epoch 15/20
24/01/2026 22:25:59 >> Epoch 15 completed | Avg Loss: 0.5478
24/01/2026 22:25:59 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9671 | AUPRC: 0.8190 | MinRP: 0.7240
24/01/2026 22:26:01 >> VAL          Epoch:    15 | AUROC: 0.9000 | AUPRC: 0.6437 | MinRP: 0.5636
24/01/2026 22:26:01 >> No improvement. Wait: 3/5
24/01/2026 22:26:01 >> ============================================================
24/01/2026 22:26:01 >> >>> Epoch 16/20
24/01/2026 22:26:34 >> Epoch 16 completed | Avg Loss: 0.5438
24/01/2026 22:26:35 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9679 | AUPRC: 0.8265 | MinRP: 0.7297
24/01/2026 22:26:36 >> VAL          Epoch:    16 | AUROC: 0.9012 | AUPRC: 0.6446 | MinRP: 0.5606
24/01/2026 22:26:36 >> No improvement. Wait: 2/5
24/01/2026 22:26:36 >> ============================================================
24/01/2026 22:26:36 >> >>> Epoch 17/20
24/01/2026 22:27:10 >> Epoch 17 completed | Avg Loss: 0.5304
24/01/2026 22:27:10 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9727 | AUPRC: 0.8453 | MinRP: 0.7557
24/01/2026 22:27:12 >> VAL          Epoch:    17 | AUROC: 0.9002 | AUPRC: 0.6450 | MinRP: 0.5680
24/01/2026 22:27:12 >> No improvement. Wait: 1/5
24/01/2026 22:27:12 >> ============================================================
24/01/2026 22:27:12 >> >>> Epoch 18/20
24/01/2026 22:27:42 >> Epoch 18 completed | Avg Loss: 0.5239
24/01/2026 22:27:43 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9722 | AUPRC: 0.8401 | MinRP: 0.7444
24/01/2026 22:27:44 >> VAL          Epoch:    18 | AUROC: 0.9003 | AUPRC: 0.6472 | MinRP: 0.5819
24/01/2026 22:27:44 >> AUPRC improved: 0.6462 ---> 0.6472 (+0.0010)
24/01/2026 22:27:44 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:27:44 >> ============================================================
24/01/2026 22:27:44 >> >>> Epoch 19/20
24/01/2026 22:28:13 >> Epoch 19 completed | Avg Loss: 0.5218
24/01/2026 22:28:13 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9762 | AUPRC: 0.8537 | MinRP: 0.7647
24/01/2026 22:28:14 >> VAL          Epoch:    19 | AUROC: 0.8985 | AUPRC: 0.6407 | MinRP: 0.5616
24/01/2026 22:28:14 >> No improvement. Wait: 4/5
24/01/2026 22:28:14 >> ============================================================
24/01/2026 22:28:14 >> >>> Epoch 20/20
24/01/2026 22:28:42 >> Epoch 20 completed | Avg Loss: 0.5120
24/01/2026 22:28:43 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.9793 | AUPRC: 0.8645 | MinRP: 0.7812
24/01/2026 22:28:44 >> VAL          Epoch:    20 | AUROC: 0.9000 | AUPRC: 0.6440 | MinRP: 0.5706
24/01/2026 22:28:44 >> No improvement. Wait: 3/5
24/01/2026 22:28:44 >> ============================================================

24/01/2026 22:28:44 >> ============================================================
24/01/2026 22:28:44 >> TRAINING COMPLETED
24/01/2026 22:28:44 >> ============================================================
24/01/2026 22:28:44 >> Best Validation Results:
24/01/2026 22:28:44 >>   AUROC: 0.9003 | AUPRC: 0.6472 | MinRP: 0.5819
24/01/2026 22:28:44 >> Loading best model from ../outputs/mimic_iii/grud|fold:2/checkpoint_best.bin
24/01/2026 22:28:44 >> Evaluating on test set...
24/01/2026 22:28:45 >> TEST         AUROC: 0.9048 | AUPRC: 0.6780 | MinRP: 0.6013 | Accuracy: 0.8502

24/01/2026 22:28:45 >> ============================================================
24/01/2026 22:28:45 >> Classification Report:
24/01/2026 22:28:45 >>               precision    recall  f1-score   support
24/01/2026 22:28:45 >> 
24/01/2026 22:28:45 >>          0.0     0.9630    0.8611    0.9092      9168
24/01/2026 22:28:45 >>          1.0     0.4518    0.7759    0.5710      1352
24/01/2026 22:28:45 >> 
24/01/2026 22:28:45 >>     accuracy                         0.8502     10520
24/01/2026 22:28:45 >>    macro avg     0.7074    0.8185    0.7401     10520
24/01/2026 22:28:45 >> weighted avg     0.8973    0.8502    0.8658     10520
24/01/2026 22:28:45 >> 
24/01/2026 22:28:45 >> Confusion Matrix:
24/01/2026 22:28:45 >> [7895, 1273]
24/01/2026 22:28:45 >> [303, 1049]
24/01/2026 22:28:45 >> ============================================================
24/01/2026 22:28:45 >> Final Test Results:
24/01/2026 22:28:45 >>   AUROC: 0.9048 | AUPRC: 0.6780 | MinRP: 0.6013 | Accuracy: 0.8502
24/01/2026 22:28:45 >> ============================================================
