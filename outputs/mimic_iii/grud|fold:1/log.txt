24/01/2026 22:13:50 >> Namespace(dataset='mimic_iii', model_type='grud', split_file='mimic_iii_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/mimic_iii/grud|fold:1', lr=0.0005, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=3.0, max_obs=880, max_timesteps=880, device='cuda:0', seed=2026, hid_dim=64, dropout=0.2, logger=<utils.logger.Logger object at 0x70b443106140>)

24/01/2026 22:13:50 >> Preparing dataset mimic_iii
24/01/2026 22:13:54 >> Using fold 1/5
24/01/2026 22:13:54 >> Loaded splits from mimic_iii_5fold.json
24/01/2026 22:14:22 >> # train, val, test TS: [33817, 8471, 10583]
24/01/2026 22:14:46 >> pos class weight: 7.1487
24/01/2026 22:14:46 >> % pos class in train, val, test splits: [0.1227, 0.1277, 0.1204]
24/01/2026 22:14:47 >> # static features: 3
24/01/2026 22:14:48 >> [GRU-D] # TS variables: 127
24/01/2026 22:14:56 >> [GRU-D] # timesteps (hourly): 25

24/01/2026 22:16:00 >> Model details:
24/01/2026 22:16:00 >> # parameters: 78591
24/01/2026 22:16:00 >> # trainable parameters: 78591, 100.0%
24/01/2026 22:16:00 >> #params by dtype:
24/01/2026 22:16:00 >> torch.float32: 78591, 100.0%

24/01/2026 22:16:00 >> No. of training batches per epoch = 1057

24/01/2026 22:16:00 >> ============================================================
24/01/2026 22:16:00 >>                Starting training...
24/01/2026 22:16:00 >> ============================================================
24/01/2026 22:16:00 >> >>> Epoch 1/20
24/01/2026 22:16:38 >> Epoch 1 completed | Avg Loss: 0.8111
24/01/2026 22:16:40 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9146 | AUPRC: 0.6751 | MinRP: 0.6118
24/01/2026 22:16:41 >> VAL          Epoch:     1 | AUROC: 0.8954 | AUPRC: 0.6124 | MinRP: 0.5633
24/01/2026 22:16:41 >> AUPRC improved: 0.0000 ---> 0.6124 (+0.6124)
24/01/2026 22:16:41 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:1/checkpoint_best.bin
24/01/2026 22:16:41 >> ============================================================
24/01/2026 22:16:41 >> >>> Epoch 2/20
24/01/2026 22:17:19 >> Epoch 2 completed | Avg Loss: 0.7176
24/01/2026 22:17:19 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9259 | AUPRC: 0.7092 | MinRP: 0.6597
24/01/2026 22:17:21 >> VAL          Epoch:     2 | AUROC: 0.9000 | AUPRC: 0.6341 | MinRP: 0.5808
24/01/2026 22:17:21 >> AUPRC improved: 0.6124 ---> 0.6341 (+0.0217)
24/01/2026 22:17:21 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:1/checkpoint_best.bin
24/01/2026 22:17:21 >> ============================================================
24/01/2026 22:17:21 >> >>> Epoch 3/20
24/01/2026 22:17:59 >> Epoch 3 completed | Avg Loss: 0.6870
24/01/2026 22:17:59 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9298 | AUPRC: 0.7275 | MinRP: 0.6525
24/01/2026 22:18:01 >> VAL          Epoch:     3 | AUROC: 0.9041 | AUPRC: 0.6411 | MinRP: 0.5934
24/01/2026 22:18:01 >> AUPRC improved: 0.6341 ---> 0.6411 (+0.0069)
24/01/2026 22:18:01 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:1/checkpoint_best.bin
24/01/2026 22:18:01 >> ============================================================
24/01/2026 22:18:01 >> >>> Epoch 4/20
24/01/2026 22:18:38 >> Epoch 4 completed | Avg Loss: 0.6777
24/01/2026 22:18:39 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9384 | AUPRC: 0.7442 | MinRP: 0.6835
24/01/2026 22:18:41 >> VAL          Epoch:     4 | AUROC: 0.9037 | AUPRC: 0.6486 | MinRP: 0.5813
24/01/2026 22:18:41 >> AUPRC improved: 0.6411 ---> 0.6486 (+0.0075)
24/01/2026 22:18:41 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:1/checkpoint_best.bin
24/01/2026 22:18:41 >> ============================================================
24/01/2026 22:18:41 >> >>> Epoch 5/20
24/01/2026 22:19:18 >> Epoch 5 completed | Avg Loss: 0.6474
24/01/2026 22:19:19 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9401 | AUPRC: 0.7517 | MinRP: 0.6780
24/01/2026 22:19:21 >> VAL          Epoch:     5 | AUROC: 0.9068 | AUPRC: 0.6569 | MinRP: 0.5924
24/01/2026 22:19:21 >> AUPRC improved: 0.6486 ---> 0.6569 (+0.0083)
24/01/2026 22:19:21 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:1/checkpoint_best.bin
24/01/2026 22:19:21 >> ============================================================
24/01/2026 22:19:21 >> >>> Epoch 6/20
24/01/2026 22:19:58 >> Epoch 6 completed | Avg Loss: 0.6440
24/01/2026 22:19:58 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9413 | AUPRC: 0.7579 | MinRP: 0.6695
24/01/2026 22:20:01 >> VAL          Epoch:     6 | AUROC: 0.9073 | AUPRC: 0.6555 | MinRP: 0.5869
24/01/2026 22:20:01 >> No improvement. Wait: 4/5
24/01/2026 22:20:01 >> ============================================================
24/01/2026 22:20:01 >> >>> Epoch 7/20
24/01/2026 22:20:38 >> Epoch 7 completed | Avg Loss: 0.6291
24/01/2026 22:20:38 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9455 | AUPRC: 0.7740 | MinRP: 0.7034
24/01/2026 22:20:40 >> VAL          Epoch:     7 | AUROC: 0.9068 | AUPRC: 0.6589 | MinRP: 0.6011
24/01/2026 22:20:40 >> AUPRC improved: 0.6569 ---> 0.6589 (+0.0020)
24/01/2026 22:20:40 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:1/checkpoint_best.bin
24/01/2026 22:20:40 >> ============================================================
24/01/2026 22:20:40 >> >>> Epoch 8/20
24/01/2026 22:21:17 >> Epoch 8 completed | Avg Loss: 0.6237
24/01/2026 22:21:18 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9491 | AUPRC: 0.7792 | MinRP: 0.7017
24/01/2026 22:21:20 >> VAL          Epoch:     8 | AUROC: 0.9074 | AUPRC: 0.6583 | MinRP: 0.5980
24/01/2026 22:21:20 >> No improvement. Wait: 4/5
24/01/2026 22:21:20 >> ============================================================
24/01/2026 22:21:20 >> >>> Epoch 9/20
24/01/2026 22:21:57 >> Epoch 9 completed | Avg Loss: 0.6087
24/01/2026 22:21:57 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9520 | AUPRC: 0.7844 | MinRP: 0.7143
24/01/2026 22:21:59 >> VAL          Epoch:     9 | AUROC: 0.9071 | AUPRC: 0.6610 | MinRP: 0.6002
24/01/2026 22:21:59 >> AUPRC improved: 0.6589 ---> 0.6610 (+0.0021)
24/01/2026 22:21:59 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:1/checkpoint_best.bin
24/01/2026 22:21:59 >> ============================================================
24/01/2026 22:21:59 >> >>> Epoch 10/20
24/01/2026 22:22:36 >> Epoch 10 completed | Avg Loss: 0.5935
24/01/2026 22:22:37 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9529 | AUPRC: 0.7961 | MinRP: 0.7004
24/01/2026 22:22:39 >> VAL          Epoch:    10 | AUROC: 0.9084 | AUPRC: 0.6654 | MinRP: 0.6022
24/01/2026 22:22:39 >> AUPRC improved: 0.6610 ---> 0.6654 (+0.0043)
24/01/2026 22:22:39 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:1/checkpoint_best.bin
24/01/2026 22:22:39 >> ============================================================
24/01/2026 22:22:39 >> >>> Epoch 11/20
24/01/2026 22:23:15 >> Epoch 11 completed | Avg Loss: 0.5855
24/01/2026 22:23:16 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9525 | AUPRC: 0.7890 | MinRP: 0.6949
24/01/2026 22:23:18 >> VAL          Epoch:    11 | AUROC: 0.9068 | AUPRC: 0.6577 | MinRP: 0.5917
24/01/2026 22:23:18 >> No improvement. Wait: 4/5
24/01/2026 22:23:18 >> ============================================================
24/01/2026 22:23:18 >> >>> Epoch 12/20
24/01/2026 22:23:55 >> Epoch 12 completed | Avg Loss: 0.5786
24/01/2026 22:23:56 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9592 | AUPRC: 0.8064 | MinRP: 0.7353
24/01/2026 22:23:58 >> VAL          Epoch:    12 | AUROC: 0.9069 | AUPRC: 0.6624 | MinRP: 0.5952
24/01/2026 22:23:58 >> No improvement. Wait: 3/5
24/01/2026 22:23:58 >> ============================================================
24/01/2026 22:23:58 >> >>> Epoch 13/20
24/01/2026 22:24:35 >> Epoch 13 completed | Avg Loss: 0.5647
24/01/2026 22:24:35 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9615 | AUPRC: 0.8207 | MinRP: 0.7415
24/01/2026 22:24:37 >> VAL          Epoch:    13 | AUROC: 0.9064 | AUPRC: 0.6601 | MinRP: 0.5939
24/01/2026 22:24:37 >> No improvement. Wait: 2/5
24/01/2026 22:24:37 >> ============================================================
24/01/2026 22:24:37 >> >>> Epoch 14/20
24/01/2026 22:25:14 >> Epoch 14 completed | Avg Loss: 0.5537
24/01/2026 22:25:15 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9644 | AUPRC: 0.8275 | MinRP: 0.7458
24/01/2026 22:25:16 >> VAL          Epoch:    14 | AUROC: 0.9065 | AUPRC: 0.6602 | MinRP: 0.5937
24/01/2026 22:25:16 >> No improvement. Wait: 1/5
24/01/2026 22:25:16 >> ============================================================
24/01/2026 22:25:16 >> >>> Epoch 15/20
24/01/2026 22:25:53 >> Epoch 15 completed | Avg Loss: 0.5564
24/01/2026 22:25:54 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9641 | AUPRC: 0.8238 | MinRP: 0.7426
24/01/2026 22:25:55 >> VAL          Epoch:    15 | AUROC: 0.9050 | AUPRC: 0.6593 | MinRP: 0.5943
24/01/2026 22:25:55 >> No improvement. Wait: 0/5
24/01/2026 22:25:55 >> Patience reached. Early stopping.

24/01/2026 22:25:55 >> ============================================================
24/01/2026 22:25:55 >> TRAINING COMPLETED
24/01/2026 22:25:55 >> ============================================================
24/01/2026 22:25:55 >> Best Validation Results:
24/01/2026 22:25:55 >>   AUROC: 0.9084 | AUPRC: 0.6654 | MinRP: 0.6022
24/01/2026 22:25:55 >> Loading best model from ../outputs/mimic_iii/grud|fold:1/checkpoint_best.bin
24/01/2026 22:25:55 >> Evaluating on test set...
24/01/2026 22:25:58 >> TEST         AUROC: 0.9069 | AUPRC: 0.6674 | MinRP: 0.5942 | Accuracy: 0.8462

24/01/2026 22:25:58 >> ============================================================
24/01/2026 22:25:58 >> Classification Report:
24/01/2026 22:25:58 >>               precision    recall  f1-score   support
24/01/2026 22:25:58 >> 
24/01/2026 22:25:58 >>          0.0     0.9667    0.8545    0.9072      9309
24/01/2026 22:25:58 >>          1.0     0.4248    0.7849    0.5513      1274
24/01/2026 22:25:58 >> 
24/01/2026 22:25:58 >>     accuracy                         0.8462     10583
24/01/2026 22:25:58 >>    macro avg     0.6958    0.8197    0.7292     10583
24/01/2026 22:25:58 >> weighted avg     0.9015    0.8462    0.8643     10583
24/01/2026 22:25:58 >> 
24/01/2026 22:25:58 >> Confusion Matrix:
24/01/2026 22:25:58 >> [7955, 1354]
24/01/2026 22:25:58 >> [274, 1000]
24/01/2026 22:25:58 >> ============================================================
24/01/2026 22:25:58 >> Final Test Results:
24/01/2026 22:25:58 >>   AUROC: 0.9069 | AUPRC: 0.6674 | MinRP: 0.5942 | Accuracy: 0.8462
24/01/2026 22:25:58 >> ============================================================
