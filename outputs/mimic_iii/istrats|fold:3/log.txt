22/01/2026 19:34:11 >> Namespace(dataset='mimic_iii', model_type='istrats', split_file='mimic_iii_5fold.json', fold=3, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/mimic_iii/istrats|fold:3', lr=0.0006, train_batch_size=16, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=3.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=32, num_layers=1, num_heads=16, dropout=0.15, attention_dropout=0.25, logger=<utils.logger.Logger object at 0x7f290d102140>)

22/01/2026 19:34:11 >> Preparing dataset mimic_iii
22/01/2026 19:34:15 >> Using fold 3/5
22/01/2026 19:34:15 >> Loaded splits from mimic_iii_5fold.json
22/01/2026 19:34:42 >> # train, val, test TS: [33866, 8436, 10569]
22/01/2026 19:35:04 >> pos class weight: 7.0423
22/01/2026 19:35:04 >> % pos class in train, val, test splits: [0.1243, 0.1193, 0.1220]
22/01/2026 19:35:06 >> # static features: 3
22/01/2026 19:35:17 >> # TS variables: 127

22/01/2026 19:35:41 >> Model details:
22/01/2026 19:35:41 >> # parameters: 16152
22/01/2026 19:35:41 >> # trainable parameters: 16152, 100.0%
22/01/2026 19:35:41 >> #params by dtype:
22/01/2026 19:35:41 >> torch.float32: 16152, 100.0%

22/01/2026 19:35:41 >> No. of training batches per epoch = 2117

22/01/2026 19:35:41 >> ============================================================
22/01/2026 19:35:41 >>                Starting training...
22/01/2026 19:35:41 >> ============================================================
22/01/2026 19:35:41 >> >>> Epoch 1/20
22/01/2026 19:36:51 >> Epoch 1 completed | Avg Loss: 0.9425
22/01/2026 19:36:52 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8852 | AUPRC: 0.5289 | MinRP: 0.5277
22/01/2026 19:36:57 >> VAL          Epoch:     1 | AUROC: 0.8743 | AUPRC: 0.5223 | MinRP: 0.5372
22/01/2026 19:36:57 >> AUPRC improved: 0.0000 ---> 0.5223 (+0.5223)
22/01/2026 19:36:57 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:36:57 >> ============================================================
22/01/2026 19:36:57 >> >>> Epoch 2/20
22/01/2026 19:38:07 >> Epoch 2 completed | Avg Loss: 0.8160
22/01/2026 19:38:08 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9035 | AUPRC: 0.5858 | MinRP: 0.5489
22/01/2026 19:38:13 >> VAL          Epoch:     2 | AUROC: 0.8898 | AUPRC: 0.5806 | MinRP: 0.5442
22/01/2026 19:38:13 >> AUPRC improved: 0.5223 ---> 0.5806 (+0.0583)
22/01/2026 19:38:13 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:38:13 >> ============================================================
22/01/2026 19:38:13 >> >>> Epoch 3/20
22/01/2026 19:39:25 >> Epoch 3 completed | Avg Loss: 0.7746
22/01/2026 19:39:26 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9055 | AUPRC: 0.6212 | MinRP: 0.5745
22/01/2026 19:39:31 >> VAL          Epoch:     3 | AUROC: 0.8951 | AUPRC: 0.6188 | MinRP: 0.5665
22/01/2026 19:39:31 >> AUPRC improved: 0.5806 ---> 0.6188 (+0.0383)
22/01/2026 19:39:31 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:39:31 >> ============================================================
22/01/2026 19:39:31 >> >>> Epoch 4/20
22/01/2026 19:40:41 >> Epoch 4 completed | Avg Loss: 0.7580
22/01/2026 19:40:43 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9141 | AUPRC: 0.6339 | MinRP: 0.5830
22/01/2026 19:40:48 >> VAL          Epoch:     4 | AUROC: 0.8961 | AUPRC: 0.6192 | MinRP: 0.5746
22/01/2026 19:40:48 >> AUPRC improved: 0.6188 ---> 0.6192 (+0.0004)
22/01/2026 19:40:48 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:40:48 >> ============================================================
22/01/2026 19:40:48 >> >>> Epoch 5/20
22/01/2026 19:41:58 >> Epoch 5 completed | Avg Loss: 0.7410
22/01/2026 19:41:59 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9114 | AUPRC: 0.6338 | MinRP: 0.5975
22/01/2026 19:42:05 >> VAL          Epoch:     5 | AUROC: 0.8964 | AUPRC: 0.6293 | MinRP: 0.5779
22/01/2026 19:42:05 >> AUPRC improved: 0.6192 ---> 0.6293 (+0.0101)
22/01/2026 19:42:05 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:42:05 >> ============================================================
22/01/2026 19:42:05 >> >>> Epoch 6/20
22/01/2026 19:43:15 >> Epoch 6 completed | Avg Loss: 0.7342
22/01/2026 19:43:16 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9203 | AUPRC: 0.6551 | MinRP: 0.5975
22/01/2026 19:43:21 >> VAL          Epoch:     6 | AUROC: 0.8988 | AUPRC: 0.6358 | MinRP: 0.5795
22/01/2026 19:43:21 >> AUPRC improved: 0.6293 ---> 0.6358 (+0.0065)
22/01/2026 19:43:21 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:43:21 >> ============================================================
22/01/2026 19:43:21 >> >>> Epoch 7/20
22/01/2026 19:44:30 >> Epoch 7 completed | Avg Loss: 0.7203
22/01/2026 19:44:31 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9231 | AUPRC: 0.6605 | MinRP: 0.6000
22/01/2026 19:44:36 >> VAL          Epoch:     7 | AUROC: 0.8981 | AUPRC: 0.6367 | MinRP: 0.5780
22/01/2026 19:44:36 >> AUPRC improved: 0.6358 ---> 0.6367 (+0.0009)
22/01/2026 19:44:36 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:44:36 >> ============================================================
22/01/2026 19:44:36 >> >>> Epoch 8/20
22/01/2026 19:45:46 >> Epoch 8 completed | Avg Loss: 0.7191
22/01/2026 19:45:48 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9186 | AUPRC: 0.6721 | MinRP: 0.6213
22/01/2026 19:45:53 >> VAL          Epoch:     8 | AUROC: 0.8980 | AUPRC: 0.6440 | MinRP: 0.5835
22/01/2026 19:45:53 >> AUPRC improved: 0.6367 ---> 0.6440 (+0.0073)
22/01/2026 19:45:53 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:45:53 >> ============================================================
22/01/2026 19:45:53 >> >>> Epoch 9/20
22/01/2026 19:47:04 >> Epoch 9 completed | Avg Loss: 0.7080
22/01/2026 19:47:05 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9231 | AUPRC: 0.6720 | MinRP: 0.6208
22/01/2026 19:47:10 >> VAL          Epoch:     9 | AUROC: 0.9016 | AUPRC: 0.6469 | MinRP: 0.5875
22/01/2026 19:47:10 >> AUPRC improved: 0.6440 ---> 0.6469 (+0.0030)
22/01/2026 19:47:10 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:47:10 >> ============================================================
22/01/2026 19:47:10 >> >>> Epoch 10/20
22/01/2026 19:48:21 >> Epoch 10 completed | Avg Loss: 0.7073
22/01/2026 19:48:22 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9244 | AUPRC: 0.6743 | MinRP: 0.6017
22/01/2026 19:48:27 >> VAL          Epoch:    10 | AUROC: 0.9019 | AUPRC: 0.6432 | MinRP: 0.5795
22/01/2026 19:48:27 >> No improvement. Wait: 4/5
22/01/2026 19:48:27 >> ============================================================
22/01/2026 19:48:27 >> >>> Epoch 11/20
22/01/2026 19:49:39 >> Epoch 11 completed | Avg Loss: 0.7014
22/01/2026 19:49:40 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9245 | AUPRC: 0.6728 | MinRP: 0.6170
22/01/2026 19:49:45 >> VAL          Epoch:    11 | AUROC: 0.9006 | AUPRC: 0.6415 | MinRP: 0.5755
22/01/2026 19:49:45 >> No improvement. Wait: 3/5
22/01/2026 19:49:45 >> ============================================================
22/01/2026 19:49:45 >> >>> Epoch 12/20
22/01/2026 19:50:57 >> Epoch 12 completed | Avg Loss: 0.7030
22/01/2026 19:50:58 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9274 | AUPRC: 0.6904 | MinRP: 0.6271
22/01/2026 19:51:03 >> VAL          Epoch:    12 | AUROC: 0.9032 | AUPRC: 0.6492 | MinRP: 0.5855
22/01/2026 19:51:03 >> AUPRC improved: 0.6469 ---> 0.6492 (+0.0023)
22/01/2026 19:51:03 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:51:03 >> ============================================================
22/01/2026 19:51:03 >> >>> Epoch 13/20
22/01/2026 19:52:12 >> Epoch 13 completed | Avg Loss: 0.6892
22/01/2026 19:52:13 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9281 | AUPRC: 0.6820 | MinRP: 0.6170
22/01/2026 19:52:18 >> VAL          Epoch:    13 | AUROC: 0.9031 | AUPRC: 0.6455 | MinRP: 0.5835
22/01/2026 19:52:18 >> No improvement. Wait: 4/5
22/01/2026 19:52:18 >> ============================================================
22/01/2026 19:52:18 >> >>> Epoch 14/20
22/01/2026 19:53:29 >> Epoch 14 completed | Avg Loss: 0.6902
22/01/2026 19:53:30 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9304 | AUPRC: 0.6907 | MinRP: 0.6255
22/01/2026 19:53:35 >> VAL          Epoch:    14 | AUROC: 0.9043 | AUPRC: 0.6515 | MinRP: 0.5770
22/01/2026 19:53:35 >> AUPRC improved: 0.6492 ---> 0.6515 (+0.0023)
22/01/2026 19:53:35 >> Saving checkpoint to ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:53:35 >> ============================================================
22/01/2026 19:53:35 >> >>> Epoch 15/20
22/01/2026 19:54:46 >> Epoch 15 completed | Avg Loss: 0.6873
22/01/2026 19:54:47 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9303 | AUPRC: 0.6839 | MinRP: 0.6170
22/01/2026 19:54:52 >> VAL          Epoch:    15 | AUROC: 0.9037 | AUPRC: 0.6467 | MinRP: 0.5825
22/01/2026 19:54:52 >> No improvement. Wait: 4/5
22/01/2026 19:54:52 >> ============================================================
22/01/2026 19:54:52 >> >>> Epoch 16/20
22/01/2026 19:56:02 >> Epoch 16 completed | Avg Loss: 0.6895
22/01/2026 19:56:03 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9294 | AUPRC: 0.6932 | MinRP: 0.6303
22/01/2026 19:56:08 >> VAL          Epoch:    16 | AUROC: 0.9037 | AUPRC: 0.6496 | MinRP: 0.5895
22/01/2026 19:56:08 >> No improvement. Wait: 3/5
22/01/2026 19:56:08 >> ============================================================
22/01/2026 19:56:08 >> >>> Epoch 17/20
22/01/2026 19:57:19 >> Epoch 17 completed | Avg Loss: 0.6793
22/01/2026 19:57:20 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9293 | AUPRC: 0.6907 | MinRP: 0.6255
22/01/2026 19:57:25 >> VAL          Epoch:    17 | AUROC: 0.9034 | AUPRC: 0.6408 | MinRP: 0.5805
22/01/2026 19:57:25 >> No improvement. Wait: 2/5
22/01/2026 19:57:25 >> ============================================================
22/01/2026 19:57:25 >> >>> Epoch 18/20
22/01/2026 19:58:36 >> Epoch 18 completed | Avg Loss: 0.6809
22/01/2026 19:58:37 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9342 | AUPRC: 0.7036 | MinRP: 0.6485
22/01/2026 19:58:42 >> VAL          Epoch:    18 | AUROC: 0.9030 | AUPRC: 0.6466 | MinRP: 0.5875
22/01/2026 19:58:42 >> No improvement. Wait: 1/5
22/01/2026 19:58:42 >> ============================================================
22/01/2026 19:58:42 >> >>> Epoch 19/20
22/01/2026 19:59:52 >> Epoch 19 completed | Avg Loss: 0.6778
22/01/2026 19:59:54 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9338 | AUPRC: 0.6948 | MinRP: 0.6426
22/01/2026 19:59:59 >> VAL          Epoch:    19 | AUROC: 0.9054 | AUPRC: 0.6511 | MinRP: 0.5858
22/01/2026 19:59:59 >> No improvement. Wait: 0/5
22/01/2026 19:59:59 >> Patience reached. Early stopping.

22/01/2026 19:59:59 >> ============================================================
22/01/2026 19:59:59 >> TRAINING COMPLETED
22/01/2026 19:59:59 >> ============================================================
22/01/2026 19:59:59 >> Best Validation Results:
22/01/2026 19:59:59 >>   AUROC: 0.9043 | AUPRC: 0.6515 | MinRP: 0.5770
22/01/2026 19:59:59 >> Loading best model from ../outputs/mimic_iii/istrats|fold:3/checkpoint_best.bin
22/01/2026 19:59:59 >> Evaluating on test set...
22/01/2026 20:00:05 >> TEST         AUROC: 0.9080 | AUPRC: 0.6707 | MinRP: 0.5881 | Accuracy: 0.8218

22/01/2026 20:00:05 >> ============================================================
22/01/2026 20:00:05 >> Classification Report:
22/01/2026 20:00:05 >>               precision    recall  f1-score   support
22/01/2026 20:00:05 >> 
22/01/2026 20:00:05 >>          0.0     0.9711    0.8216    0.8901      9280
22/01/2026 20:00:05 >>          1.0     0.3907    0.8239    0.5301      1289
22/01/2026 20:00:05 >> 
22/01/2026 20:00:05 >>     accuracy                         0.8218     10569
22/01/2026 20:00:05 >>    macro avg     0.6809    0.8227    0.7101     10569
22/01/2026 20:00:05 >> weighted avg     0.9003    0.8218    0.8462     10569
22/01/2026 20:00:05 >> 
22/01/2026 20:00:05 >> Confusion Matrix:
22/01/2026 20:00:05 >> [7624, 1656]
22/01/2026 20:00:05 >> [227, 1062]
22/01/2026 20:00:05 >> ============================================================
22/01/2026 20:00:05 >> Final Test Results:
22/01/2026 20:00:05 >>   AUROC: 0.9080 | AUPRC: 0.6707 | MinRP: 0.5881 | Accuracy: 0.8218
22/01/2026 20:00:05 >> ============================================================
