07/02/2026 22:22:46 >> Namespace(dataset='mimic_iii', model_type='dbvt', split_file='mimic_iii_5fold.json', fold=4, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/mimic_iii/dbvt|fold:4', lr=0.0003, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:0', seed=2026, gru_hid_dim=128, gru_dropout=0.3, transformer_hid_dim=64, transformer_num_layers=4, transformer_num_heads=4, transformer_dropout=0.2, fusion_hid_dim=256, fusion_dropout=0.15, lambda_aux=1.0, lambda_cos=0.7, logger=<utils.logger.Logger object at 0x754fed01e140>)

07/02/2026 22:22:46 >> Preparing dataset mimic_iii
07/02/2026 22:22:52 >> Using fold 4/5
07/02/2026 22:22:52 >> Loaded splits from mimic_iii_5fold.json
07/02/2026 22:23:22 >> # train, val, test TS: [33762, 8436, 10673]
07/02/2026 22:23:46 >> pos class weight: 7.0482
07/02/2026 22:23:46 >> % pos class in train, val, test splits: [0.1243, 0.1193, 0.1223]
07/02/2026 22:23:48 >> # static features: 3
07/02/2026 22:23:48 >> # TS variables (DBVT): 127
07/02/2026 22:23:56 >> # timesteps (DBVT): 25

07/02/2026 22:25:46 >> Model details:
07/02/2026 22:25:46 >> # parameters: 575905
07/02/2026 22:25:46 >> # trainable parameters: 575905, 100.0%
07/02/2026 22:25:46 >> #params by dtype:
07/02/2026 22:25:46 >> torch.float32: 575905, 100.0%

07/02/2026 22:25:46 >> No. of training batches per epoch = 1056

07/02/2026 22:25:46 >> ============================================================
07/02/2026 22:25:46 >>                Starting training...
07/02/2026 22:25:46 >> ============================================================
07/02/2026 22:25:46 >> >>> Epoch 1/20
07/02/2026 22:30:27 >> Epoch 1 completed | Avg Loss: 2.5452
07/02/2026 22:30:34 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9089 | AUPRC: 0.6535 | MinRP: 0.6017
07/02/2026 22:31:00 >> VAL          Epoch:     1 | AUROC: 0.9011 | AUPRC: 0.6336 | MinRP: 0.5819
07/02/2026 22:31:00 >> AUPRC improved: 0.0000 ---> 0.6336 (+0.6336)
07/02/2026 22:31:00 >> Saving checkpoint to ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 22:31:00 >> ============================================================
07/02/2026 22:31:00 >> >>> Epoch 2/20
07/02/2026 22:35:51 >> Epoch 2 completed | Avg Loss: 2.2323
07/02/2026 22:35:57 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9175 | AUPRC: 0.6818 | MinRP: 0.6203
07/02/2026 22:36:23 >> VAL          Epoch:     2 | AUROC: 0.9075 | AUPRC: 0.6546 | MinRP: 0.5954
07/02/2026 22:36:23 >> AUPRC improved: 0.6336 ---> 0.6546 (+0.0210)
07/02/2026 22:36:23 >> Saving checkpoint to ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 22:36:23 >> ============================================================
07/02/2026 22:36:23 >> >>> Epoch 3/20
07/02/2026 22:41:19 >> Epoch 3 completed | Avg Loss: 2.1666
07/02/2026 22:41:25 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9223 | AUPRC: 0.6934 | MinRP: 0.6261
07/02/2026 22:41:52 >> VAL          Epoch:     3 | AUROC: 0.9087 | AUPRC: 0.6586 | MinRP: 0.5956
07/02/2026 22:41:52 >> AUPRC improved: 0.6546 ---> 0.6586 (+0.0040)
07/02/2026 22:41:52 >> Saving checkpoint to ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 22:41:52 >> ============================================================
07/02/2026 22:41:52 >> >>> Epoch 4/20
07/02/2026 22:46:59 >> Epoch 4 completed | Avg Loss: 2.1133
07/02/2026 22:47:06 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9266 | AUPRC: 0.6996 | MinRP: 0.6471
07/02/2026 22:47:33 >> VAL          Epoch:     4 | AUROC: 0.9094 | AUPRC: 0.6645 | MinRP: 0.6048
07/02/2026 22:47:33 >> AUPRC improved: 0.6586 ---> 0.6645 (+0.0059)
07/02/2026 22:47:33 >> Saving checkpoint to ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 22:47:33 >> ============================================================
07/02/2026 22:47:33 >> >>> Epoch 5/20
07/02/2026 22:52:30 >> Epoch 5 completed | Avg Loss: 2.0739
07/02/2026 22:52:37 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9287 | AUPRC: 0.7112 | MinRP: 0.6540
07/02/2026 22:53:04 >> VAL          Epoch:     5 | AUROC: 0.9102 | AUPRC: 0.6672 | MinRP: 0.5958
07/02/2026 22:53:04 >> AUPRC improved: 0.6645 ---> 0.6672 (+0.0027)
07/02/2026 22:53:04 >> Saving checkpoint to ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 22:53:04 >> ============================================================
07/02/2026 22:53:04 >> >>> Epoch 6/20
07/02/2026 22:58:11 >> Epoch 6 completed | Avg Loss: 2.0539
07/02/2026 22:58:18 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9350 | AUPRC: 0.7274 | MinRP: 0.6542
07/02/2026 22:58:45 >> VAL          Epoch:     6 | AUROC: 0.9122 | AUPRC: 0.6671 | MinRP: 0.5924
07/02/2026 22:58:45 >> No improvement. Wait: 4/5
07/02/2026 22:58:45 >> ============================================================
07/02/2026 22:58:45 >> >>> Epoch 7/20
07/02/2026 23:03:52 >> Epoch 7 completed | Avg Loss: 2.0317
07/02/2026 23:03:58 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9355 | AUPRC: 0.7337 | MinRP: 0.6612
07/02/2026 23:04:25 >> VAL          Epoch:     7 | AUROC: 0.9133 | AUPRC: 0.6739 | MinRP: 0.6026
07/02/2026 23:04:25 >> AUPRC improved: 0.6672 ---> 0.6739 (+0.0066)
07/02/2026 23:04:25 >> Saving checkpoint to ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 23:04:25 >> ============================================================
07/02/2026 23:04:25 >> >>> Epoch 8/20
07/02/2026 23:09:23 >> Epoch 8 completed | Avg Loss: 1.9928
07/02/2026 23:09:29 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9408 | AUPRC: 0.7449 | MinRP: 0.6597
07/02/2026 23:09:56 >> VAL          Epoch:     8 | AUROC: 0.9135 | AUPRC: 0.6769 | MinRP: 0.6040
07/02/2026 23:09:56 >> AUPRC improved: 0.6739 ---> 0.6769 (+0.0030)
07/02/2026 23:09:56 >> Saving checkpoint to ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 23:09:56 >> ============================================================
07/02/2026 23:09:56 >> >>> Epoch 9/20
07/02/2026 23:15:03 >> Epoch 9 completed | Avg Loss: 1.9728
07/02/2026 23:15:10 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9382 | AUPRC: 0.7377 | MinRP: 0.6582
07/02/2026 23:15:37 >> VAL          Epoch:     9 | AUROC: 0.9142 | AUPRC: 0.6778 | MinRP: 0.6081
07/02/2026 23:15:37 >> AUPRC improved: 0.6769 ---> 0.6778 (+0.0009)
07/02/2026 23:15:37 >> Saving checkpoint to ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 23:15:37 >> ============================================================
07/02/2026 23:15:37 >> >>> Epoch 10/20
07/02/2026 23:20:44 >> Epoch 10 completed | Avg Loss: 1.9775
07/02/2026 23:20:51 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9414 | AUPRC: 0.7471 | MinRP: 0.6835
07/02/2026 23:21:17 >> VAL          Epoch:    10 | AUROC: 0.9127 | AUPRC: 0.6739 | MinRP: 0.5984
07/02/2026 23:21:17 >> No improvement. Wait: 4/5
07/02/2026 23:21:17 >> ============================================================
07/02/2026 23:21:17 >> >>> Epoch 11/20
07/02/2026 23:25:49 >> Epoch 11 completed | Avg Loss: 1.9352
07/02/2026 23:25:53 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9432 | AUPRC: 0.7483 | MinRP: 0.6722
07/02/2026 23:26:15 >> VAL          Epoch:    11 | AUROC: 0.9132 | AUPRC: 0.6780 | MinRP: 0.6024
07/02/2026 23:26:15 >> AUPRC improved: 0.6778 ---> 0.6780 (+0.0001)
07/02/2026 23:26:15 >> Saving checkpoint to ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 23:26:15 >> ============================================================
07/02/2026 23:26:15 >> >>> Epoch 12/20
07/02/2026 23:31:15 >> Epoch 12 completed | Avg Loss: 1.9248
07/02/2026 23:31:21 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9454 | AUPRC: 0.7593 | MinRP: 0.6765
07/02/2026 23:31:47 >> VAL          Epoch:    12 | AUROC: 0.9152 | AUPRC: 0.6822 | MinRP: 0.6064
07/02/2026 23:31:47 >> AUPRC improved: 0.6780 ---> 0.6822 (+0.0043)
07/02/2026 23:31:47 >> Saving checkpoint to ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 23:31:47 >> ============================================================
07/02/2026 23:31:47 >> >>> Epoch 13/20
07/02/2026 23:36:35 >> Epoch 13 completed | Avg Loss: 1.9091
07/02/2026 23:36:42 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9485 | AUPRC: 0.7711 | MinRP: 0.6891
07/02/2026 23:37:08 >> VAL          Epoch:    13 | AUROC: 0.9100 | AUPRC: 0.6743 | MinRP: 0.5889
07/02/2026 23:37:08 >> No improvement. Wait: 4/5
07/02/2026 23:37:08 >> ============================================================
07/02/2026 23:37:08 >> >>> Epoch 14/20
07/02/2026 23:42:07 >> Epoch 14 completed | Avg Loss: 1.8908
07/02/2026 23:42:13 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9480 | AUPRC: 0.7619 | MinRP: 0.6835
07/02/2026 23:42:40 >> VAL          Epoch:    14 | AUROC: 0.9134 | AUPRC: 0.6769 | MinRP: 0.5992
07/02/2026 23:42:40 >> No improvement. Wait: 3/5
07/02/2026 23:42:40 >> ============================================================
07/02/2026 23:42:40 >> >>> Epoch 15/20
07/02/2026 23:47:39 >> Epoch 15 completed | Avg Loss: 1.8650
07/02/2026 23:47:45 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9519 | AUPRC: 0.7820 | MinRP: 0.6962
07/02/2026 23:48:12 >> VAL          Epoch:    15 | AUROC: 0.9138 | AUPRC: 0.6802 | MinRP: 0.6093
07/02/2026 23:48:12 >> No improvement. Wait: 2/5
07/02/2026 23:48:12 >> ============================================================
07/02/2026 23:48:12 >> >>> Epoch 16/20
07/02/2026 23:53:01 >> Epoch 16 completed | Avg Loss: 1.8637
07/02/2026 23:53:07 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9579 | AUPRC: 0.7962 | MinRP: 0.7046
07/02/2026 23:53:33 >> VAL          Epoch:    16 | AUROC: 0.9114 | AUPRC: 0.6780 | MinRP: 0.6024
07/02/2026 23:53:33 >> No improvement. Wait: 1/5
07/02/2026 23:53:33 >> ============================================================
07/02/2026 23:53:33 >> >>> Epoch 17/20
07/02/2026 23:58:21 >> Epoch 17 completed | Avg Loss: 1.8471
07/02/2026 23:58:28 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9559 | AUPRC: 0.7920 | MinRP: 0.7131
07/02/2026 23:58:54 >> VAL          Epoch:    17 | AUROC: 0.9121 | AUPRC: 0.6769 | MinRP: 0.6064
07/02/2026 23:58:54 >> No improvement. Wait: 0/5
07/02/2026 23:58:54 >> Patience reached. Early stopping.

07/02/2026 23:58:54 >> ============================================================
07/02/2026 23:58:54 >> TRAINING COMPLETED
07/02/2026 23:58:54 >> ============================================================
07/02/2026 23:58:54 >> Best Validation Results:
07/02/2026 23:58:54 >>   AUROC: 0.9152 | AUPRC: 0.6822 | MinRP: 0.6064
07/02/2026 23:58:54 >> Loading best model from ../outputs/mimic_iii/dbvt|fold:4/checkpoint_best.bin
07/02/2026 23:58:54 >> Evaluating on test set...
07/02/2026 23:59:27 >> TEST         AUROC: 0.9194 | AUPRC: 0.7024 | MinRP: 0.6199 | Accuracy: 0.8373

07/02/2026 23:59:27 >> ============================================================
07/02/2026 23:59:27 >> Classification Report:
07/02/2026 23:59:27 >>               precision    recall  f1-score   support
07/02/2026 23:59:27 >> 
07/02/2026 23:59:27 >>          0.0     0.9726    0.8383    0.9005      9368
07/02/2026 23:59:27 >>          1.0     0.4171    0.8307    0.5553      1305
07/02/2026 23:59:27 >> 
07/02/2026 23:59:27 >>     accuracy                         0.8373     10673
07/02/2026 23:59:27 >>    macro avg     0.6949    0.8345    0.7279     10673
07/02/2026 23:59:27 >> weighted avg     0.9047    0.8373    0.8583     10673
07/02/2026 23:59:27 >> 
07/02/2026 23:59:27 >> Confusion Matrix:
07/02/2026 23:59:27 >> [7853, 1515]
07/02/2026 23:59:27 >> [221, 1084]
07/02/2026 23:59:27 >> ============================================================
07/02/2026 23:59:27 >> Final Test Results:
07/02/2026 23:59:27 >>   AUROC: 0.9194 | AUPRC: 0.7024 | MinRP: 0.6199 | Accuracy: 0.8373
07/02/2026 23:59:27 >> ============================================================
