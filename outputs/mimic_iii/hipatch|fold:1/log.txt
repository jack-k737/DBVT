22/01/2026 21:00:46 >> Namespace(dataset='mimic_iii', model_type='hipatch', split_file='mimic_iii_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/mimic_iii/hipatch|fold:1', lr=0.0005, train_batch_size=64, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:2', seed=2026, hid_dim=32, num_heads=2, num_layers=2, patch_size=6, alpha=0.8, res=1, logger=<utils.logger.Logger object at 0x70912bf06140>)

22/01/2026 21:00:46 >> Preparing dataset mimic_iii
22/01/2026 21:00:51 >> Using fold 1/5
22/01/2026 21:00:51 >> Loaded splits from mimic_iii_5fold.json
22/01/2026 21:01:33 >> # train, val, test TS: [33817, 8471, 10583]
22/01/2026 21:02:09 >> pos class weight: 7.1487
22/01/2026 21:02:09 >> % pos class in train, val, test splits: [0.1227, 0.1277, 0.1204]
22/01/2026 21:02:12 >> # static features: 3
22/01/2026 21:02:13 >> # TS variables: 127
22/01/2026 21:02:14 >> # patches: 4 | patch_layer: 3 | patch_size: 6h | stride: 6h
22/01/2026 21:02:19 >> # max obs per patch: 20

22/01/2026 21:02:59 >> Model details:
22/01/2026 21:02:59 >> # parameters: 118438
22/01/2026 21:02:59 >> # trainable parameters: 118438, 100.0%
22/01/2026 21:02:59 >> #params by dtype:
22/01/2026 21:02:59 >> torch.float32: 118438, 100.0%

22/01/2026 21:02:59 >> No. of training batches per epoch = 529

22/01/2026 21:02:59 >> ============================================================
22/01/2026 21:02:59 >>                Starting training...
22/01/2026 21:02:59 >> ============================================================
22/01/2026 21:02:59 >> >>> Epoch 1/20
22/01/2026 21:09:03 >> Epoch 1 completed | Avg Loss: 0.4184
22/01/2026 21:09:14 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9239 | AUPRC: 0.7238 | MinRP: 0.6568
22/01/2026 21:09:57 >> VAL          Epoch:     1 | AUROC: 0.9010 | AUPRC: 0.6573 | MinRP: 0.5928
22/01/2026 21:09:57 >> AUPRC improved: 0.0000 ---> 0.6573 (+0.6573)
22/01/2026 21:09:57 >> Saving checkpoint to ../outputs/mimic_iii/hipatch|fold:1/checkpoint_best.bin
22/01/2026 21:09:57 >> ============================================================
22/01/2026 21:09:57 >> >>> Epoch 2/20
22/01/2026 21:16:07 >> Epoch 2 completed | Avg Loss: 0.3684
22/01/2026 21:16:18 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9364 | AUPRC: 0.7492 | MinRP: 0.6835
22/01/2026 21:17:01 >> VAL          Epoch:     2 | AUROC: 0.9045 | AUPRC: 0.6671 | MinRP: 0.5970
22/01/2026 21:17:01 >> AUPRC improved: 0.6573 ---> 0.6671 (+0.0098)
22/01/2026 21:17:01 >> Saving checkpoint to ../outputs/mimic_iii/hipatch|fold:1/checkpoint_best.bin
22/01/2026 21:17:01 >> ============================================================
22/01/2026 21:17:01 >> >>> Epoch 3/20
22/01/2026 21:23:11 >> Epoch 3 completed | Avg Loss: 0.3461
22/01/2026 21:23:22 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9402 | AUPRC: 0.7580 | MinRP: 0.6907
22/01/2026 21:24:06 >> VAL          Epoch:     3 | AUROC: 0.9044 | AUPRC: 0.6664 | MinRP: 0.6011
22/01/2026 21:24:06 >> No improvement. Wait: 4/5
22/01/2026 21:24:06 >> ============================================================
22/01/2026 21:24:06 >> >>> Epoch 4/20
22/01/2026 21:30:17 >> Epoch 4 completed | Avg Loss: 0.3239
22/01/2026 21:30:28 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9563 | AUPRC: 0.8029 | MinRP: 0.7029
22/01/2026 21:31:11 >> VAL          Epoch:     4 | AUROC: 0.8988 | AUPRC: 0.6656 | MinRP: 0.5827
22/01/2026 21:31:11 >> No improvement. Wait: 3/5
22/01/2026 21:31:11 >> ============================================================
22/01/2026 21:31:11 >> >>> Epoch 5/20
22/01/2026 21:36:02 >> Epoch 5 completed | Avg Loss: 0.2989
22/01/2026 21:36:07 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9662 | AUPRC: 0.8232 | MinRP: 0.7553
22/01/2026 21:36:27 >> VAL          Epoch:     5 | AUROC: 0.9011 | AUPRC: 0.6698 | MinRP: 0.5950
22/01/2026 21:36:27 >> AUPRC improved: 0.6671 ---> 0.6698 (+0.0028)
22/01/2026 21:36:27 >> Saving checkpoint to ../outputs/mimic_iii/hipatch|fold:1/checkpoint_best.bin
22/01/2026 21:36:27 >> ============================================================
22/01/2026 21:36:27 >> >>> Epoch 6/20
22/01/2026 21:39:31 >> Epoch 6 completed | Avg Loss: 0.2724
22/01/2026 21:39:36 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9729 | AUPRC: 0.8518 | MinRP: 0.7605
22/01/2026 21:39:56 >> VAL          Epoch:     6 | AUROC: 0.8950 | AUPRC: 0.6603 | MinRP: 0.5897
22/01/2026 21:39:56 >> No improvement. Wait: 4/5
22/01/2026 21:39:56 >> ============================================================
22/01/2026 21:39:56 >> >>> Epoch 7/20
22/01/2026 21:43:00 >> Epoch 7 completed | Avg Loss: 0.2452
22/01/2026 21:43:05 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9796 | AUPRC: 0.8848 | MinRP: 0.8075
22/01/2026 21:43:25 >> VAL          Epoch:     7 | AUROC: 0.8911 | AUPRC: 0.6472 | MinRP: 0.5813
22/01/2026 21:43:25 >> No improvement. Wait: 3/5
22/01/2026 21:43:25 >> ============================================================
22/01/2026 21:43:25 >> >>> Epoch 8/20
22/01/2026 21:46:29 >> Epoch 8 completed | Avg Loss: 0.2198
22/01/2026 21:46:34 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9850 | AUPRC: 0.8907 | MinRP: 0.8220
22/01/2026 21:46:54 >> VAL          Epoch:     8 | AUROC: 0.8827 | AUPRC: 0.6261 | MinRP: 0.5601
22/01/2026 21:46:54 >> No improvement. Wait: 2/5
22/01/2026 21:46:54 >> ============================================================
22/01/2026 21:46:54 >> >>> Epoch 9/20
22/01/2026 21:49:58 >> Epoch 9 completed | Avg Loss: 0.1926
22/01/2026 21:50:03 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9893 | AUPRC: 0.9280 | MinRP: 0.8397
22/01/2026 21:50:24 >> VAL          Epoch:     9 | AUROC: 0.8793 | AUPRC: 0.6332 | MinRP: 0.5669
22/01/2026 21:50:24 >> No improvement. Wait: 1/5
22/01/2026 21:50:24 >> ============================================================
22/01/2026 21:50:24 >> >>> Epoch 10/20
22/01/2026 21:53:29 >> Epoch 10 completed | Avg Loss: 0.1726
22/01/2026 21:53:34 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9917 | AUPRC: 0.9387 | MinRP: 0.8856
22/01/2026 21:53:54 >> VAL          Epoch:    10 | AUROC: 0.8660 | AUPRC: 0.6011 | MinRP: 0.5370
22/01/2026 21:53:54 >> No improvement. Wait: 0/5
22/01/2026 21:53:54 >> Patience reached. Early stopping.

22/01/2026 21:53:54 >> ============================================================
22/01/2026 21:53:54 >> TRAINING COMPLETED
22/01/2026 21:53:54 >> ============================================================
22/01/2026 21:53:54 >> Best Validation Results:
22/01/2026 21:53:54 >>   AUROC: 0.9011 | AUPRC: 0.6698 | MinRP: 0.5950
22/01/2026 21:53:54 >> Loading best model from ../outputs/mimic_iii/hipatch|fold:1/checkpoint_best.bin
22/01/2026 21:53:54 >> Evaluating on test set...
22/01/2026 21:54:19 >> TEST         AUROC: 0.9028 | AUPRC: 0.6523 | MinRP: 0.5931 | Accuracy: 0.8196

22/01/2026 21:54:19 >> ============================================================
22/01/2026 21:54:19 >> Classification Report:
22/01/2026 21:54:19 >>               precision    recall  f1-score   support
22/01/2026 21:54:19 >> 
22/01/2026 21:54:19 >>          0.0     0.9703    0.8201    0.8889      9309
22/01/2026 21:54:19 >>          1.0     0.3831    0.8163    0.5214      1274
22/01/2026 21:54:19 >> 
22/01/2026 21:54:19 >>     accuracy                         0.8196     10583
22/01/2026 21:54:19 >>    macro avg     0.6767    0.8182    0.7051     10583
22/01/2026 21:54:19 >> weighted avg     0.8996    0.8196    0.8446     10583
22/01/2026 21:54:19 >> 
22/01/2026 21:54:19 >> Confusion Matrix:
22/01/2026 21:54:19 >> [7634, 1675]
22/01/2026 21:54:19 >> [234, 1040]
22/01/2026 21:54:19 >> ============================================================
22/01/2026 21:54:19 >> Final Test Results:
22/01/2026 21:54:19 >>   AUROC: 0.9028 | AUPRC: 0.6523 | MinRP: 0.5931 | Accuracy: 0.8196
22/01/2026 21:54:19 >> ============================================================
