24/01/2026 22:13:50 >> Namespace(dataset='mimic_iii', model_type='grud', split_file='mimic_iii_5fold.json', fold=5, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/mimic_iii/grud|fold:5', lr=0.0005, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=3.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=64, dropout=0.2, logger=<utils.logger.Logger object at 0x78664bf06140>)

24/01/2026 22:13:50 >> Preparing dataset mimic_iii
24/01/2026 22:13:54 >> Using fold 5/5
24/01/2026 22:13:54 >> Loaded splits from mimic_iii_5fold.json
24/01/2026 22:14:22 >> # train, val, test TS: [33910, 8435, 10526]
24/01/2026 22:14:46 >> pos class weight: 7.0451
24/01/2026 22:14:46 >> % pos class in train, val, test splits: [0.1243, 0.1191, 0.1222]
24/01/2026 22:14:47 >> # static features: 3
24/01/2026 22:14:48 >> [GRU-D] # TS variables: 127
24/01/2026 22:14:56 >> [GRU-D] # timesteps (hourly): 25

24/01/2026 22:16:02 >> Model details:
24/01/2026 22:16:02 >> # parameters: 78591
24/01/2026 22:16:02 >> # trainable parameters: 78591, 100.0%
24/01/2026 22:16:02 >> #params by dtype:
24/01/2026 22:16:02 >> torch.float32: 78591, 100.0%

24/01/2026 22:16:02 >> No. of training batches per epoch = 1060

24/01/2026 22:16:02 >> ============================================================
24/01/2026 22:16:02 >>                Starting training...
24/01/2026 22:16:02 >> ============================================================
24/01/2026 22:16:02 >> >>> Epoch 1/20
24/01/2026 22:16:41 >> Epoch 1 completed | Avg Loss: 0.8015
24/01/2026 22:16:42 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.9215 | AUPRC: 0.6870 | MinRP: 0.6356
24/01/2026 22:16:45 >> VAL          Epoch:     1 | AUROC: 0.8968 | AUPRC: 0.6068 | MinRP: 0.5731
24/01/2026 22:16:45 >> AUPRC improved: 0.0000 ---> 0.6068 (+0.6068)
24/01/2026 22:16:45 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:5/checkpoint_best.bin
24/01/2026 22:16:45 >> ============================================================
24/01/2026 22:16:45 >> >>> Epoch 2/20
24/01/2026 22:17:24 >> Epoch 2 completed | Avg Loss: 0.7163
24/01/2026 22:17:25 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.9293 | AUPRC: 0.7000 | MinRP: 0.6483
24/01/2026 22:17:27 >> VAL          Epoch:     2 | AUROC: 0.9013 | AUPRC: 0.6234 | MinRP: 0.5851
24/01/2026 22:17:27 >> AUPRC improved: 0.6068 ---> 0.6234 (+0.0166)
24/01/2026 22:17:27 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:5/checkpoint_best.bin
24/01/2026 22:17:27 >> ============================================================
24/01/2026 22:17:27 >> >>> Epoch 3/20
24/01/2026 22:18:05 >> Epoch 3 completed | Avg Loss: 0.6934
24/01/2026 22:18:06 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9334 | AUPRC: 0.7105 | MinRP: 0.6553
24/01/2026 22:18:08 >> VAL          Epoch:     3 | AUROC: 0.9033 | AUPRC: 0.6364 | MinRP: 0.5828
24/01/2026 22:18:08 >> AUPRC improved: 0.6234 ---> 0.6364 (+0.0130)
24/01/2026 22:18:08 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:5/checkpoint_best.bin
24/01/2026 22:18:08 >> ============================================================
24/01/2026 22:18:08 >> >>> Epoch 4/20
24/01/2026 22:18:45 >> Epoch 4 completed | Avg Loss: 0.6685
24/01/2026 22:18:46 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.9378 | AUPRC: 0.7231 | MinRP: 0.6851
24/01/2026 22:18:48 >> VAL          Epoch:     4 | AUROC: 0.9032 | AUPRC: 0.6361 | MinRP: 0.5891
24/01/2026 22:18:48 >> No improvement. Wait: 4/5
24/01/2026 22:18:48 >> ============================================================
24/01/2026 22:18:48 >> >>> Epoch 5/20
24/01/2026 22:19:25 >> Epoch 5 completed | Avg Loss: 0.6601
24/01/2026 22:19:25 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9415 | AUPRC: 0.7366 | MinRP: 0.6936
24/01/2026 22:19:27 >> VAL          Epoch:     5 | AUROC: 0.9051 | AUPRC: 0.6474 | MinRP: 0.5891
24/01/2026 22:19:27 >> AUPRC improved: 0.6364 ---> 0.6474 (+0.0109)
24/01/2026 22:19:27 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:5/checkpoint_best.bin
24/01/2026 22:19:27 >> ============================================================
24/01/2026 22:19:27 >> >>> Epoch 6/20
24/01/2026 22:20:05 >> Epoch 6 completed | Avg Loss: 0.6429
24/01/2026 22:20:05 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9438 | AUPRC: 0.7378 | MinRP: 0.6851
24/01/2026 22:20:07 >> VAL          Epoch:     6 | AUROC: 0.9051 | AUPRC: 0.6463 | MinRP: 0.5851
24/01/2026 22:20:07 >> No improvement. Wait: 4/5
24/01/2026 22:20:07 >> ============================================================
24/01/2026 22:20:07 >> >>> Epoch 7/20
24/01/2026 22:20:45 >> Epoch 7 completed | Avg Loss: 0.6366
24/01/2026 22:20:46 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9480 | AUPRC: 0.7501 | MinRP: 0.7106
24/01/2026 22:20:48 >> VAL          Epoch:     7 | AUROC: 0.9069 | AUPRC: 0.6531 | MinRP: 0.5855
24/01/2026 22:20:48 >> AUPRC improved: 0.6474 ---> 0.6531 (+0.0057)
24/01/2026 22:20:48 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:5/checkpoint_best.bin
24/01/2026 22:20:48 >> ============================================================
24/01/2026 22:20:48 >> >>> Epoch 8/20
24/01/2026 22:21:25 >> Epoch 8 completed | Avg Loss: 0.6173
24/01/2026 22:21:25 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9499 | AUPRC: 0.7555 | MinRP: 0.6979
24/01/2026 22:21:27 >> VAL          Epoch:     8 | AUROC: 0.9049 | AUPRC: 0.6481 | MinRP: 0.5821
24/01/2026 22:21:27 >> No improvement. Wait: 4/5
24/01/2026 22:21:27 >> ============================================================
24/01/2026 22:21:27 >> >>> Epoch 9/20
24/01/2026 22:22:03 >> Epoch 9 completed | Avg Loss: 0.6087
24/01/2026 22:22:03 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9500 | AUPRC: 0.7632 | MinRP: 0.7034
24/01/2026 22:22:05 >> VAL          Epoch:     9 | AUROC: 0.9059 | AUPRC: 0.6539 | MinRP: 0.5875
24/01/2026 22:22:05 >> AUPRC improved: 0.6531 ---> 0.6539 (+0.0008)
24/01/2026 22:22:05 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:5/checkpoint_best.bin
24/01/2026 22:22:05 >> ============================================================
24/01/2026 22:22:05 >> >>> Epoch 10/20
24/01/2026 22:22:41 >> Epoch 10 completed | Avg Loss: 0.5982
24/01/2026 22:22:42 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9557 | AUPRC: 0.7766 | MinRP: 0.7203
24/01/2026 22:22:44 >> VAL          Epoch:    10 | AUROC: 0.9063 | AUPRC: 0.6546 | MinRP: 0.5789
24/01/2026 22:22:44 >> AUPRC improved: 0.6539 ---> 0.6546 (+0.0008)
24/01/2026 22:22:44 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:5/checkpoint_best.bin
24/01/2026 22:22:44 >> ============================================================
24/01/2026 22:22:44 >> >>> Epoch 11/20
24/01/2026 22:23:21 >> Epoch 11 completed | Avg Loss: 0.5884
24/01/2026 22:23:21 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9578 | AUPRC: 0.7814 | MinRP: 0.7191
24/01/2026 22:23:23 >> VAL          Epoch:    11 | AUROC: 0.9065 | AUPRC: 0.6566 | MinRP: 0.5851
24/01/2026 22:23:23 >> AUPRC improved: 0.6546 ---> 0.6566 (+0.0020)
24/01/2026 22:23:23 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:5/checkpoint_best.bin
24/01/2026 22:23:23 >> ============================================================
24/01/2026 22:23:23 >> >>> Epoch 12/20
24/01/2026 22:24:00 >> Epoch 12 completed | Avg Loss: 0.5685
24/01/2026 22:24:01 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9598 | AUPRC: 0.7890 | MinRP: 0.7277
24/01/2026 22:24:03 >> VAL          Epoch:    12 | AUROC: 0.9059 | AUPRC: 0.6544 | MinRP: 0.5811
24/01/2026 22:24:03 >> No improvement. Wait: 4/5
24/01/2026 22:24:03 >> ============================================================
24/01/2026 22:24:03 >> >>> Epoch 13/20
24/01/2026 22:24:40 >> Epoch 13 completed | Avg Loss: 0.5712
24/01/2026 22:24:40 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9616 | AUPRC: 0.7990 | MinRP: 0.7277
24/01/2026 22:24:42 >> VAL          Epoch:    13 | AUROC: 0.9064 | AUPRC: 0.6577 | MinRP: 0.5905
24/01/2026 22:24:42 >> AUPRC improved: 0.6566 ---> 0.6577 (+0.0011)
24/01/2026 22:24:42 >> Saving checkpoint to ../outputs/mimic_iii/grud|fold:5/checkpoint_best.bin
24/01/2026 22:24:42 >> ============================================================
24/01/2026 22:24:42 >> >>> Epoch 14/20
24/01/2026 22:25:19 >> Epoch 14 completed | Avg Loss: 0.5592
24/01/2026 22:25:19 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9630 | AUPRC: 0.7988 | MinRP: 0.7448
24/01/2026 22:25:21 >> VAL          Epoch:    14 | AUROC: 0.9029 | AUPRC: 0.6517 | MinRP: 0.5785
24/01/2026 22:25:21 >> No improvement. Wait: 4/5
24/01/2026 22:25:21 >> ============================================================
24/01/2026 22:25:21 >> >>> Epoch 15/20
24/01/2026 22:25:58 >> Epoch 15 completed | Avg Loss: 0.5548
24/01/2026 22:25:59 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9668 | AUPRC: 0.8116 | MinRP: 0.7617
24/01/2026 22:26:00 >> VAL          Epoch:    15 | AUROC: 0.9039 | AUPRC: 0.6560 | MinRP: 0.5881
24/01/2026 22:26:00 >> No improvement. Wait: 3/5
24/01/2026 22:26:00 >> ============================================================
24/01/2026 22:26:00 >> >>> Epoch 16/20
24/01/2026 22:26:33 >> Epoch 16 completed | Avg Loss: 0.5349
24/01/2026 22:26:34 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9671 | AUPRC: 0.8147 | MinRP: 0.7511
24/01/2026 22:26:36 >> VAL          Epoch:    16 | AUROC: 0.9037 | AUPRC: 0.6517 | MinRP: 0.5750
24/01/2026 22:26:36 >> No improvement. Wait: 2/5
24/01/2026 22:26:36 >> ============================================================
24/01/2026 22:26:36 >> >>> Epoch 17/20
24/01/2026 22:27:09 >> Epoch 17 completed | Avg Loss: 0.5267
24/01/2026 22:27:09 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9706 | AUPRC: 0.8248 | MinRP: 0.7745
24/01/2026 22:27:11 >> VAL          Epoch:    17 | AUROC: 0.9015 | AUPRC: 0.6491 | MinRP: 0.5845
24/01/2026 22:27:11 >> No improvement. Wait: 1/5
24/01/2026 22:27:11 >> ============================================================
24/01/2026 22:27:11 >> >>> Epoch 18/20
24/01/2026 22:27:41 >> Epoch 18 completed | Avg Loss: 0.5206
24/01/2026 22:27:41 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9727 | AUPRC: 0.8323 | MinRP: 0.7830
24/01/2026 22:27:42 >> VAL          Epoch:    18 | AUROC: 0.9010 | AUPRC: 0.6519 | MinRP: 0.5811
24/01/2026 22:27:42 >> No improvement. Wait: 0/5
24/01/2026 22:27:42 >> Patience reached. Early stopping.

24/01/2026 22:27:42 >> ============================================================
24/01/2026 22:27:42 >> TRAINING COMPLETED
24/01/2026 22:27:42 >> ============================================================
24/01/2026 22:27:42 >> Best Validation Results:
24/01/2026 22:27:42 >>   AUROC: 0.9064 | AUPRC: 0.6577 | MinRP: 0.5905
24/01/2026 22:27:42 >> Loading best model from ../outputs/mimic_iii/grud|fold:5/checkpoint_best.bin
24/01/2026 22:27:42 >> Evaluating on test set...
24/01/2026 22:27:44 >> TEST         AUROC: 0.9126 | AUPRC: 0.6728 | MinRP: 0.6115 | Accuracy: 0.8367

24/01/2026 22:27:44 >> ============================================================
24/01/2026 22:27:44 >> Classification Report:
24/01/2026 22:27:44 >>               precision    recall  f1-score   support
24/01/2026 22:27:44 >> 
24/01/2026 22:27:44 >>          0.0     0.9704    0.8396    0.9003      9240
24/01/2026 22:27:44 >>          1.0     0.4145    0.8157    0.5496      1286
24/01/2026 22:27:44 >> 
24/01/2026 22:27:44 >>     accuracy                         0.8367     10526
24/01/2026 22:27:44 >>    macro avg     0.6924    0.8277    0.7250     10526
24/01/2026 22:27:44 >> weighted avg     0.9024    0.8367    0.8574     10526
24/01/2026 22:27:44 >> 
24/01/2026 22:27:44 >> Confusion Matrix:
24/01/2026 22:27:44 >> [7758, 1482]
24/01/2026 22:27:44 >> [237, 1049]
24/01/2026 22:27:44 >> ============================================================
24/01/2026 22:27:44 >> Final Test Results:
24/01/2026 22:27:44 >>   AUROC: 0.9126 | AUPRC: 0.6728 | MinRP: 0.6115 | Accuracy: 0.8367
24/01/2026 22:27:44 >> ============================================================
