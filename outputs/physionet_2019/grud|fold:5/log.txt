24/01/2026 21:56:20 >> Namespace(dataset='physionet_2019', model_type='grud', split_file='physionet_2019_5fold.json', fold=5, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2019/grud|fold:5', lr=0.0005, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=128, dropout=0.2, logger=<utils.logger.Logger object at 0x74aa3521e140>)

24/01/2026 21:56:20 >> Preparing dataset physionet_2019
24/01/2026 21:56:21 >> Using fold 5/5
24/01/2026 21:56:21 >> Loaded splits from physionet_2019_5fold.json
24/01/2026 21:56:22 >> # train, val, test TS: [24688, 6172, 7715]
24/01/2026 21:56:23 >> pos class weight: 26.7705
24/01/2026 21:56:23 >> % pos class in train, val, test splits: [0.0360, 0.0399, 0.0399]
24/01/2026 21:56:23 >> # static features: 5
24/01/2026 21:56:24 >> [GRU-D] # TS variables: 34
24/01/2026 21:56:27 >> [GRU-D] # timesteps (hourly): 61

24/01/2026 21:56:57 >> Model details:
24/01/2026 21:56:57 >> # parameters: 114885
24/01/2026 21:56:57 >> # trainable parameters: 114885, 100.0%
24/01/2026 21:56:57 >> #params by dtype:
24/01/2026 21:56:57 >> torch.float32: 114885, 100.0%

24/01/2026 21:56:57 >> No. of training batches per epoch = 772

24/01/2026 21:56:57 >> ============================================================
24/01/2026 21:56:57 >>                Starting training...
24/01/2026 21:56:57 >> ============================================================
24/01/2026 21:56:57 >> >>> Epoch 1/20
24/01/2026 21:57:46 >> Epoch 1 completed | Avg Loss: 1.4574
24/01/2026 21:57:48 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8760 | AUPRC: 0.3502 | MinRP: 0.4568
24/01/2026 21:57:50 >> VAL          Epoch:     1 | AUROC: 0.8580 | AUPRC: 0.3722 | MinRP: 0.4187
24/01/2026 21:57:50 >> AUPRC improved: 0.0000 ---> 0.3722 (+0.3722)
24/01/2026 21:57:50 >> Saving checkpoint to ../outputs/physionet_2019/grud|fold:5/checkpoint_best.bin
24/01/2026 21:57:50 >> ============================================================
24/01/2026 21:57:50 >> >>> Epoch 2/20
24/01/2026 21:58:38 >> Epoch 2 completed | Avg Loss: 1.5373
24/01/2026 21:58:39 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8907 | AUPRC: 0.3984 | MinRP: 0.3671
24/01/2026 21:58:40 >> VAL          Epoch:     2 | AUROC: 0.8732 | AUPRC: 0.4621 | MinRP: 0.4839
24/01/2026 21:58:40 >> AUPRC improved: 0.3722 ---> 0.4621 (+0.0899)
24/01/2026 21:58:40 >> Saving checkpoint to ../outputs/physionet_2019/grud|fold:5/checkpoint_best.bin
24/01/2026 21:58:40 >> ============================================================
24/01/2026 21:58:40 >> >>> Epoch 3/20
24/01/2026 21:59:29 >> Epoch 3 completed | Avg Loss: 1.3521
24/01/2026 21:59:29 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8910 | AUPRC: 0.4653 | MinRP: 0.4568
24/01/2026 21:59:31 >> VAL          Epoch:     3 | AUROC: 0.8731 | AUPRC: 0.4920 | MinRP: 0.5020
24/01/2026 21:59:31 >> AUPRC improved: 0.4621 ---> 0.4920 (+0.0299)
24/01/2026 21:59:31 >> Saving checkpoint to ../outputs/physionet_2019/grud|fold:5/checkpoint_best.bin
24/01/2026 21:59:31 >> ============================================================
24/01/2026 21:59:31 >> >>> Epoch 4/20
24/01/2026 22:00:20 >> Epoch 4 completed | Avg Loss: 1.3989
24/01/2026 22:00:21 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8975 | AUPRC: 0.4453 | MinRP: 0.4231
24/01/2026 22:00:22 >> VAL          Epoch:     4 | AUROC: 0.8836 | AUPRC: 0.4860 | MinRP: 0.4919
24/01/2026 22:00:22 >> No improvement. Wait: 4/5
24/01/2026 22:00:22 >> ============================================================
24/01/2026 22:00:22 >> >>> Epoch 5/20
24/01/2026 22:01:11 >> Epoch 5 completed | Avg Loss: 1.4112
24/01/2026 22:01:11 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8954 | AUPRC: 0.4728 | MinRP: 0.4405
24/01/2026 22:01:13 >> VAL          Epoch:     5 | AUROC: 0.8786 | AUPRC: 0.4944 | MinRP: 0.4900
24/01/2026 22:01:13 >> AUPRC improved: 0.4920 ---> 0.4944 (+0.0025)
24/01/2026 22:01:13 >> Saving checkpoint to ../outputs/physionet_2019/grud|fold:5/checkpoint_best.bin
24/01/2026 22:01:13 >> ============================================================
24/01/2026 22:01:13 >> >>> Epoch 6/20
24/01/2026 22:02:01 >> Epoch 6 completed | Avg Loss: 1.4547
24/01/2026 22:02:02 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9051 | AUPRC: 0.5095 | MinRP: 0.4937
24/01/2026 22:02:04 >> VAL          Epoch:     6 | AUROC: 0.8850 | AUPRC: 0.5112 | MinRP: 0.5041
24/01/2026 22:02:04 >> AUPRC improved: 0.4944 ---> 0.5112 (+0.0168)
24/01/2026 22:02:04 >> Saving checkpoint to ../outputs/physionet_2019/grud|fold:5/checkpoint_best.bin
24/01/2026 22:02:04 >> ============================================================
24/01/2026 22:02:04 >> >>> Epoch 7/20
24/01/2026 22:02:52 >> Epoch 7 completed | Avg Loss: 1.5395
24/01/2026 22:02:53 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9120 | AUPRC: 0.5387 | MinRP: 0.5000
24/01/2026 22:02:54 >> VAL          Epoch:     7 | AUROC: 0.8888 | AUPRC: 0.5193 | MinRP: 0.5122
24/01/2026 22:02:54 >> AUPRC improved: 0.5112 ---> 0.5193 (+0.0081)
24/01/2026 22:02:54 >> Saving checkpoint to ../outputs/physionet_2019/grud|fold:5/checkpoint_best.bin
24/01/2026 22:02:54 >> ============================================================
24/01/2026 22:02:54 >> >>> Epoch 8/20
24/01/2026 22:03:42 >> Epoch 8 completed | Avg Loss: 1.4130
24/01/2026 22:03:43 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9167 | AUPRC: 0.5525 | MinRP: 0.5316
24/01/2026 22:03:45 >> VAL          Epoch:     8 | AUROC: 0.8883 | AUPRC: 0.5321 | MinRP: 0.5285
24/01/2026 22:03:45 >> AUPRC improved: 0.5193 ---> 0.5321 (+0.0127)
24/01/2026 22:03:45 >> Saving checkpoint to ../outputs/physionet_2019/grud|fold:5/checkpoint_best.bin
24/01/2026 22:03:45 >> ============================================================
24/01/2026 22:03:45 >> >>> Epoch 9/20
24/01/2026 22:04:32 >> Epoch 9 completed | Avg Loss: 1.4479
24/01/2026 22:04:33 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9216 | AUPRC: 0.5627 | MinRP: 0.5128
24/01/2026 22:04:34 >> VAL          Epoch:     9 | AUROC: 0.8918 | AUPRC: 0.5311 | MinRP: 0.5285
24/01/2026 22:04:34 >> No improvement. Wait: 4/5
24/01/2026 22:04:34 >> ============================================================
24/01/2026 22:04:34 >> >>> Epoch 10/20
24/01/2026 22:05:22 >> Epoch 10 completed | Avg Loss: 1.4235
24/01/2026 22:05:23 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9198 | AUPRC: 0.5664 | MinRP: 0.5385
24/01/2026 22:05:25 >> VAL          Epoch:    10 | AUROC: 0.8818 | AUPRC: 0.5242 | MinRP: 0.5182
24/01/2026 22:05:25 >> No improvement. Wait: 3/5
24/01/2026 22:05:25 >> ============================================================
24/01/2026 22:05:25 >> >>> Epoch 11/20
24/01/2026 22:06:12 >> Epoch 11 completed | Avg Loss: 1.4235
24/01/2026 22:06:12 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9298 | AUPRC: 0.5669 | MinRP: 0.5000
24/01/2026 22:06:14 >> VAL          Epoch:    11 | AUROC: 0.8909 | AUPRC: 0.5430 | MinRP: 0.5203
24/01/2026 22:06:14 >> AUPRC improved: 0.5321 ---> 0.5430 (+0.0110)
24/01/2026 22:06:14 >> Saving checkpoint to ../outputs/physionet_2019/grud|fold:5/checkpoint_best.bin
24/01/2026 22:06:14 >> ============================================================
24/01/2026 22:06:14 >> >>> Epoch 12/20
24/01/2026 22:07:02 >> Epoch 12 completed | Avg Loss: 1.4497
24/01/2026 22:07:02 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9317 | AUPRC: 0.5825 | MinRP: 0.5385
24/01/2026 22:07:04 >> VAL          Epoch:    12 | AUROC: 0.8952 | AUPRC: 0.5383 | MinRP: 0.5163
24/01/2026 22:07:04 >> No improvement. Wait: 4/5
24/01/2026 22:07:04 >> ============================================================
24/01/2026 22:07:04 >> >>> Epoch 13/20
24/01/2026 22:07:52 >> Epoch 13 completed | Avg Loss: 1.3309
24/01/2026 22:07:52 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9397 | AUPRC: 0.6150 | MinRP: 0.5769
24/01/2026 22:07:54 >> VAL          Epoch:    13 | AUROC: 0.8829 | AUPRC: 0.5303 | MinRP: 0.5223
24/01/2026 22:07:54 >> No improvement. Wait: 3/5
24/01/2026 22:07:54 >> ============================================================
24/01/2026 22:07:54 >> >>> Epoch 14/20
24/01/2026 22:08:43 >> Epoch 14 completed | Avg Loss: 1.3685
24/01/2026 22:08:43 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9444 | AUPRC: 0.6237 | MinRP: 0.5897
24/01/2026 22:08:45 >> VAL          Epoch:    14 | AUROC: 0.8895 | AUPRC: 0.5365 | MinRP: 0.5122
24/01/2026 22:08:45 >> No improvement. Wait: 2/5
24/01/2026 22:08:45 >> ============================================================
24/01/2026 22:08:45 >> >>> Epoch 15/20
24/01/2026 22:09:33 >> Epoch 15 completed | Avg Loss: 1.3484
24/01/2026 22:09:34 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9522 | AUPRC: 0.6436 | MinRP: 0.5897
24/01/2026 22:09:36 >> VAL          Epoch:    15 | AUROC: 0.8956 | AUPRC: 0.5363 | MinRP: 0.5122
24/01/2026 22:09:36 >> No improvement. Wait: 1/5
24/01/2026 22:09:36 >> ============================================================
24/01/2026 22:09:36 >> >>> Epoch 16/20
24/01/2026 22:10:24 >> Epoch 16 completed | Avg Loss: 1.3685
24/01/2026 22:10:25 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9521 | AUPRC: 0.6652 | MinRP: 0.5897
24/01/2026 22:10:27 >> VAL          Epoch:    16 | AUROC: 0.8848 | AUPRC: 0.5129 | MinRP: 0.4960
24/01/2026 22:10:27 >> No improvement. Wait: 0/5
24/01/2026 22:10:27 >> Patience reached. Early stopping.

24/01/2026 22:10:27 >> ============================================================
24/01/2026 22:10:27 >> TRAINING COMPLETED
24/01/2026 22:10:27 >> ============================================================
24/01/2026 22:10:27 >> Best Validation Results:
24/01/2026 22:10:27 >>   AUROC: 0.8909 | AUPRC: 0.5430 | MinRP: 0.5203
24/01/2026 22:10:27 >> Loading best model from ../outputs/physionet_2019/grud|fold:5/checkpoint_best.bin
24/01/2026 22:10:27 >> Evaluating on test set...
24/01/2026 22:10:29 >> TEST         AUROC: 0.8742 | AUPRC: 0.4496 | MinRP: 0.4498 | Accuracy: 0.9655

24/01/2026 22:10:29 >> ============================================================
24/01/2026 22:10:29 >> Classification Report:
24/01/2026 22:10:29 >>               precision    recall  f1-score   support
24/01/2026 22:10:29 >> 
24/01/2026 22:10:29 >>          0.0     0.9730    0.9916    0.9822      7407
24/01/2026 22:10:29 >>          1.0     0.6265    0.3377    0.4388       308
24/01/2026 22:10:29 >> 
24/01/2026 22:10:29 >>     accuracy                         0.9655      7715
24/01/2026 22:10:29 >>    macro avg     0.7997    0.6646    0.7105      7715
24/01/2026 22:10:29 >> weighted avg     0.9591    0.9655    0.9605      7715
24/01/2026 22:10:29 >> 
24/01/2026 22:10:29 >> Confusion Matrix:
24/01/2026 22:10:29 >> [7345, 62]
24/01/2026 22:10:29 >> [204, 104]
24/01/2026 22:10:29 >> ============================================================
24/01/2026 22:10:29 >> Final Test Results:
24/01/2026 22:10:29 >>   AUROC: 0.8742 | AUPRC: 0.4496 | MinRP: 0.4498 | Accuracy: 0.9655
24/01/2026 22:10:29 >> ============================================================

