19/01/2026 16:00:33 >> Namespace(dataset='physionet_2019', model_type='raindrop', split_file='physionet_2019_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2019/raindrop|fold:1', lr=0.0001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:0', seed=2026, hid_dim=256, num_layers=2, num_heads=16, dropout=0.1, logger=<utils.logger.Logger object at 0x7a8d5f506140>)

19/01/2026 16:00:33 >> Preparing dataset physionet_2019
19/01/2026 16:00:34 >> Using fold 1/5
19/01/2026 16:00:34 >> Loaded splits from physionet_2019_5fold.json
19/01/2026 16:00:36 >> # train, val, test TS: [24688, 6172, 7715]
19/01/2026 16:00:37 >> pos class weight: 26.3703
19/01/2026 16:00:37 >> % pos class in train, val, test splits: [0.0365, 0.0405, 0.0377]
19/01/2026 16:00:37 >> # static features: 5
19/01/2026 16:00:38 >> # TS variables: 34
19/01/2026 16:00:41 >> # timesteps (Raindrop): 61

19/01/2026 16:00:51 >> Model details:
19/01/2026 16:00:51 >> # parameters: 5928246
19/01/2026 16:00:51 >> # trainable parameters: 5928246, 100.0%
19/01/2026 16:00:51 >> #params by dtype:
19/01/2026 16:00:51 >> torch.float32: 5928246, 100.0%

19/01/2026 16:00:51 >> No. of training batches per epoch = 772

19/01/2026 16:00:51 >> ============================================================
19/01/2026 16:00:51 >>                Starting training...
19/01/2026 16:00:51 >> ============================================================
19/01/2026 16:00:51 >> >>> Epoch 1/20
19/01/2026 16:01:46 >> Epoch 1 completed | Avg Loss: 0.6218
19/01/2026 16:01:48 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.6616 | AUPRC: 0.2081 | MinRP: 0.2237
19/01/2026 16:01:54 >> VAL          Epoch:     1 | AUROC: 0.7270 | AUPRC: 0.3043 | MinRP: 0.3280
19/01/2026 16:01:54 >> AUPRC improved: 0.0000 ---> 0.3043 (+0.3043)
19/01/2026 16:01:54 >> Saving checkpoint to ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:01:54 >> ============================================================
19/01/2026 16:01:54 >> >>> Epoch 2/20
19/01/2026 16:02:47 >> Epoch 2 completed | Avg Loss: 0.5720
19/01/2026 16:02:49 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.7328 | AUPRC: 0.1887 | MinRP: 0.2658
19/01/2026 16:02:55 >> VAL          Epoch:     2 | AUROC: 0.7862 | AUPRC: 0.3007 | MinRP: 0.3560
19/01/2026 16:02:55 >> No improvement. Wait: 4/5
19/01/2026 16:02:55 >> ============================================================
19/01/2026 16:02:55 >> >>> Epoch 3/20
19/01/2026 16:03:48 >> Epoch 3 completed | Avg Loss: 0.5346
19/01/2026 16:03:50 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.7713 | AUPRC: 0.2071 | MinRP: 0.3158
19/01/2026 16:03:56 >> VAL          Epoch:     3 | AUROC: 0.8113 | AUPRC: 0.3110 | MinRP: 0.3680
19/01/2026 16:03:56 >> AUPRC improved: 0.3043 ---> 0.3110 (+0.0067)
19/01/2026 16:03:56 >> Saving checkpoint to ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:03:56 >> ============================================================
19/01/2026 16:03:56 >> >>> Epoch 4/20
19/01/2026 16:04:51 >> Epoch 4 completed | Avg Loss: 0.5337
19/01/2026 16:04:53 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.7902 | AUPRC: 0.2246 | MinRP: 0.3289
19/01/2026 16:05:00 >> VAL          Epoch:     4 | AUROC: 0.8223 | AUPRC: 0.3157 | MinRP: 0.3800
19/01/2026 16:05:00 >> AUPRC improved: 0.3110 ---> 0.3157 (+0.0047)
19/01/2026 16:05:00 >> Saving checkpoint to ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:05:00 >> ============================================================
19/01/2026 16:05:00 >> >>> Epoch 5/20
19/01/2026 16:06:00 >> Epoch 5 completed | Avg Loss: 0.5347
19/01/2026 16:06:02 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.7841 | AUPRC: 0.3186 | MinRP: 0.3580
19/01/2026 16:06:08 >> VAL          Epoch:     5 | AUROC: 0.8128 | AUPRC: 0.3784 | MinRP: 0.4143
19/01/2026 16:06:08 >> AUPRC improved: 0.3157 ---> 0.3784 (+0.0627)
19/01/2026 16:06:08 >> Saving checkpoint to ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:06:08 >> ============================================================
19/01/2026 16:06:08 >> >>> Epoch 6/20
19/01/2026 16:07:02 >> Epoch 6 completed | Avg Loss: 0.5097
19/01/2026 16:07:04 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8284 | AUPRC: 0.3190 | MinRP: 0.3462
19/01/2026 16:07:10 >> VAL          Epoch:     6 | AUROC: 0.8205 | AUPRC: 0.3802 | MinRP: 0.3960
19/01/2026 16:07:10 >> AUPRC improved: 0.3784 ---> 0.3802 (+0.0018)
19/01/2026 16:07:10 >> Saving checkpoint to ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:07:10 >> ============================================================
19/01/2026 16:07:10 >> >>> Epoch 7/20
19/01/2026 16:08:03 >> Epoch 7 completed | Avg Loss: 0.5032
19/01/2026 16:08:05 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8353 | AUPRC: 0.3623 | MinRP: 0.3718
19/01/2026 16:08:11 >> VAL          Epoch:     7 | AUROC: 0.8269 | AUPRC: 0.3867 | MinRP: 0.4160
19/01/2026 16:08:11 >> AUPRC improved: 0.3802 ---> 0.3867 (+0.0065)
19/01/2026 16:08:11 >> Saving checkpoint to ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:08:11 >> ============================================================
19/01/2026 16:08:11 >> >>> Epoch 8/20
19/01/2026 16:09:04 >> Epoch 8 completed | Avg Loss: 0.5078
19/01/2026 16:09:06 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8374 | AUPRC: 0.3829 | MinRP: 0.4211
19/01/2026 16:09:12 >> VAL          Epoch:     8 | AUROC: 0.8283 | AUPRC: 0.3822 | MinRP: 0.4200
19/01/2026 16:09:12 >> No improvement. Wait: 4/5
19/01/2026 16:09:12 >> ============================================================
19/01/2026 16:09:12 >> >>> Epoch 9/20
19/01/2026 16:10:06 >> Epoch 9 completed | Avg Loss: 0.5052
19/01/2026 16:10:08 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8539 | AUPRC: 0.3861 | MinRP: 0.4211
19/01/2026 16:10:14 >> VAL          Epoch:     9 | AUROC: 0.8295 | AUPRC: 0.3814 | MinRP: 0.4160
19/01/2026 16:10:14 >> No improvement. Wait: 3/5
19/01/2026 16:10:14 >> ============================================================
19/01/2026 16:10:14 >> >>> Epoch 10/20
19/01/2026 16:11:09 >> Epoch 10 completed | Avg Loss: 0.4944
19/01/2026 16:11:11 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8565 | AUPRC: 0.3859 | MinRP: 0.3947
19/01/2026 16:11:17 >> VAL          Epoch:    10 | AUROC: 0.8266 | AUPRC: 0.4000 | MinRP: 0.4240
19/01/2026 16:11:17 >> AUPRC improved: 0.3867 ---> 0.4000 (+0.0134)
19/01/2026 16:11:17 >> Saving checkpoint to ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:11:17 >> ============================================================
19/01/2026 16:11:17 >> >>> Epoch 11/20
19/01/2026 16:12:16 >> Epoch 11 completed | Avg Loss: 0.4836
19/01/2026 16:12:18 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8686 | AUPRC: 0.4178 | MinRP: 0.4474
19/01/2026 16:12:25 >> VAL          Epoch:    11 | AUROC: 0.8305 | AUPRC: 0.3883 | MinRP: 0.4200
19/01/2026 16:12:25 >> No improvement. Wait: 4/5
19/01/2026 16:12:25 >> ============================================================
19/01/2026 16:12:25 >> >>> Epoch 12/20
19/01/2026 16:13:22 >> Epoch 12 completed | Avg Loss: 0.4897
19/01/2026 16:13:24 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8559 | AUPRC: 0.4241 | MinRP: 0.4474
19/01/2026 16:13:30 >> VAL          Epoch:    12 | AUROC: 0.8338 | AUPRC: 0.4097 | MinRP: 0.4480
19/01/2026 16:13:30 >> AUPRC improved: 0.4000 ---> 0.4097 (+0.0096)
19/01/2026 16:13:30 >> Saving checkpoint to ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:13:30 >> ============================================================
19/01/2026 16:13:30 >> >>> Epoch 13/20
19/01/2026 16:14:24 >> Epoch 13 completed | Avg Loss: 0.4641
19/01/2026 16:14:26 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8770 | AUPRC: 0.4347 | MinRP: 0.4737
19/01/2026 16:14:32 >> VAL          Epoch:    13 | AUROC: 0.8341 | AUPRC: 0.3953 | MinRP: 0.4240
19/01/2026 16:14:32 >> No improvement. Wait: 4/5
19/01/2026 16:14:32 >> ============================================================
19/01/2026 16:14:32 >> >>> Epoch 14/20
19/01/2026 16:15:25 >> Epoch 14 completed | Avg Loss: 0.4939
19/01/2026 16:15:27 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8886 | AUPRC: 0.4700 | MinRP: 0.5263
19/01/2026 16:15:33 >> VAL          Epoch:    14 | AUROC: 0.8337 | AUPRC: 0.4054 | MinRP: 0.4200
19/01/2026 16:15:33 >> No improvement. Wait: 3/5
19/01/2026 16:15:33 >> ============================================================
19/01/2026 16:15:33 >> >>> Epoch 15/20
19/01/2026 16:16:26 >> Epoch 15 completed | Avg Loss: 0.4776
19/01/2026 16:16:28 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.8952 | AUPRC: 0.4970 | MinRP: 0.5195
19/01/2026 16:16:34 >> VAL          Epoch:    15 | AUROC: 0.8303 | AUPRC: 0.3695 | MinRP: 0.4040
19/01/2026 16:16:34 >> No improvement. Wait: 2/5
19/01/2026 16:16:34 >> ============================================================
19/01/2026 16:16:34 >> >>> Epoch 16/20
19/01/2026 16:17:28 >> Epoch 16 completed | Avg Loss: 0.4682
19/01/2026 16:17:30 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.8917 | AUPRC: 0.5032 | MinRP: 0.5132
19/01/2026 16:17:36 >> VAL          Epoch:    16 | AUROC: 0.8208 | AUPRC: 0.4115 | MinRP: 0.4275
19/01/2026 16:17:36 >> AUPRC improved: 0.4097 ---> 0.4115 (+0.0018)
19/01/2026 16:17:36 >> Saving checkpoint to ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:17:36 >> ============================================================
19/01/2026 16:17:36 >> >>> Epoch 17/20
19/01/2026 16:18:30 >> Epoch 17 completed | Avg Loss: 0.4595
19/01/2026 16:18:32 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9078 | AUPRC: 0.5332 | MinRP: 0.5395
19/01/2026 16:18:39 >> VAL          Epoch:    17 | AUROC: 0.8325 | AUPRC: 0.3915 | MinRP: 0.4405
19/01/2026 16:18:39 >> No improvement. Wait: 4/5
19/01/2026 16:18:39 >> ============================================================
19/01/2026 16:18:39 >> >>> Epoch 18/20
19/01/2026 16:19:36 >> Epoch 18 completed | Avg Loss: 0.4628
19/01/2026 16:19:38 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9146 | AUPRC: 0.5601 | MinRP: 0.5395
19/01/2026 16:19:44 >> VAL          Epoch:    18 | AUROC: 0.8285 | AUPRC: 0.3904 | MinRP: 0.4560
19/01/2026 16:19:44 >> No improvement. Wait: 3/5
19/01/2026 16:19:44 >> ============================================================
19/01/2026 16:19:44 >> >>> Epoch 19/20
19/01/2026 16:20:41 >> Epoch 19 completed | Avg Loss: 0.4542
19/01/2026 16:20:43 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9191 | AUPRC: 0.5469 | MinRP: 0.5132
19/01/2026 16:20:49 >> VAL          Epoch:    19 | AUROC: 0.8249 | AUPRC: 0.4088 | MinRP: 0.4320
19/01/2026 16:20:49 >> No improvement. Wait: 2/5
19/01/2026 16:20:49 >> ============================================================
19/01/2026 16:20:49 >> >>> Epoch 20/20
19/01/2026 16:21:43 >> Epoch 20 completed | Avg Loss: 0.4600
19/01/2026 16:21:45 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.9123 | AUPRC: 0.5473 | MinRP: 0.5526
19/01/2026 16:21:51 >> VAL          Epoch:    20 | AUROC: 0.8187 | AUPRC: 0.4140 | MinRP: 0.4444
19/01/2026 16:21:51 >> AUPRC improved: 0.4115 ---> 0.4140 (+0.0025)
19/01/2026 16:21:51 >> Saving checkpoint to ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:21:51 >> ============================================================

19/01/2026 16:21:51 >> ============================================================
19/01/2026 16:21:51 >> TRAINING COMPLETED
19/01/2026 16:21:51 >> ============================================================
19/01/2026 16:21:51 >> Best Validation Results:
19/01/2026 16:21:51 >>   AUROC: 0.8187 | AUPRC: 0.4140 | MinRP: 0.4444
19/01/2026 16:21:51 >> Loading best model from ../outputs/physionet_2019/raindrop|fold:1/checkpoint_best.bin
19/01/2026 16:21:51 >> Evaluating on test set...
19/01/2026 16:21:58 >> TEST         AUROC: 0.8328 | AUPRC: 0.4329 | MinRP: 0.4536 | Accuracy: 0.9664

19/01/2026 16:21:58 >> ============================================================
19/01/2026 16:21:58 >> Classification Report:
19/01/2026 16:21:58 >>               precision    recall  f1-score   support
19/01/2026 16:21:58 >> 
19/01/2026 16:21:58 >>          0.0     0.9746    0.9910    0.9827      7424
19/01/2026 16:21:58 >>          1.0     0.5964    0.3402    0.4333       291
19/01/2026 16:21:58 >> 
19/01/2026 16:21:58 >>     accuracy                         0.9664      7715
19/01/2026 16:21:58 >>    macro avg     0.7855    0.6656    0.7080      7715
19/01/2026 16:21:58 >> weighted avg     0.9603    0.9664    0.9620      7715
19/01/2026 16:21:58 >> 
19/01/2026 16:21:58 >> Confusion Matrix:
19/01/2026 16:21:58 >> [7357, 67]
19/01/2026 16:21:58 >> [192, 99]
19/01/2026 16:21:58 >> ============================================================
19/01/2026 16:21:58 >> Final Test Results:
19/01/2026 16:21:58 >>   AUROC: 0.8328 | AUPRC: 0.4329 | MinRP: 0.4536 | Accuracy: 0.9664
19/01/2026 16:21:58 >> ============================================================
