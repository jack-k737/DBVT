24/01/2026 06:35:39 >> Namespace(dataset='physionet_2019', model_type='sand', split_file='physionet_2019_5fold.json', fold=3, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2019/sand|fold:3', lr=0.001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=64, num_layers=2, num_heads=4, dropout=0.2, r=10, M=16, logger=<utils.logger.Logger object at 0x71c44b61a140>)

24/01/2026 06:35:39 >> Preparing dataset physionet_2019
24/01/2026 06:35:39 >> Using fold 3/5
24/01/2026 06:35:39 >> Loaded splits from physionet_2019_5fold.json
24/01/2026 06:35:41 >> # train, val, test TS: [24688, 6172, 7715]
24/01/2026 06:35:41 >> pos class weight: 26.4616
24/01/2026 06:35:41 >> % pos class in train, val, test splits: [0.0364, 0.0382, 0.0399]
24/01/2026 06:35:42 >> # static features: 5
24/01/2026 06:35:42 >> # TS variables (SAND): 34
24/01/2026 06:35:45 >> # timesteps (hours): 61
24/01/2026 06:35:56 >> Input shape: [N, 61, 102]

24/01/2026 06:35:56 >> Model details:
24/01/2026 06:35:56 >> # parameters: 91738
24/01/2026 06:35:56 >> # trainable parameters: 87041, 94.87998430312412%
24/01/2026 06:35:56 >> #params by dtype:
24/01/2026 06:35:56 >> torch.float32: 91738, 100.0%

24/01/2026 06:35:56 >> No. of training batches per epoch = 772

24/01/2026 06:35:56 >> ============================================================
24/01/2026 06:35:56 >>                Starting training...
24/01/2026 06:35:56 >> ============================================================
24/01/2026 06:35:56 >> >>> Epoch 1/20
24/01/2026 06:36:02 >> Epoch 1 completed | Avg Loss: 2.9656
24/01/2026 06:36:02 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.7776 | AUPRC: 0.3841 | MinRP: 0.3810
24/01/2026 06:36:02 >> VAL          Epoch:     1 | AUROC: 0.8237 | AUPRC: 0.3736 | MinRP: 0.4322
24/01/2026 06:36:02 >> AUPRC improved: 0.0000 ---> 0.3736 (+0.3736)
24/01/2026 06:36:02 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:3/checkpoint_best.bin
24/01/2026 06:36:02 >> ============================================================
24/01/2026 06:36:02 >> >>> Epoch 2/20
24/01/2026 06:36:07 >> Epoch 2 completed | Avg Loss: 2.4434
24/01/2026 06:36:07 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.7772 | AUPRC: 0.2818 | MinRP: 0.3333
24/01/2026 06:36:07 >> VAL          Epoch:     2 | AUROC: 0.8350 | AUPRC: 0.2737 | MinRP: 0.3760
24/01/2026 06:36:07 >> No improvement. Wait: 4/5
24/01/2026 06:36:07 >> ============================================================
24/01/2026 06:36:07 >> >>> Epoch 3/20
24/01/2026 06:36:12 >> Epoch 3 completed | Avg Loss: 2.3333
24/01/2026 06:36:12 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.7985 | AUPRC: 0.2880 | MinRP: 0.3750
24/01/2026 06:36:12 >> VAL          Epoch:     3 | AUROC: 0.8176 | AUPRC: 0.3230 | MinRP: 0.3941
24/01/2026 06:36:12 >> No improvement. Wait: 3/5
24/01/2026 06:36:12 >> ============================================================
24/01/2026 06:36:12 >> >>> Epoch 4/20
24/01/2026 06:36:16 >> Epoch 4 completed | Avg Loss: 2.0091
24/01/2026 06:36:16 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.7942 | AUPRC: 0.3005 | MinRP: 0.3824
24/01/2026 06:36:16 >> VAL          Epoch:     4 | AUROC: 0.8345 | AUPRC: 0.3087 | MinRP: 0.4025
24/01/2026 06:36:16 >> No improvement. Wait: 2/5
24/01/2026 06:36:16 >> ============================================================
24/01/2026 06:36:16 >> >>> Epoch 5/20
24/01/2026 06:36:22 >> Epoch 5 completed | Avg Loss: 1.8124
24/01/2026 06:36:22 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.7957 | AUPRC: 0.3111 | MinRP: 0.3906
24/01/2026 06:36:22 >> VAL          Epoch:     5 | AUROC: 0.8416 | AUPRC: 0.3547 | MinRP: 0.4025
24/01/2026 06:36:22 >> No improvement. Wait: 1/5
24/01/2026 06:36:22 >> ============================================================
24/01/2026 06:36:22 >> >>> Epoch 6/20
24/01/2026 06:36:27 >> Epoch 6 completed | Avg Loss: 1.5513
24/01/2026 06:36:27 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.7919 | AUPRC: 0.3621 | MinRP: 0.3651
24/01/2026 06:36:27 >> VAL          Epoch:     6 | AUROC: 0.8326 | AUPRC: 0.4058 | MinRP: 0.4322
24/01/2026 06:36:27 >> AUPRC improved: 0.3736 ---> 0.4058 (+0.0321)
24/01/2026 06:36:27 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:3/checkpoint_best.bin
24/01/2026 06:36:27 >> ============================================================
24/01/2026 06:36:27 >> >>> Epoch 7/20
24/01/2026 06:36:32 >> Epoch 7 completed | Avg Loss: 1.5246
24/01/2026 06:36:32 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8059 | AUPRC: 0.3446 | MinRP: 0.3492
24/01/2026 06:36:32 >> VAL          Epoch:     7 | AUROC: 0.8233 | AUPRC: 0.3790 | MinRP: 0.4068
24/01/2026 06:36:32 >> No improvement. Wait: 4/5
24/01/2026 06:36:32 >> ============================================================
24/01/2026 06:36:32 >> >>> Epoch 8/20
24/01/2026 06:36:36 >> Epoch 8 completed | Avg Loss: 1.5419
24/01/2026 06:36:36 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8170 | AUPRC: 0.3482 | MinRP: 0.3810
24/01/2026 06:36:37 >> VAL          Epoch:     8 | AUROC: 0.8459 | AUPRC: 0.4009 | MinRP: 0.4449
24/01/2026 06:36:37 >> No improvement. Wait: 3/5
24/01/2026 06:36:37 >> ============================================================
24/01/2026 06:36:37 >> >>> Epoch 9/20
24/01/2026 06:36:43 >> Epoch 9 completed | Avg Loss: 1.4250
24/01/2026 06:36:43 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8225 | AUPRC: 0.3597 | MinRP: 0.4000
24/01/2026 06:36:43 >> VAL          Epoch:     9 | AUROC: 0.8396 | AUPRC: 0.4105 | MinRP: 0.4304
24/01/2026 06:36:43 >> AUPRC improved: 0.4058 ---> 0.4105 (+0.0047)
24/01/2026 06:36:43 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:3/checkpoint_best.bin
24/01/2026 06:36:43 >> ============================================================
24/01/2026 06:36:43 >> >>> Epoch 10/20
24/01/2026 06:36:49 >> Epoch 10 completed | Avg Loss: 1.3797
24/01/2026 06:36:49 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8240 | AUPRC: 0.4075 | MinRP: 0.3913
24/01/2026 06:36:49 >> VAL          Epoch:    10 | AUROC: 0.8527 | AUPRC: 0.4272 | MinRP: 0.4280
24/01/2026 06:36:49 >> AUPRC improved: 0.4105 ---> 0.4272 (+0.0168)
24/01/2026 06:36:49 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:3/checkpoint_best.bin
24/01/2026 06:36:49 >> ============================================================
24/01/2026 06:36:49 >> >>> Epoch 11/20
24/01/2026 06:36:55 >> Epoch 11 completed | Avg Loss: 1.3312
24/01/2026 06:36:55 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8031 | AUPRC: 0.4010 | MinRP: 0.3492
24/01/2026 06:36:55 >> VAL          Epoch:    11 | AUROC: 0.8605 | AUPRC: 0.4336 | MinRP: 0.4280
24/01/2026 06:36:55 >> AUPRC improved: 0.4272 ---> 0.4336 (+0.0063)
24/01/2026 06:36:55 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:3/checkpoint_best.bin
24/01/2026 06:36:55 >> ============================================================
24/01/2026 06:36:55 >> >>> Epoch 12/20
24/01/2026 06:37:00 >> Epoch 12 completed | Avg Loss: 1.3239
24/01/2026 06:37:00 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8133 | AUPRC: 0.3920 | MinRP: 0.3538
24/01/2026 06:37:00 >> VAL          Epoch:    12 | AUROC: 0.8600 | AUPRC: 0.4215 | MinRP: 0.4322
24/01/2026 06:37:00 >> No improvement. Wait: 4/5
24/01/2026 06:37:00 >> ============================================================
24/01/2026 06:37:00 >> >>> Epoch 13/20
24/01/2026 06:37:04 >> Epoch 13 completed | Avg Loss: 1.3515
24/01/2026 06:37:04 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8158 | AUPRC: 0.3798 | MinRP: 0.4286
24/01/2026 06:37:04 >> VAL          Epoch:    13 | AUROC: 0.8466 | AUPRC: 0.4112 | MinRP: 0.4346
24/01/2026 06:37:04 >> No improvement. Wait: 3/5
24/01/2026 06:37:04 >> ============================================================
24/01/2026 06:37:04 >> >>> Epoch 14/20
24/01/2026 06:37:09 >> Epoch 14 completed | Avg Loss: 1.2794
24/01/2026 06:37:09 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8264 | AUPRC: 0.3564 | MinRP: 0.3906
24/01/2026 06:37:09 >> VAL          Epoch:    14 | AUROC: 0.8464 | AUPRC: 0.3702 | MinRP: 0.3909
24/01/2026 06:37:09 >> No improvement. Wait: 2/5
24/01/2026 06:37:09 >> ============================================================
24/01/2026 06:37:09 >> >>> Epoch 15/20
24/01/2026 06:37:14 >> Epoch 15 completed | Avg Loss: 1.3596
24/01/2026 06:37:14 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.8142 | AUPRC: 0.3900 | MinRP: 0.3810
24/01/2026 06:37:14 >> VAL          Epoch:    15 | AUROC: 0.8556 | AUPRC: 0.4005 | MinRP: 0.4068
24/01/2026 06:37:14 >> No improvement. Wait: 1/5
24/01/2026 06:37:14 >> ============================================================
24/01/2026 06:37:14 >> >>> Epoch 16/20
24/01/2026 06:37:19 >> Epoch 16 completed | Avg Loss: 1.3037
24/01/2026 06:37:19 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.8505 | AUPRC: 0.4195 | MinRP: 0.4462
24/01/2026 06:37:19 >> VAL          Epoch:    16 | AUROC: 0.8484 | AUPRC: 0.4407 | MinRP: 0.4351
24/01/2026 06:37:19 >> AUPRC improved: 0.4336 ---> 0.4407 (+0.0071)
24/01/2026 06:37:19 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:3/checkpoint_best.bin
24/01/2026 06:37:19 >> ============================================================
24/01/2026 06:37:19 >> >>> Epoch 17/20
24/01/2026 06:37:24 >> Epoch 17 completed | Avg Loss: 1.3291
24/01/2026 06:37:24 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.8633 | AUPRC: 0.4130 | MinRP: 0.4058
24/01/2026 06:37:24 >> VAL          Epoch:    17 | AUROC: 0.8586 | AUPRC: 0.4533 | MinRP: 0.4492
24/01/2026 06:37:24 >> AUPRC improved: 0.4407 ---> 0.4533 (+0.0126)
24/01/2026 06:37:24 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:3/checkpoint_best.bin
24/01/2026 06:37:24 >> ============================================================
24/01/2026 06:37:24 >> >>> Epoch 18/20
24/01/2026 06:37:28 >> Epoch 18 completed | Avg Loss: 1.2371
24/01/2026 06:37:28 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.8674 | AUPRC: 0.4416 | MinRP: 0.4127
24/01/2026 06:37:29 >> VAL          Epoch:    18 | AUROC: 0.8543 | AUPRC: 0.4310 | MinRP: 0.4407
24/01/2026 06:37:29 >> No improvement. Wait: 4/5
24/01/2026 06:37:29 >> ============================================================
24/01/2026 06:37:29 >> >>> Epoch 19/20
24/01/2026 06:37:34 >> Epoch 19 completed | Avg Loss: 1.2866
24/01/2026 06:37:34 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.8619 | AUPRC: 0.4253 | MinRP: 0.3968
24/01/2026 06:37:34 >> VAL          Epoch:    19 | AUROC: 0.8594 | AUPRC: 0.4454 | MinRP: 0.4322
24/01/2026 06:37:34 >> No improvement. Wait: 3/5
24/01/2026 06:37:34 >> ============================================================
24/01/2026 06:37:34 >> >>> Epoch 20/20
24/01/2026 06:37:41 >> Epoch 20 completed | Avg Loss: 1.3174
24/01/2026 06:37:41 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.8566 | AUPRC: 0.4314 | MinRP: 0.4085
24/01/2026 06:37:41 >> VAL          Epoch:    20 | AUROC: 0.8651 | AUPRC: 0.4463 | MinRP: 0.4370
24/01/2026 06:37:41 >> No improvement. Wait: 2/5
24/01/2026 06:37:41 >> ============================================================

24/01/2026 06:37:41 >> ============================================================
24/01/2026 06:37:41 >> TRAINING COMPLETED
24/01/2026 06:37:41 >> ============================================================
24/01/2026 06:37:41 >> Best Validation Results:
24/01/2026 06:37:41 >>   AUROC: 0.8586 | AUPRC: 0.4533 | MinRP: 0.4492
24/01/2026 06:37:41 >> Loading best model from ../outputs/physionet_2019/sand|fold:3/checkpoint_best.bin
24/01/2026 06:37:41 >> Evaluating on test set...
24/01/2026 06:37:41 >> TEST         AUROC: 0.8208 | AUPRC: 0.3636 | MinRP: 0.3981 | Accuracy: 0.8855

24/01/2026 06:37:41 >> ============================================================
24/01/2026 06:37:41 >> Classification Report:
24/01/2026 06:37:41 >>               precision    recall  f1-score   support
24/01/2026 06:37:41 >> 
24/01/2026 06:37:41 >>          0.0     0.9798    0.8993    0.9378      7407
24/01/2026 06:37:41 >>          1.0     0.1865    0.5552    0.2792       308
24/01/2026 06:37:41 >> 
24/01/2026 06:37:41 >>     accuracy                         0.8855      7715
24/01/2026 06:37:41 >>    macro avg     0.5832    0.7272    0.6085      7715
24/01/2026 06:37:41 >> weighted avg     0.9482    0.8855    0.9115      7715
24/01/2026 06:37:41 >> 
24/01/2026 06:37:41 >> Confusion Matrix:
24/01/2026 06:37:41 >> [6661, 746]
24/01/2026 06:37:41 >> [137, 171]
24/01/2026 06:37:41 >> ============================================================
24/01/2026 06:37:41 >> Final Test Results:
24/01/2026 06:37:41 >>   AUROC: 0.8208 | AUPRC: 0.3636 | MinRP: 0.3981 | Accuracy: 0.8855
24/01/2026 06:37:41 >> ============================================================
