07/02/2026 20:42:38 >> Namespace(dataset='physionet_2019', model_type='dbvt', split_file='physionet_2019_5fold.json', fold=3, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2019/dbvt|fold:3', lr=0.0005, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, gru_hid_dim=256, gru_dropout=0.4, transformer_hid_dim=64, transformer_num_layers=4, transformer_num_heads=4, transformer_dropout=0.15, fusion_hid_dim=256, fusion_dropout=0.2, lambda_aux=0.5, lambda_cos=1.0, logger=<utils.logger.Logger object at 0x78a7615ab760>)

07/02/2026 20:42:38 >> Preparing dataset physionet_2019
07/02/2026 20:42:38 >> Using fold 3/5
07/02/2026 20:42:38 >> Loaded splits from physionet_2019_5fold.json
07/02/2026 20:42:41 >> # train, val, test TS: [24688, 6172, 7715]
07/02/2026 20:42:43 >> pos class weight: 26.4616
07/02/2026 20:42:43 >> % pos class in train, val, test splits: [0.0364, 0.0382, 0.0399]
07/02/2026 20:42:44 >> # static features: 5
07/02/2026 20:42:45 >> # TS variables (DBVT): 34
07/02/2026 20:42:50 >> # timesteps (DBVT): 61

07/02/2026 20:43:43 >> Model details:
07/02/2026 20:43:43 >> # parameters: 835623
07/02/2026 20:43:43 >> # trainable parameters: 835623, 100.0%
07/02/2026 20:43:43 >> #params by dtype:
07/02/2026 20:43:43 >> torch.float32: 835623, 100.0%

07/02/2026 20:43:43 >> No. of training batches per epoch = 772

07/02/2026 20:43:43 >> ============================================================
07/02/2026 20:43:43 >>                Starting training...
07/02/2026 20:43:43 >> ============================================================
07/02/2026 20:43:43 >> >>> Epoch 1/20
07/02/2026 20:45:12 >> Epoch 1 completed | Avg Loss: 3.0322
07/02/2026 20:45:16 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8292 | AUPRC: 0.4290 | MinRP: 0.4143
07/02/2026 20:45:25 >> VAL          Epoch:     1 | AUROC: 0.8631 | AUPRC: 0.4672 | MinRP: 0.4831
07/02/2026 20:45:25 >> AUPRC improved: 0.0000 ---> 0.4672 (+0.4672)
07/02/2026 20:45:25 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:3/checkpoint_best.bin
07/02/2026 20:45:25 >> ============================================================
07/02/2026 20:45:25 >> >>> Epoch 2/20
07/02/2026 20:46:52 >> Epoch 2 completed | Avg Loss: 2.9478
07/02/2026 20:46:55 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8275 | AUPRC: 0.4330 | MinRP: 0.4286
07/02/2026 20:47:03 >> VAL          Epoch:     2 | AUROC: 0.8812 | AUPRC: 0.4804 | MinRP: 0.4641
07/02/2026 20:47:03 >> AUPRC improved: 0.4672 ---> 0.4804 (+0.0132)
07/02/2026 20:47:03 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:3/checkpoint_best.bin
07/02/2026 20:47:03 >> ============================================================
07/02/2026 20:47:03 >> >>> Epoch 3/20
07/02/2026 20:48:12 >> Epoch 3 completed | Avg Loss: 3.0285
07/02/2026 20:48:13 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8370 | AUPRC: 0.4291 | MinRP: 0.4127
07/02/2026 20:48:18 >> VAL          Epoch:     3 | AUROC: 0.8834 | AUPRC: 0.4937 | MinRP: 0.4703
07/02/2026 20:48:18 >> AUPRC improved: 0.4804 ---> 0.4937 (+0.0133)
07/02/2026 20:48:18 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:3/checkpoint_best.bin
07/02/2026 20:48:18 >> ============================================================
07/02/2026 20:48:18 >> >>> Epoch 4/20
07/02/2026 20:49:12 >> Epoch 4 completed | Avg Loss: 2.8615
07/02/2026 20:49:14 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8506 | AUPRC: 0.4393 | MinRP: 0.4603
07/02/2026 20:49:19 >> VAL          Epoch:     4 | AUROC: 0.8741 | AUPRC: 0.4839 | MinRP: 0.4580
07/02/2026 20:49:19 >> No improvement. Wait: 4/5
07/02/2026 20:49:19 >> ============================================================
07/02/2026 20:49:19 >> >>> Epoch 5/20
07/02/2026 20:50:13 >> Epoch 5 completed | Avg Loss: 3.1005
07/02/2026 20:50:15 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8497 | AUPRC: 0.4401 | MinRP: 0.4615
07/02/2026 20:50:19 >> VAL          Epoch:     5 | AUROC: 0.8847 | AUPRC: 0.5000 | MinRP: 0.4788
07/02/2026 20:50:19 >> AUPRC improved: 0.4937 ---> 0.5000 (+0.0064)
07/02/2026 20:50:19 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:3/checkpoint_best.bin
07/02/2026 20:50:19 >> ============================================================
07/02/2026 20:50:19 >> >>> Epoch 6/20
07/02/2026 20:51:34 >> Epoch 6 completed | Avg Loss: 2.7503
07/02/2026 20:51:37 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8586 | AUPRC: 0.4759 | MinRP: 0.4615
07/02/2026 20:51:45 >> VAL          Epoch:     6 | AUROC: 0.8930 | AUPRC: 0.5162 | MinRP: 0.4873
07/02/2026 20:51:45 >> AUPRC improved: 0.5000 ---> 0.5162 (+0.0162)
07/02/2026 20:51:45 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:3/checkpoint_best.bin
07/02/2026 20:51:45 >> ============================================================
07/02/2026 20:51:45 >> >>> Epoch 7/20
07/02/2026 20:53:15 >> Epoch 7 completed | Avg Loss: 2.7606
07/02/2026 20:53:18 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8558 | AUPRC: 0.4175 | MinRP: 0.4308
07/02/2026 20:53:26 >> VAL          Epoch:     7 | AUROC: 0.8868 | AUPRC: 0.4415 | MinRP: 0.4153
07/02/2026 20:53:26 >> No improvement. Wait: 4/5
07/02/2026 20:53:26 >> ============================================================
07/02/2026 20:53:26 >> >>> Epoch 8/20
07/02/2026 20:54:55 >> Epoch 8 completed | Avg Loss: 3.0731
07/02/2026 20:54:58 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8761 | AUPRC: 0.4749 | MinRP: 0.4844
07/02/2026 20:55:06 >> VAL          Epoch:     8 | AUROC: 0.8978 | AUPRC: 0.5179 | MinRP: 0.4788
07/02/2026 20:55:06 >> AUPRC improved: 0.5162 ---> 0.5179 (+0.0017)
07/02/2026 20:55:06 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:3/checkpoint_best.bin
07/02/2026 20:55:06 >> ============================================================
07/02/2026 20:55:06 >> >>> Epoch 9/20
07/02/2026 20:56:36 >> Epoch 9 completed | Avg Loss: 3.0200
07/02/2026 20:56:39 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8848 | AUPRC: 0.5057 | MinRP: 0.5079
07/02/2026 20:56:47 >> VAL          Epoch:     9 | AUROC: 0.8893 | AUPRC: 0.5339 | MinRP: 0.5169
07/02/2026 20:56:47 >> AUPRC improved: 0.5179 ---> 0.5339 (+0.0160)
07/02/2026 20:56:47 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:3/checkpoint_best.bin
07/02/2026 20:56:47 >> ============================================================
07/02/2026 20:56:47 >> >>> Epoch 10/20
07/02/2026 20:58:17 >> Epoch 10 completed | Avg Loss: 3.0508
07/02/2026 20:58:20 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8777 | AUPRC: 0.4968 | MinRP: 0.4762
07/02/2026 20:58:28 >> VAL          Epoch:    10 | AUROC: 0.8885 | AUPRC: 0.5014 | MinRP: 0.4788
07/02/2026 20:58:28 >> No improvement. Wait: 4/5
07/02/2026 20:58:28 >> ============================================================
07/02/2026 20:58:28 >> >>> Epoch 11/20
07/02/2026 20:59:58 >> Epoch 11 completed | Avg Loss: 2.9229
07/02/2026 21:00:01 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8670 | AUPRC: 0.4755 | MinRP: 0.4615
07/02/2026 21:00:10 >> VAL          Epoch:    11 | AUROC: 0.8842 | AUPRC: 0.4888 | MinRP: 0.4619
07/02/2026 21:00:10 >> No improvement. Wait: 3/5
07/02/2026 21:00:10 >> ============================================================
07/02/2026 21:00:10 >> >>> Epoch 12/20
07/02/2026 21:01:40 >> Epoch 12 completed | Avg Loss: 2.8995
07/02/2026 21:01:42 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8871 | AUPRC: 0.5128 | MinRP: 0.5079
07/02/2026 21:01:51 >> VAL          Epoch:    12 | AUROC: 0.8883 | AUPRC: 0.5297 | MinRP: 0.5021
07/02/2026 21:01:51 >> No improvement. Wait: 2/5
07/02/2026 21:01:51 >> ============================================================
07/02/2026 21:01:51 >> >>> Epoch 13/20
07/02/2026 21:03:21 >> Epoch 13 completed | Avg Loss: 3.1160
07/02/2026 21:03:24 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8883 | AUPRC: 0.5124 | MinRP: 0.4921
07/02/2026 21:03:32 >> VAL          Epoch:    13 | AUROC: 0.8864 | AUPRC: 0.5175 | MinRP: 0.5021
07/02/2026 21:03:32 >> No improvement. Wait: 1/5
07/02/2026 21:03:32 >> ============================================================
07/02/2026 21:03:32 >> >>> Epoch 14/20
07/02/2026 21:05:02 >> Epoch 14 completed | Avg Loss: 2.9782
07/02/2026 21:05:05 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8781 | AUPRC: 0.4679 | MinRP: 0.4444
07/02/2026 21:05:13 >> VAL          Epoch:    14 | AUROC: 0.8893 | AUPRC: 0.4917 | MinRP: 0.4915
07/02/2026 21:05:13 >> No improvement. Wait: 0/5
07/02/2026 21:05:13 >> Patience reached. Early stopping.

07/02/2026 21:05:13 >> ============================================================
07/02/2026 21:05:13 >> TRAINING COMPLETED
07/02/2026 21:05:13 >> ============================================================
07/02/2026 21:05:13 >> Best Validation Results:
07/02/2026 21:05:13 >>   AUROC: 0.8893 | AUPRC: 0.5339 | MinRP: 0.5169
07/02/2026 21:05:13 >> Loading best model from ../outputs/physionet_2019/dbvt|fold:3/checkpoint_best.bin
07/02/2026 21:05:14 >> Evaluating on test set...
07/02/2026 21:05:25 >> TEST         AUROC: 0.8596 | AUPRC: 0.4695 | MinRP: 0.4693 | Accuracy: 0.9655

07/02/2026 21:05:25 >> ============================================================
07/02/2026 21:05:25 >> Classification Report:
07/02/2026 21:05:25 >>               precision    recall  f1-score   support
07/02/2026 21:05:25 >> 
07/02/2026 21:05:25 >>          0.0     0.9746    0.9899    0.9822      7407
07/02/2026 21:05:25 >>          1.0     0.6094    0.3799    0.4680       308
07/02/2026 21:05:25 >> 
07/02/2026 21:05:25 >>     accuracy                         0.9655      7715
07/02/2026 21:05:25 >>    macro avg     0.7920    0.6849    0.7251      7715
07/02/2026 21:05:25 >> weighted avg     0.9600    0.9655    0.9617      7715
07/02/2026 21:05:25 >> 
07/02/2026 21:05:25 >> Confusion Matrix:
07/02/2026 21:05:25 >> [7332, 75]
07/02/2026 21:05:25 >> [191, 117]
07/02/2026 21:05:25 >> ============================================================
07/02/2026 21:05:25 >> Final Test Results:
07/02/2026 21:05:25 >>   AUROC: 0.8596 | AUPRC: 0.4695 | MinRP: 0.4693 | Accuracy: 0.9655
07/02/2026 21:05:25 >> ============================================================
