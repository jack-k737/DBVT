25/01/2026 09:44:23 >> Namespace(dataset='physionet_2019', model='ours1', split_file='physionet_2019_5fold.json', fold=4, root_dir='/home/xiejun/codeLib/miccai', output_dir='/home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4', lr=0.0005, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, gru_hid_dim=256, gru_dropout=0.4, transformer_hid_dim=64, transformer_num_layers=4, transformer_num_heads=4, transformer_dropout=0.15, fusion_hid_dim=256, fusion_dropout=0.2, lambda_aux=0.5, lambda_cos=1.0, logger=<utils.logger.Logger object at 0x76cc2bc1e140>)

25/01/2026 09:44:23 >> ============================================================
25/01/2026 09:44:23 >> Loading dataset...
25/01/2026 09:44:23 >> ============================================================

25/01/2026 09:44:23 >> Preparing dataset physionet_2019
25/01/2026 09:44:24 >> Using fold 4/5
25/01/2026 09:44:24 >> Loaded splits from physionet_2019_5fold.json
25/01/2026 09:44:25 >> # train, val, test TS: [24688, 6172, 7715]
25/01/2026 09:44:26 >> pos class weight: 26.5229
25/01/2026 09:44:26 >> % pos class in train, val, test splits: [0.0363, 0.0413, 0.0377]
25/01/2026 09:44:26 >> # static features: 5
25/01/2026 09:44:27 >> # TS variables (MedBiVT): 34
25/01/2026 09:44:30 >> # timesteps (MedBiVT): 61

25/01/2026 09:45:19 >> ============================================================
25/01/2026 09:45:19 >> Initializing ours1 model...
25/01/2026 09:45:19 >> ============================================================

25/01/2026 09:45:19 >> Model details:
25/01/2026 09:45:19 >> # parameters: 835623
25/01/2026 09:45:19 >> # trainable parameters: 835623, 100.00%
25/01/2026 09:45:19 >> #params by dtype:
25/01/2026 09:45:19 >> torch.float32: 835623, 100.00%

25/01/2026 09:45:20 >> No. of training batches per epoch = 772

25/01/2026 09:45:20 >> ============================================================
25/01/2026 09:45:20 >>                Starting training...
25/01/2026 09:45:20 >> ============================================================
25/01/2026 09:45:20 >> >>> Epoch 1/20
25/01/2026 09:46:15 >> Epoch 1 completed | Avg Loss: 2.8883
25/01/2026 09:46:18 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8521 | AUPRC: 0.4050 | MinRP: 0.3875
25/01/2026 09:46:22 >> VAL          Epoch:     1 | AUROC: 0.8559 | AUPRC: 0.4150 | MinRP: 0.4475
25/01/2026 09:46:22 >> AUPRC improved: 0.0000 ---> 0.4150 (+0.4150)
25/01/2026 09:46:22 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 09:46:22 >> ============================================================
25/01/2026 09:46:22 >> >>> Epoch 2/20
25/01/2026 09:47:15 >> Epoch 2 completed | Avg Loss: 2.8886
25/01/2026 09:47:16 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8571 | AUPRC: 0.4003 | MinRP: 0.4125
25/01/2026 09:47:21 >> VAL          Epoch:     2 | AUROC: 0.8643 | AUPRC: 0.4301 | MinRP: 0.4353
25/01/2026 09:47:21 >> AUPRC improved: 0.4150 ---> 0.4301 (+0.0152)
25/01/2026 09:47:21 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 09:47:21 >> ============================================================
25/01/2026 09:47:21 >> >>> Epoch 3/20
25/01/2026 09:48:13 >> Epoch 3 completed | Avg Loss: 2.7080
25/01/2026 09:48:15 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8759 | AUPRC: 0.4743 | MinRP: 0.4250
25/01/2026 09:48:19 >> VAL          Epoch:     3 | AUROC: 0.8711 | AUPRC: 0.4915 | MinRP: 0.4745
25/01/2026 09:48:19 >> AUPRC improved: 0.4301 ---> 0.4915 (+0.0614)
25/01/2026 09:48:19 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 09:48:19 >> ============================================================
25/01/2026 09:48:19 >> >>> Epoch 4/20
25/01/2026 09:49:12 >> Epoch 4 completed | Avg Loss: 2.9038
25/01/2026 09:49:14 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8674 | AUPRC: 0.4482 | MinRP: 0.4125
25/01/2026 09:49:18 >> VAL          Epoch:     4 | AUROC: 0.8666 | AUPRC: 0.4815 | MinRP: 0.4669
25/01/2026 09:49:18 >> No improvement. Wait: 4/5
25/01/2026 09:49:18 >> ============================================================
25/01/2026 09:49:18 >> >>> Epoch 5/20
25/01/2026 09:50:11 >> Epoch 5 completed | Avg Loss: 2.8310
25/01/2026 09:50:13 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8795 | AUPRC: 0.4941 | MinRP: 0.4750
25/01/2026 09:50:17 >> VAL          Epoch:     5 | AUROC: 0.8731 | AUPRC: 0.4897 | MinRP: 0.4980
25/01/2026 09:50:17 >> No improvement. Wait: 3/5
25/01/2026 09:50:17 >> ============================================================
25/01/2026 09:50:17 >> >>> Epoch 6/20
25/01/2026 09:51:09 >> Epoch 6 completed | Avg Loss: 2.9083
25/01/2026 09:51:11 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8674 | AUPRC: 0.4860 | MinRP: 0.4268
25/01/2026 09:51:15 >> VAL          Epoch:     6 | AUROC: 0.8761 | AUPRC: 0.5056 | MinRP: 0.4784
25/01/2026 09:51:15 >> AUPRC improved: 0.4915 ---> 0.5056 (+0.0141)
25/01/2026 09:51:15 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 09:51:15 >> ============================================================
25/01/2026 09:51:15 >> >>> Epoch 7/20
25/01/2026 09:52:07 >> Epoch 7 completed | Avg Loss: 2.9708
25/01/2026 09:52:09 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8894 | AUPRC: 0.4992 | MinRP: 0.4375
25/01/2026 09:52:13 >> VAL          Epoch:     7 | AUROC: 0.8710 | AUPRC: 0.5223 | MinRP: 0.5098
25/01/2026 09:52:13 >> AUPRC improved: 0.5056 ---> 0.5223 (+0.0166)
25/01/2026 09:52:13 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 09:52:13 >> ============================================================
25/01/2026 09:52:13 >> >>> Epoch 8/20
25/01/2026 09:53:06 >> Epoch 8 completed | Avg Loss: 2.8740
25/01/2026 09:53:08 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8860 | AUPRC: 0.5146 | MinRP: 0.4875
25/01/2026 09:53:12 >> VAL          Epoch:     8 | AUROC: 0.8769 | AUPRC: 0.5112 | MinRP: 0.5097
25/01/2026 09:53:12 >> No improvement. Wait: 4/5
25/01/2026 09:53:12 >> ============================================================
25/01/2026 09:53:12 >> >>> Epoch 9/20
25/01/2026 09:54:04 >> Epoch 9 completed | Avg Loss: 3.1855
25/01/2026 09:54:05 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8810 | AUPRC: 0.5014 | MinRP: 0.4524
25/01/2026 09:54:10 >> VAL          Epoch:     9 | AUROC: 0.8744 | AUPRC: 0.5209 | MinRP: 0.4980
25/01/2026 09:54:10 >> No improvement. Wait: 3/5
25/01/2026 09:54:10 >> ============================================================
25/01/2026 09:54:10 >> >>> Epoch 10/20
25/01/2026 09:55:03 >> Epoch 10 completed | Avg Loss: 3.1539
25/01/2026 09:55:04 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8957 | AUPRC: 0.5214 | MinRP: 0.4500
25/01/2026 09:55:08 >> VAL          Epoch:    10 | AUROC: 0.8691 | AUPRC: 0.4950 | MinRP: 0.4980
25/01/2026 09:55:08 >> No improvement. Wait: 2/5
25/01/2026 09:55:08 >> ============================================================
25/01/2026 09:55:08 >> >>> Epoch 11/20
25/01/2026 09:56:02 >> Epoch 11 completed | Avg Loss: 2.9819
25/01/2026 09:56:03 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8946 | AUPRC: 0.5153 | MinRP: 0.4750
25/01/2026 09:56:07 >> VAL          Epoch:    11 | AUROC: 0.8808 | AUPRC: 0.5044 | MinRP: 0.4863
25/01/2026 09:56:07 >> No improvement. Wait: 1/5
25/01/2026 09:56:07 >> ============================================================
25/01/2026 09:56:07 >> >>> Epoch 12/20
25/01/2026 09:57:00 >> Epoch 12 completed | Avg Loss: 2.8051
25/01/2026 09:57:01 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9013 | AUPRC: 0.5331 | MinRP: 0.4625
25/01/2026 09:57:06 >> VAL          Epoch:    12 | AUROC: 0.8856 | AUPRC: 0.5314 | MinRP: 0.5098
25/01/2026 09:57:06 >> AUPRC improved: 0.5223 ---> 0.5314 (+0.0091)
25/01/2026 09:57:06 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 09:57:06 >> ============================================================
25/01/2026 09:57:06 >> >>> Epoch 13/20
25/01/2026 09:57:59 >> Epoch 13 completed | Avg Loss: 3.1622
25/01/2026 09:58:00 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8831 | AUPRC: 0.5258 | MinRP: 0.4762
25/01/2026 09:58:05 >> VAL          Epoch:    13 | AUROC: 0.8864 | AUPRC: 0.5322 | MinRP: 0.5098
25/01/2026 09:58:05 >> AUPRC improved: 0.5314 ---> 0.5322 (+0.0008)
25/01/2026 09:58:05 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 09:58:05 >> ============================================================
25/01/2026 09:58:05 >> >>> Epoch 14/20
25/01/2026 09:58:58 >> Epoch 14 completed | Avg Loss: 2.9712
25/01/2026 09:58:59 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9071 | AUPRC: 0.5404 | MinRP: 0.4940
25/01/2026 09:59:04 >> VAL          Epoch:    14 | AUROC: 0.8929 | AUPRC: 0.5330 | MinRP: 0.5333
25/01/2026 09:59:04 >> AUPRC improved: 0.5322 ---> 0.5330 (+0.0008)
25/01/2026 09:59:04 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 09:59:04 >> ============================================================
25/01/2026 09:59:04 >> >>> Epoch 15/20
25/01/2026 09:59:56 >> Epoch 15 completed | Avg Loss: 3.0454
25/01/2026 09:59:58 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9076 | AUPRC: 0.5457 | MinRP: 0.4875
25/01/2026 10:00:02 >> VAL          Epoch:    15 | AUROC: 0.8856 | AUPRC: 0.5298 | MinRP: 0.5373
25/01/2026 10:00:02 >> No improvement. Wait: 4/5
25/01/2026 10:00:02 >> ============================================================
25/01/2026 10:00:02 >> >>> Epoch 16/20
25/01/2026 10:00:55 >> Epoch 16 completed | Avg Loss: 3.0537
25/01/2026 10:00:56 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9105 | AUPRC: 0.5660 | MinRP: 0.5000
25/01/2026 10:01:00 >> VAL          Epoch:    16 | AUROC: 0.8859 | AUPRC: 0.5439 | MinRP: 0.5137
25/01/2026 10:01:00 >> AUPRC improved: 0.5330 ---> 0.5439 (+0.0109)
25/01/2026 10:01:00 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 10:01:00 >> ============================================================
25/01/2026 10:01:00 >> >>> Epoch 17/20
25/01/2026 10:01:53 >> Epoch 17 completed | Avg Loss: 2.9807
25/01/2026 10:01:54 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.8991 | AUPRC: 0.5333 | MinRP: 0.4750
25/01/2026 10:01:58 >> VAL          Epoch:    17 | AUROC: 0.8855 | AUPRC: 0.5255 | MinRP: 0.5020
25/01/2026 10:01:58 >> No improvement. Wait: 4/5
25/01/2026 10:01:58 >> ============================================================
25/01/2026 10:01:58 >> >>> Epoch 18/20
25/01/2026 10:02:51 >> Epoch 18 completed | Avg Loss: 3.3293
25/01/2026 10:02:52 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9136 | AUPRC: 0.5264 | MinRP: 0.4500
25/01/2026 10:02:56 >> VAL          Epoch:    18 | AUROC: 0.8861 | AUPRC: 0.5263 | MinRP: 0.5059
25/01/2026 10:02:56 >> No improvement. Wait: 3/5
25/01/2026 10:02:56 >> ============================================================
25/01/2026 10:02:56 >> >>> Epoch 19/20
25/01/2026 10:03:49 >> Epoch 19 completed | Avg Loss: 2.8569
25/01/2026 10:03:50 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9106 | AUPRC: 0.5682 | MinRP: 0.5000
25/01/2026 10:03:54 >> VAL          Epoch:    19 | AUROC: 0.8835 | AUPRC: 0.5411 | MinRP: 0.5115
25/01/2026 10:03:54 >> No improvement. Wait: 2/5
25/01/2026 10:03:54 >> ============================================================
25/01/2026 10:03:54 >> >>> Epoch 20/20
25/01/2026 10:04:47 >> Epoch 20 completed | Avg Loss: 3.0830
25/01/2026 10:04:48 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.9199 | AUPRC: 0.5932 | MinRP: 0.5125
25/01/2026 10:04:52 >> VAL          Epoch:    20 | AUROC: 0.8872 | AUPRC: 0.5500 | MinRP: 0.5176
25/01/2026 10:04:52 >> AUPRC improved: 0.5439 ---> 0.5500 (+0.0061)
25/01/2026 10:04:52 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 10:04:52 >> ============================================================

25/01/2026 10:04:52 >> ============================================================
25/01/2026 10:04:52 >> TRAINING COMPLETED
25/01/2026 10:04:52 >> ============================================================
25/01/2026 10:04:52 >> Best Validation Results:
25/01/2026 10:04:52 >>   AUROC: 0.8872 | AUPRC: 0.5500 | MinRP: 0.5176
25/01/2026 10:04:52 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:4/checkpoint_best.bin
25/01/2026 10:04:52 >> Evaluating on test set...
25/01/2026 10:04:58 >> TEST         AUROC: 0.8809 | AUPRC: 0.4851 | MinRP: 0.4623 | Accuracy: 0.9519

25/01/2026 10:04:58 >> ============================================================
25/01/2026 10:04:58 >> Classification Report:
25/01/2026 10:04:58 >>               precision    recall  f1-score   support
25/01/2026 10:04:58 >> 
25/01/2026 10:04:58 >>          0.0     0.9801    0.9697    0.9749      7424
25/01/2026 10:04:58 >>          1.0     0.3919    0.4983    0.4387       291
25/01/2026 10:04:58 >> 
25/01/2026 10:04:58 >>     accuracy                         0.9519      7715
25/01/2026 10:04:58 >>    macro avg     0.6860    0.7340    0.7068      7715
25/01/2026 10:04:58 >> weighted avg     0.9579    0.9519    0.9547      7715
25/01/2026 10:04:58 >> 
25/01/2026 10:04:58 >> Confusion Matrix:
25/01/2026 10:04:58 >> [7199, 225]
25/01/2026 10:04:58 >> [146, 145]
25/01/2026 10:04:58 >> ============================================================
25/01/2026 10:04:58 >> ============================================================
25/01/2026 10:04:58 >> Final Test Results:
25/01/2026 10:04:58 >>   AUROC: 0.8809 | AUPRC: 0.4851 | MinRP: 0.4623 | Accuracy: 0.9519
25/01/2026 10:04:58 >> ============================================================
