06/02/2026 10:22:11 >> Namespace(dataset='physionet_2019', model_type='dbvt', split_file='physionet_2019_5fold.json', fold=2, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2019/dbvt|fold:2', lr=0.0005, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.5, max_obs=880, max_timesteps=880, device='cuda:2', seed=2026, gru_hid_dim=256, gru_dropout=0.4, transformer_hid_dim=64, transformer_num_layers=4, transformer_num_heads=4, transformer_dropout=0.15, fusion_hid_dim=256, fusion_dropout=0.2, lambda_aux=0.5, lambda_cos=1.0, logger=<utils.logger.Logger object at 0x77e21e506140>)

06/02/2026 10:22:11 >> Preparing dataset physionet_2019
06/02/2026 10:22:12 >> Using fold 2/5
06/02/2026 10:22:12 >> Loaded splits from physionet_2019_5fold.json
06/02/2026 10:22:14 >> # train, val, test TS: [24688, 6172, 7715]
06/02/2026 10:22:14 >> pos class weight: 24.6366
06/02/2026 10:22:14 >> % pos class in train, val, test splits: [0.0390, 0.0381, 0.0318]
06/02/2026 10:22:15 >> # static features: 5
06/02/2026 10:22:15 >> # TS variables (DBVT): 34
06/02/2026 10:22:18 >> # timesteps (DBVT): 61

06/02/2026 10:23:14 >> Model details:
06/02/2026 10:23:14 >> # parameters: 835623
06/02/2026 10:23:14 >> # trainable parameters: 835623, 100.0%
06/02/2026 10:23:14 >> #params by dtype:
06/02/2026 10:23:14 >> torch.float32: 835623, 100.0%

06/02/2026 10:23:14 >> No. of training batches per epoch = 772

06/02/2026 10:23:14 >> ============================================================
06/02/2026 10:23:14 >>                Starting training...
06/02/2026 10:23:14 >> ============================================================
06/02/2026 10:23:14 >> >>> Epoch 1/20
06/02/2026 10:24:30 >> Epoch 1 completed | Avg Loss: 3.0181
06/02/2026 10:24:33 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8643 | AUPRC: 0.3617 | MinRP: 0.3924
06/02/2026 10:24:39 >> VAL          Epoch:     1 | AUROC: 0.8136 | AUPRC: 0.3622 | MinRP: 0.3898
06/02/2026 10:24:39 >> AUPRC improved: 0.0000 ---> 0.3622 (+0.3622)
06/02/2026 10:24:39 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:2/checkpoint_best.bin
06/02/2026 10:24:40 >> ============================================================
06/02/2026 10:24:40 >> >>> Epoch 2/20
06/02/2026 10:25:52 >> Epoch 2 completed | Avg Loss: 2.8606
06/02/2026 10:25:54 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8887 | AUPRC: 0.4274 | MinRP: 0.4595
06/02/2026 10:26:01 >> VAL          Epoch:     2 | AUROC: 0.8133 | AUPRC: 0.4165 | MinRP: 0.4262
06/02/2026 10:26:01 >> AUPRC improved: 0.3622 ---> 0.4165 (+0.0543)
06/02/2026 10:26:01 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:2/checkpoint_best.bin
06/02/2026 10:26:01 >> ============================================================
06/02/2026 10:26:01 >> >>> Epoch 3/20
06/02/2026 10:27:13 >> Epoch 3 completed | Avg Loss: 2.8686
06/02/2026 10:27:15 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.9036 | AUPRC: 0.4712 | MinRP: 0.5135
06/02/2026 10:27:22 >> VAL          Epoch:     3 | AUROC: 0.8331 | AUPRC: 0.4105 | MinRP: 0.4128
06/02/2026 10:27:22 >> No improvement. Wait: 4/5
06/02/2026 10:27:22 >> ============================================================
06/02/2026 10:27:22 >> >>> Epoch 4/20
06/02/2026 10:28:26 >> Epoch 4 completed | Avg Loss: 2.8124
06/02/2026 10:28:28 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8967 | AUPRC: 0.4294 | MinRP: 0.3947
06/02/2026 10:28:32 >> VAL          Epoch:     4 | AUROC: 0.8297 | AUPRC: 0.3966 | MinRP: 0.3824
06/02/2026 10:28:32 >> No improvement. Wait: 3/5
06/02/2026 10:28:32 >> ============================================================
06/02/2026 10:28:32 >> >>> Epoch 5/20
06/02/2026 10:29:24 >> Epoch 5 completed | Avg Loss: 2.8690
06/02/2026 10:29:25 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.9114 | AUPRC: 0.4891 | MinRP: 0.4800
06/02/2026 10:29:30 >> VAL          Epoch:     5 | AUROC: 0.8353 | AUPRC: 0.4264 | MinRP: 0.4383
06/02/2026 10:29:30 >> AUPRC improved: 0.4165 ---> 0.4264 (+0.0099)
06/02/2026 10:29:30 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:2/checkpoint_best.bin
06/02/2026 10:29:30 >> ============================================================
06/02/2026 10:29:30 >> >>> Epoch 6/20
06/02/2026 10:30:20 >> Epoch 6 completed | Avg Loss: 2.8094
06/02/2026 10:30:22 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9107 | AUPRC: 0.5120 | MinRP: 0.4875
06/02/2026 10:30:26 >> VAL          Epoch:     6 | AUROC: 0.8387 | AUPRC: 0.4327 | MinRP: 0.4298
06/02/2026 10:30:26 >> AUPRC improved: 0.4264 ---> 0.4327 (+0.0064)
06/02/2026 10:30:26 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:2/checkpoint_best.bin
06/02/2026 10:30:26 >> ============================================================
06/02/2026 10:30:26 >> >>> Epoch 7/20
06/02/2026 10:31:17 >> Epoch 7 completed | Avg Loss: 2.9182
06/02/2026 10:31:18 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9210 | AUPRC: 0.5215 | MinRP: 0.4935
06/02/2026 10:31:23 >> VAL          Epoch:     7 | AUROC: 0.8453 | AUPRC: 0.4336 | MinRP: 0.4280
06/02/2026 10:31:23 >> AUPRC improved: 0.4327 ---> 0.4336 (+0.0009)
06/02/2026 10:31:23 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:2/checkpoint_best.bin
06/02/2026 10:31:23 >> ============================================================
06/02/2026 10:31:23 >> >>> Epoch 8/20
06/02/2026 10:32:13 >> Epoch 8 completed | Avg Loss: 2.6932
06/02/2026 10:32:15 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9202 | AUPRC: 0.5113 | MinRP: 0.5000
06/02/2026 10:32:19 >> VAL          Epoch:     8 | AUROC: 0.8436 | AUPRC: 0.4321 | MinRP: 0.4340
06/02/2026 10:32:19 >> No improvement. Wait: 4/5
06/02/2026 10:32:19 >> ============================================================
06/02/2026 10:32:19 >> >>> Epoch 9/20
06/02/2026 10:33:11 >> Epoch 9 completed | Avg Loss: 2.8833
06/02/2026 10:33:12 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9114 | AUPRC: 0.5006 | MinRP: 0.4865
06/02/2026 10:33:16 >> VAL          Epoch:     9 | AUROC: 0.8493 | AUPRC: 0.4399 | MinRP: 0.4383
06/02/2026 10:33:16 >> AUPRC improved: 0.4336 ---> 0.4399 (+0.0063)
06/02/2026 10:33:16 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:2/checkpoint_best.bin
06/02/2026 10:33:16 >> ============================================================
06/02/2026 10:33:16 >> >>> Epoch 10/20
06/02/2026 10:34:06 >> Epoch 10 completed | Avg Loss: 2.8496
06/02/2026 10:34:08 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9161 | AUPRC: 0.5214 | MinRP: 0.4730
06/02/2026 10:34:12 >> VAL          Epoch:    10 | AUROC: 0.8474 | AUPRC: 0.4274 | MinRP: 0.4468
06/02/2026 10:34:12 >> No improvement. Wait: 4/5
06/02/2026 10:34:12 >> ============================================================
06/02/2026 10:34:12 >> >>> Epoch 11/20
06/02/2026 10:35:03 >> Epoch 11 completed | Avg Loss: 2.9832
06/02/2026 10:35:05 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9228 | AUPRC: 0.5313 | MinRP: 0.5000
06/02/2026 10:35:09 >> VAL          Epoch:    11 | AUROC: 0.8583 | AUPRC: 0.4481 | MinRP: 0.4346
06/02/2026 10:35:09 >> AUPRC improved: 0.4399 ---> 0.4481 (+0.0082)
06/02/2026 10:35:09 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:2/checkpoint_best.bin
06/02/2026 10:35:10 >> ============================================================
06/02/2026 10:35:10 >> >>> Epoch 12/20
06/02/2026 10:36:01 >> Epoch 12 completed | Avg Loss: 2.6761
06/02/2026 10:36:02 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9228 | AUPRC: 0.5453 | MinRP: 0.5405
06/02/2026 10:36:07 >> VAL          Epoch:    12 | AUROC: 0.8536 | AUPRC: 0.4423 | MinRP: 0.4468
06/02/2026 10:36:07 >> No improvement. Wait: 4/5
06/02/2026 10:36:07 >> ============================================================
06/02/2026 10:36:07 >> >>> Epoch 13/20
06/02/2026 10:36:57 >> Epoch 13 completed | Avg Loss: 2.9056
06/02/2026 10:36:58 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9235 | AUPRC: 0.5446 | MinRP: 0.5135
06/02/2026 10:37:03 >> VAL          Epoch:    13 | AUROC: 0.8444 | AUPRC: 0.4522 | MinRP: 0.4351
06/02/2026 10:37:03 >> AUPRC improved: 0.4481 ---> 0.4522 (+0.0040)
06/02/2026 10:37:03 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:2/checkpoint_best.bin
06/02/2026 10:37:03 >> ============================================================
06/02/2026 10:37:03 >> >>> Epoch 14/20
06/02/2026 10:37:52 >> Epoch 14 completed | Avg Loss: 2.8338
06/02/2026 10:37:54 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9329 | AUPRC: 0.5478 | MinRP: 0.4865
06/02/2026 10:37:58 >> VAL          Epoch:    14 | AUROC: 0.8598 | AUPRC: 0.4465 | MinRP: 0.4153
06/02/2026 10:37:58 >> No improvement. Wait: 4/5
06/02/2026 10:37:58 >> ============================================================
06/02/2026 10:37:58 >> >>> Epoch 15/20
06/02/2026 10:38:47 >> Epoch 15 completed | Avg Loss: 2.8554
06/02/2026 10:38:48 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9295 | AUPRC: 0.5571 | MinRP: 0.5405
06/02/2026 10:38:52 >> VAL          Epoch:    15 | AUROC: 0.8557 | AUPRC: 0.4282 | MinRP: 0.4213
06/02/2026 10:38:52 >> No improvement. Wait: 3/5
06/02/2026 10:38:52 >> ============================================================
06/02/2026 10:38:52 >> >>> Epoch 16/20
06/02/2026 10:39:41 >> Epoch 16 completed | Avg Loss: 2.9096
06/02/2026 10:39:43 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9325 | AUPRC: 0.5674 | MinRP: 0.5405
06/02/2026 10:39:47 >> VAL          Epoch:    16 | AUROC: 0.8553 | AUPRC: 0.4395 | MinRP: 0.4255
06/02/2026 10:39:47 >> No improvement. Wait: 2/5
06/02/2026 10:39:47 >> ============================================================
06/02/2026 10:39:47 >> >>> Epoch 17/20
06/02/2026 10:40:36 >> Epoch 17 completed | Avg Loss: 2.7988
06/02/2026 10:40:37 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9476 | AUPRC: 0.5797 | MinRP: 0.5000
06/02/2026 10:40:41 >> VAL          Epoch:    17 | AUROC: 0.8586 | AUPRC: 0.4587 | MinRP: 0.4426
06/02/2026 10:40:41 >> AUPRC improved: 0.4522 ---> 0.4587 (+0.0066)
06/02/2026 10:40:41 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:2/checkpoint_best.bin
06/02/2026 10:40:41 >> ============================================================
06/02/2026 10:40:41 >> >>> Epoch 18/20
