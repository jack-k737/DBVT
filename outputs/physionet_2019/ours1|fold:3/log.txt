25/01/2026 09:44:23 >> Namespace(dataset='physionet_2019', model='ours1', split_file='physionet_2019_5fold.json', fold=3, root_dir='/home/xiejun/codeLib/miccai', output_dir='/home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:3', lr=0.0005, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:1', seed=2026, gru_hid_dim=256, gru_dropout=0.4, transformer_hid_dim=64, transformer_num_layers=4, transformer_num_heads=4, transformer_dropout=0.15, fusion_hid_dim=256, fusion_dropout=0.2, lambda_aux=0.5, lambda_cos=1.0, logger=<utils.logger.Logger object at 0x7a5299b06140>)

25/01/2026 09:44:23 >> ============================================================
25/01/2026 09:44:23 >> Loading dataset...
25/01/2026 09:44:23 >> ============================================================

25/01/2026 09:44:23 >> Preparing dataset physionet_2019
25/01/2026 09:44:23 >> Using fold 3/5
25/01/2026 09:44:23 >> Loaded splits from physionet_2019_5fold.json
25/01/2026 09:44:25 >> # train, val, test TS: [24688, 6172, 7715]
25/01/2026 09:44:26 >> pos class weight: 26.4616
25/01/2026 09:44:26 >> % pos class in train, val, test splits: [0.0364, 0.0382, 0.0399]
25/01/2026 09:44:26 >> # static features: 5
25/01/2026 09:44:27 >> # TS variables (MedBiVT): 34
25/01/2026 09:44:30 >> # timesteps (MedBiVT): 61

25/01/2026 09:45:20 >> ============================================================
25/01/2026 09:45:20 >> Initializing ours1 model...
25/01/2026 09:45:20 >> ============================================================

25/01/2026 09:45:20 >> Model details:
25/01/2026 09:45:20 >> # parameters: 835623
25/01/2026 09:45:20 >> # trainable parameters: 835623, 100.00%
25/01/2026 09:45:20 >> #params by dtype:
25/01/2026 09:45:20 >> torch.float32: 835623, 100.00%

25/01/2026 09:45:21 >> No. of training batches per epoch = 772

25/01/2026 09:45:21 >> ============================================================
25/01/2026 09:45:21 >>                Starting training...
25/01/2026 09:45:21 >> ============================================================
25/01/2026 09:45:21 >> >>> Epoch 1/20
25/01/2026 09:46:41 >> Epoch 1 completed | Avg Loss: 3.0322
25/01/2026 09:46:44 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8292 | AUPRC: 0.4290 | MinRP: 0.4143
25/01/2026 09:46:51 >> VAL          Epoch:     1 | AUROC: 0.8631 | AUPRC: 0.4672 | MinRP: 0.4831
25/01/2026 09:46:51 >> AUPRC improved: 0.0000 ---> 0.4672 (+0.4672)
25/01/2026 09:46:51 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:3/checkpoint_best.bin
25/01/2026 09:46:51 >> ============================================================
25/01/2026 09:46:51 >> >>> Epoch 2/20
25/01/2026 09:48:09 >> Epoch 2 completed | Avg Loss: 2.9478
25/01/2026 09:48:12 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8275 | AUPRC: 0.4330 | MinRP: 0.4286
25/01/2026 09:48:20 >> VAL          Epoch:     2 | AUROC: 0.8812 | AUPRC: 0.4804 | MinRP: 0.4641
25/01/2026 09:48:20 >> AUPRC improved: 0.4672 ---> 0.4804 (+0.0132)
25/01/2026 09:48:20 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:3/checkpoint_best.bin
25/01/2026 09:48:20 >> ============================================================
25/01/2026 09:48:20 >> >>> Epoch 3/20
25/01/2026 09:49:37 >> Epoch 3 completed | Avg Loss: 3.0285
25/01/2026 09:49:39 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8370 | AUPRC: 0.4291 | MinRP: 0.4127
25/01/2026 09:49:47 >> VAL          Epoch:     3 | AUROC: 0.8834 | AUPRC: 0.4937 | MinRP: 0.4703
25/01/2026 09:49:47 >> AUPRC improved: 0.4804 ---> 0.4937 (+0.0133)
25/01/2026 09:49:47 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:3/checkpoint_best.bin
25/01/2026 09:49:47 >> ============================================================
25/01/2026 09:49:47 >> >>> Epoch 4/20
25/01/2026 09:51:04 >> Epoch 4 completed | Avg Loss: 2.8615
25/01/2026 09:51:07 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8506 | AUPRC: 0.4393 | MinRP: 0.4603
25/01/2026 09:51:14 >> VAL          Epoch:     4 | AUROC: 0.8741 | AUPRC: 0.4839 | MinRP: 0.4580
25/01/2026 09:51:14 >> No improvement. Wait: 4/5
25/01/2026 09:51:14 >> ============================================================
25/01/2026 09:51:14 >> >>> Epoch 5/20
25/01/2026 09:52:31 >> Epoch 5 completed | Avg Loss: 3.1005
25/01/2026 09:52:34 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8497 | AUPRC: 0.4401 | MinRP: 0.4615
25/01/2026 09:52:41 >> VAL          Epoch:     5 | AUROC: 0.8847 | AUPRC: 0.5000 | MinRP: 0.4788
25/01/2026 09:52:41 >> AUPRC improved: 0.4937 ---> 0.5000 (+0.0064)
25/01/2026 09:52:41 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:3/checkpoint_best.bin
25/01/2026 09:52:41 >> ============================================================
25/01/2026 09:52:41 >> >>> Epoch 6/20
25/01/2026 09:53:58 >> Epoch 6 completed | Avg Loss: 2.7503
25/01/2026 09:54:01 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8586 | AUPRC: 0.4759 | MinRP: 0.4615
25/01/2026 09:54:08 >> VAL          Epoch:     6 | AUROC: 0.8930 | AUPRC: 0.5162 | MinRP: 0.4873
25/01/2026 09:54:08 >> AUPRC improved: 0.5000 ---> 0.5162 (+0.0162)
25/01/2026 09:54:08 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:3/checkpoint_best.bin
25/01/2026 09:54:08 >> ============================================================
25/01/2026 09:54:08 >> >>> Epoch 7/20
25/01/2026 09:55:26 >> Epoch 7 completed | Avg Loss: 2.7606
25/01/2026 09:55:28 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8558 | AUPRC: 0.4175 | MinRP: 0.4308
25/01/2026 09:55:35 >> VAL          Epoch:     7 | AUROC: 0.8868 | AUPRC: 0.4415 | MinRP: 0.4153
25/01/2026 09:55:35 >> No improvement. Wait: 4/5
25/01/2026 09:55:35 >> ============================================================
25/01/2026 09:55:35 >> >>> Epoch 8/20
25/01/2026 09:56:53 >> Epoch 8 completed | Avg Loss: 3.0731
25/01/2026 09:56:55 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8761 | AUPRC: 0.4749 | MinRP: 0.4844
25/01/2026 09:57:02 >> VAL          Epoch:     8 | AUROC: 0.8978 | AUPRC: 0.5179 | MinRP: 0.4788
25/01/2026 09:57:02 >> AUPRC improved: 0.5162 ---> 0.5179 (+0.0017)
25/01/2026 09:57:02 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:3/checkpoint_best.bin
25/01/2026 09:57:02 >> ============================================================
25/01/2026 09:57:02 >> >>> Epoch 9/20
25/01/2026 09:58:20 >> Epoch 9 completed | Avg Loss: 3.0200
25/01/2026 09:58:22 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8848 | AUPRC: 0.5057 | MinRP: 0.5079
25/01/2026 09:58:30 >> VAL          Epoch:     9 | AUROC: 0.8893 | AUPRC: 0.5339 | MinRP: 0.5169
25/01/2026 09:58:30 >> AUPRC improved: 0.5179 ---> 0.5339 (+0.0160)
25/01/2026 09:58:30 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:3/checkpoint_best.bin
25/01/2026 09:58:30 >> ============================================================
25/01/2026 09:58:30 >> >>> Epoch 10/20
25/01/2026 09:59:48 >> Epoch 10 completed | Avg Loss: 3.0508
25/01/2026 09:59:50 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8777 | AUPRC: 0.4968 | MinRP: 0.4762
25/01/2026 09:59:58 >> VAL          Epoch:    10 | AUROC: 0.8885 | AUPRC: 0.5014 | MinRP: 0.4788
25/01/2026 09:59:58 >> No improvement. Wait: 4/5
25/01/2026 09:59:58 >> ============================================================
25/01/2026 09:59:58 >> >>> Epoch 11/20
25/01/2026 10:01:16 >> Epoch 11 completed | Avg Loss: 2.9229
25/01/2026 10:01:18 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8670 | AUPRC: 0.4755 | MinRP: 0.4615
25/01/2026 10:01:26 >> VAL          Epoch:    11 | AUROC: 0.8842 | AUPRC: 0.4888 | MinRP: 0.4619
25/01/2026 10:01:26 >> No improvement. Wait: 3/5
25/01/2026 10:01:26 >> ============================================================
25/01/2026 10:01:26 >> >>> Epoch 12/20
25/01/2026 10:02:44 >> Epoch 12 completed | Avg Loss: 2.8995
25/01/2026 10:02:47 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8871 | AUPRC: 0.5128 | MinRP: 0.5079
25/01/2026 10:02:54 >> VAL          Epoch:    12 | AUROC: 0.8883 | AUPRC: 0.5297 | MinRP: 0.5021
25/01/2026 10:02:54 >> No improvement. Wait: 2/5
25/01/2026 10:02:54 >> ============================================================
25/01/2026 10:02:54 >> >>> Epoch 13/20
25/01/2026 10:04:12 >> Epoch 13 completed | Avg Loss: 3.1160
25/01/2026 10:04:14 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8883 | AUPRC: 0.5124 | MinRP: 0.4921
25/01/2026 10:04:22 >> VAL          Epoch:    13 | AUROC: 0.8864 | AUPRC: 0.5175 | MinRP: 0.5021
25/01/2026 10:04:22 >> No improvement. Wait: 1/5
25/01/2026 10:04:22 >> ============================================================
25/01/2026 10:04:22 >> >>> Epoch 14/20
25/01/2026 10:05:40 >> Epoch 14 completed | Avg Loss: 2.9782
25/01/2026 10:05:43 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8781 | AUPRC: 0.4679 | MinRP: 0.4444
25/01/2026 10:05:50 >> VAL          Epoch:    14 | AUROC: 0.8893 | AUPRC: 0.4917 | MinRP: 0.4915
25/01/2026 10:05:50 >> No improvement. Wait: 0/5
25/01/2026 10:05:50 >> Patience reached. Early stopping.

25/01/2026 10:05:50 >> ============================================================
25/01/2026 10:05:50 >> TRAINING COMPLETED
25/01/2026 10:05:50 >> ============================================================
25/01/2026 10:05:50 >> Best Validation Results:
25/01/2026 10:05:50 >>   AUROC: 0.8893 | AUPRC: 0.5339 | MinRP: 0.5169
25/01/2026 10:05:50 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2019/ours1|fold:3/checkpoint_best.bin
25/01/2026 10:05:50 >> Evaluating on test set...
25/01/2026 10:05:59 >> TEST         AUROC: 0.8596 | AUPRC: 0.4695 | MinRP: 0.4693 | Accuracy: 0.9655

25/01/2026 10:05:59 >> ============================================================
25/01/2026 10:05:59 >> Classification Report:
25/01/2026 10:05:59 >>               precision    recall  f1-score   support
25/01/2026 10:05:59 >> 
25/01/2026 10:05:59 >>          0.0     0.9746    0.9899    0.9822      7407
25/01/2026 10:05:59 >>          1.0     0.6094    0.3799    0.4680       308
25/01/2026 10:05:59 >> 
25/01/2026 10:05:59 >>     accuracy                         0.9655      7715
25/01/2026 10:05:59 >>    macro avg     0.7920    0.6849    0.7251      7715
25/01/2026 10:05:59 >> weighted avg     0.9600    0.9655    0.9617      7715
25/01/2026 10:05:59 >> 
25/01/2026 10:05:59 >> Confusion Matrix:
25/01/2026 10:05:59 >> [7332, 75]
25/01/2026 10:05:59 >> [191, 117]
25/01/2026 10:05:59 >> ============================================================
25/01/2026 10:05:59 >> ============================================================
25/01/2026 10:05:59 >> Final Test Results:
25/01/2026 10:05:59 >>   AUROC: 0.8596 | AUPRC: 0.4695 | MinRP: 0.4693 | Accuracy: 0.9655
25/01/2026 10:05:59 >> ============================================================
