07/02/2026 20:42:38 >> Namespace(dataset='physionet_2019', model_type='dbvt', split_file='physionet_2019_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2019/dbvt|fold:1', lr=0.0005, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:1', seed=2026, gru_hid_dim=256, gru_dropout=0.4, transformer_hid_dim=64, transformer_num_layers=4, transformer_num_heads=4, transformer_dropout=0.15, fusion_hid_dim=256, fusion_dropout=0.2, lambda_aux=0.5, lambda_cos=1.0, logger=<utils.logger.Logger object at 0x7917e16a7760>)

07/02/2026 20:42:38 >> Preparing dataset physionet_2019
07/02/2026 20:42:38 >> Using fold 1/5
07/02/2026 20:42:38 >> Loaded splits from physionet_2019_5fold.json
07/02/2026 20:42:40 >> # train, val, test TS: [24688, 6172, 7715]
07/02/2026 20:42:41 >> pos class weight: 26.3703
07/02/2026 20:42:41 >> % pos class in train, val, test splits: [0.0365, 0.0405, 0.0377]
07/02/2026 20:42:44 >> # static features: 5
07/02/2026 20:42:44 >> # TS variables (DBVT): 34
07/02/2026 20:42:51 >> # timesteps (DBVT): 61

07/02/2026 20:43:44 >> Model details:
07/02/2026 20:43:44 >> # parameters: 835623
07/02/2026 20:43:44 >> # trainable parameters: 835623, 100.0%
07/02/2026 20:43:44 >> #params by dtype:
07/02/2026 20:43:44 >> torch.float32: 835623, 100.0%

07/02/2026 20:43:44 >> No. of training batches per epoch = 772

07/02/2026 20:43:44 >> ============================================================
07/02/2026 20:43:44 >>                Starting training...
07/02/2026 20:43:44 >> ============================================================
07/02/2026 20:43:44 >> >>> Epoch 1/20
07/02/2026 20:45:56 >> Epoch 1 completed | Avg Loss: 3.1783
07/02/2026 20:46:01 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.7820 | AUPRC: 0.3069 | MinRP: 0.3247
07/02/2026 20:46:13 >> VAL          Epoch:     1 | AUROC: 0.8237 | AUPRC: 0.3392 | MinRP: 0.3874
07/02/2026 20:46:13 >> AUPRC improved: 0.0000 ---> 0.3392 (+0.3392)
07/02/2026 20:46:13 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:46:13 >> ============================================================
07/02/2026 20:46:13 >> >>> Epoch 2/20
07/02/2026 20:48:23 >> Epoch 2 completed | Avg Loss: 3.0673
07/02/2026 20:48:27 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8391 | AUPRC: 0.4069 | MinRP: 0.4605
07/02/2026 20:48:39 >> VAL          Epoch:     2 | AUROC: 0.8591 | AUPRC: 0.4433 | MinRP: 0.4405
07/02/2026 20:48:39 >> AUPRC improved: 0.3392 ---> 0.4433 (+0.1040)
07/02/2026 20:48:39 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:48:39 >> ============================================================
07/02/2026 20:48:39 >> >>> Epoch 3/20
07/02/2026 20:50:48 >> Epoch 3 completed | Avg Loss: 2.9715
07/02/2026 20:50:52 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8672 | AUPRC: 0.4540 | MinRP: 0.4605
07/02/2026 20:51:04 >> VAL          Epoch:     3 | AUROC: 0.8591 | AUPRC: 0.4458 | MinRP: 0.4462
07/02/2026 20:51:04 >> AUPRC improved: 0.4433 ---> 0.4458 (+0.0025)
07/02/2026 20:51:04 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:51:04 >> ============================================================
07/02/2026 20:51:04 >> >>> Epoch 4/20
07/02/2026 20:53:13 >> Epoch 4 completed | Avg Loss: 3.0720
07/02/2026 20:53:17 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8563 | AUPRC: 0.4478 | MinRP: 0.4342
07/02/2026 20:53:29 >> VAL          Epoch:     4 | AUROC: 0.8690 | AUPRC: 0.4747 | MinRP: 0.4680
07/02/2026 20:53:29 >> AUPRC improved: 0.4458 ---> 0.4747 (+0.0289)
07/02/2026 20:53:29 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:53:29 >> ============================================================
07/02/2026 20:53:29 >> >>> Epoch 5/20
07/02/2026 20:55:38 >> Epoch 5 completed | Avg Loss: 3.2548
07/02/2026 20:55:42 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8539 | AUPRC: 0.4387 | MinRP: 0.4474
07/02/2026 20:55:54 >> VAL          Epoch:     5 | AUROC: 0.8620 | AUPRC: 0.4797 | MinRP: 0.4542
07/02/2026 20:55:54 >> AUPRC improved: 0.4747 ---> 0.4797 (+0.0050)
07/02/2026 20:55:54 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:55:54 >> ============================================================
07/02/2026 20:55:54 >> >>> Epoch 6/20
07/02/2026 20:58:01 >> Epoch 6 completed | Avg Loss: 2.9088
07/02/2026 20:58:04 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8697 | AUPRC: 0.4648 | MinRP: 0.4605
07/02/2026 20:58:12 >> VAL          Epoch:     6 | AUROC: 0.8668 | AUPRC: 0.4567 | MinRP: 0.4440
07/02/2026 20:58:12 >> No improvement. Wait: 4/5
07/02/2026 20:58:12 >> ============================================================
07/02/2026 20:58:12 >> >>> Epoch 7/20
07/02/2026 21:00:17 >> Epoch 7 completed | Avg Loss: 2.8761
07/02/2026 21:00:21 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8812 | AUPRC: 0.4957 | MinRP: 0.5132
07/02/2026 21:00:33 >> VAL          Epoch:     7 | AUROC: 0.8718 | AUPRC: 0.4936 | MinRP: 0.4760
07/02/2026 21:00:33 >> AUPRC improved: 0.4797 ---> 0.4936 (+0.0139)
07/02/2026 21:00:33 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:1/checkpoint_best.bin
07/02/2026 21:00:33 >> ============================================================
07/02/2026 21:00:33 >> >>> Epoch 8/20
07/02/2026 21:02:41 >> Epoch 8 completed | Avg Loss: 3.0052
07/02/2026 21:02:44 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8746 | AUPRC: 0.4758 | MinRP: 0.4872
07/02/2026 21:02:57 >> VAL          Epoch:     8 | AUROC: 0.8668 | AUPRC: 0.5038 | MinRP: 0.4729
07/02/2026 21:02:57 >> AUPRC improved: 0.4936 ---> 0.5038 (+0.0102)
07/02/2026 21:02:57 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:1/checkpoint_best.bin
07/02/2026 21:02:57 >> ============================================================
07/02/2026 21:02:57 >> >>> Epoch 9/20
07/02/2026 21:05:04 >> Epoch 9 completed | Avg Loss: 3.1911
07/02/2026 21:05:08 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8883 | AUPRC: 0.5053 | MinRP: 0.5325
07/02/2026 21:05:21 >> VAL          Epoch:     9 | AUROC: 0.8703 | AUPRC: 0.5078 | MinRP: 0.4781
07/02/2026 21:05:21 >> AUPRC improved: 0.5038 ---> 0.5078 (+0.0040)
07/02/2026 21:05:21 >> Saving checkpoint to ../outputs/physionet_2019/dbvt|fold:1/checkpoint_best.bin
07/02/2026 21:05:21 >> ============================================================
07/02/2026 21:05:21 >> >>> Epoch 10/20
07/02/2026 21:07:28 >> Epoch 10 completed | Avg Loss: 2.8751
07/02/2026 21:07:32 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8830 | AUPRC: 0.4988 | MinRP: 0.4737
07/02/2026 21:07:44 >> VAL          Epoch:    10 | AUROC: 0.8609 | AUPRC: 0.4824 | MinRP: 0.4840
07/02/2026 21:07:44 >> No improvement. Wait: 4/5
07/02/2026 21:07:44 >> ============================================================
07/02/2026 21:07:44 >> >>> Epoch 11/20
07/02/2026 21:09:51 >> Epoch 11 completed | Avg Loss: 2.8804
07/02/2026 21:09:55 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8863 | AUPRC: 0.5062 | MinRP: 0.4474
07/02/2026 21:10:06 >> VAL          Epoch:    11 | AUROC: 0.8650 | AUPRC: 0.4845 | MinRP: 0.4680
07/02/2026 21:10:06 >> No improvement. Wait: 3/5
07/02/2026 21:10:06 >> ============================================================
07/02/2026 21:10:06 >> >>> Epoch 12/20
07/02/2026 21:12:01 >> Epoch 12 completed | Avg Loss: 2.9281
07/02/2026 21:12:05 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8857 | AUPRC: 0.4922 | MinRP: 0.4737
07/02/2026 21:12:16 >> VAL          Epoch:    12 | AUROC: 0.8585 | AUPRC: 0.4868 | MinRP: 0.4680
07/02/2026 21:12:16 >> No improvement. Wait: 2/5
07/02/2026 21:12:16 >> ============================================================
07/02/2026 21:12:16 >> >>> Epoch 13/20
07/02/2026 21:14:16 >> Epoch 13 completed | Avg Loss: 2.7564
07/02/2026 21:14:19 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8990 | AUPRC: 0.5567 | MinRP: 0.5526
07/02/2026 21:14:28 >> VAL          Epoch:    13 | AUROC: 0.8710 | AUPRC: 0.4844 | MinRP: 0.4600
07/02/2026 21:14:28 >> No improvement. Wait: 1/5
07/02/2026 21:14:28 >> ============================================================
07/02/2026 21:14:28 >> >>> Epoch 14/20
07/02/2026 21:16:28 >> Epoch 14 completed | Avg Loss: 2.9809
07/02/2026 21:16:32 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9015 | AUPRC: 0.5697 | MinRP: 0.5395
07/02/2026 21:16:44 >> VAL          Epoch:    14 | AUROC: 0.8705 | AUPRC: 0.5013 | MinRP: 0.4764
07/02/2026 21:16:44 >> No improvement. Wait: 0/5
07/02/2026 21:16:44 >> Patience reached. Early stopping.

07/02/2026 21:16:44 >> ============================================================
07/02/2026 21:16:44 >> TRAINING COMPLETED
07/02/2026 21:16:44 >> ============================================================
07/02/2026 21:16:44 >> Best Validation Results:
07/02/2026 21:16:44 >>   AUROC: 0.8703 | AUPRC: 0.5078 | MinRP: 0.4781
07/02/2026 21:16:44 >> Loading best model from ../outputs/physionet_2019/dbvt|fold:1/checkpoint_best.bin
07/02/2026 21:16:45 >> Evaluating on test set...
07/02/2026 21:17:00 >> TEST         AUROC: 0.8996 | AUPRC: 0.5466 | MinRP: 0.5274 | Accuracy: 0.9484

07/02/2026 21:17:00 >> ============================================================
07/02/2026 21:17:00 >> Classification Report:
07/02/2026 21:17:00 >>               precision    recall  f1-score   support
07/02/2026 21:17:00 >> 
07/02/2026 21:17:00 >>          0.0     0.9836    0.9624    0.9729      7424
07/02/2026 21:17:00 >>          1.0     0.3814    0.5911    0.4636       291
07/02/2026 21:17:00 >> 
07/02/2026 21:17:00 >>     accuracy                         0.9484      7715
07/02/2026 21:17:00 >>    macro avg     0.6825    0.7767    0.7183      7715
07/02/2026 21:17:00 >> weighted avg     0.9609    0.9484    0.9537      7715
07/02/2026 21:17:00 >> 
07/02/2026 21:17:00 >> Confusion Matrix:
07/02/2026 21:17:00 >> [7145, 279]
07/02/2026 21:17:00 >> [119, 172]
07/02/2026 21:17:00 >> ============================================================
07/02/2026 21:17:00 >> Final Test Results:
07/02/2026 21:17:00 >>   AUROC: 0.8996 | AUPRC: 0.5466 | MinRP: 0.5274 | Accuracy: 0.9484
07/02/2026 21:17:00 >> ============================================================
