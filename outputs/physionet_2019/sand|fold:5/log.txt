24/01/2026 06:39:07 >> Namespace(dataset='physionet_2019', model_type='sand', split_file='physionet_2019_5fold.json', fold=5, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2019/sand|fold:5', lr=0.001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=64, num_layers=2, num_heads=4, dropout=0.2, r=10, M=16, logger=<utils.logger.Logger object at 0x7f78a9f06140>)

24/01/2026 06:39:07 >> Preparing dataset physionet_2019
24/01/2026 06:39:07 >> Using fold 5/5
24/01/2026 06:39:07 >> Loaded splits from physionet_2019_5fold.json
24/01/2026 06:39:09 >> # train, val, test TS: [24688, 6172, 7715]
24/01/2026 06:39:09 >> pos class weight: 26.7705
24/01/2026 06:39:09 >> % pos class in train, val, test splits: [0.0360, 0.0399, 0.0399]
24/01/2026 06:39:10 >> # static features: 5
24/01/2026 06:39:10 >> # TS variables (SAND): 34
24/01/2026 06:39:13 >> # timesteps (hours): 61
24/01/2026 06:39:24 >> Input shape: [N, 61, 102]

24/01/2026 06:39:24 >> Model details:
24/01/2026 06:39:24 >> # parameters: 91738
24/01/2026 06:39:24 >> # trainable parameters: 87041, 94.87998430312412%
24/01/2026 06:39:24 >> #params by dtype:
24/01/2026 06:39:24 >> torch.float32: 91738, 100.0%

24/01/2026 06:39:24 >> No. of training batches per epoch = 772

24/01/2026 06:39:24 >> ============================================================
24/01/2026 06:39:24 >>                Starting training...
24/01/2026 06:39:24 >> ============================================================
24/01/2026 06:39:24 >> >>> Epoch 1/20
24/01/2026 06:39:30 >> Epoch 1 completed | Avg Loss: 3.0848
24/01/2026 06:39:30 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8309 | AUPRC: 0.2429 | MinRP: 0.3846
24/01/2026 06:39:31 >> VAL          Epoch:     1 | AUROC: 0.8187 | AUPRC: 0.2822 | MinRP: 0.3902
24/01/2026 06:39:31 >> AUPRC improved: 0.0000 ---> 0.2822 (+0.2822)
24/01/2026 06:39:31 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:39:31 >> ============================================================
24/01/2026 06:39:31 >> >>> Epoch 2/20
24/01/2026 06:39:35 >> Epoch 2 completed | Avg Loss: 2.5780
24/01/2026 06:39:35 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8162 | AUPRC: 0.2226 | MinRP: 0.3077
24/01/2026 06:39:36 >> VAL          Epoch:     2 | AUROC: 0.8078 | AUPRC: 0.2857 | MinRP: 0.3790
24/01/2026 06:39:36 >> AUPRC improved: 0.2822 ---> 0.2857 (+0.0035)
24/01/2026 06:39:36 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:39:36 >> ============================================================
24/01/2026 06:39:36 >> >>> Epoch 3/20
24/01/2026 06:39:41 >> Epoch 3 completed | Avg Loss: 2.1731
24/01/2026 06:39:41 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8356 | AUPRC: 0.2938 | MinRP: 0.3563
24/01/2026 06:39:41 >> VAL          Epoch:     3 | AUROC: 0.8266 | AUPRC: 0.3689 | MinRP: 0.4049
24/01/2026 06:39:41 >> AUPRC improved: 0.2857 ---> 0.3689 (+0.0832)
24/01/2026 06:39:41 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:39:41 >> ============================================================
24/01/2026 06:39:41 >> >>> Epoch 4/20
24/01/2026 06:39:46 >> Epoch 4 completed | Avg Loss: 1.9846
24/01/2026 06:39:46 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8468 | AUPRC: 0.3022 | MinRP: 0.3875
24/01/2026 06:39:46 >> VAL          Epoch:     4 | AUROC: 0.8299 | AUPRC: 0.4046 | MinRP: 0.4358
24/01/2026 06:39:46 >> AUPRC improved: 0.3689 ---> 0.4046 (+0.0357)
24/01/2026 06:39:46 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:39:46 >> ============================================================
24/01/2026 06:39:46 >> >>> Epoch 5/20
24/01/2026 06:39:51 >> Epoch 5 completed | Avg Loss: 1.7227
24/01/2026 06:39:51 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8546 | AUPRC: 0.3007 | MinRP: 0.3462
24/01/2026 06:39:51 >> VAL          Epoch:     5 | AUROC: 0.8397 | AUPRC: 0.3991 | MinRP: 0.4065
24/01/2026 06:39:51 >> No improvement. Wait: 4/5
24/01/2026 06:39:51 >> ============================================================
24/01/2026 06:39:51 >> >>> Epoch 6/20
24/01/2026 06:39:55 >> Epoch 6 completed | Avg Loss: 1.6757
24/01/2026 06:39:55 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8681 | AUPRC: 0.3349 | MinRP: 0.3846
24/01/2026 06:39:55 >> VAL          Epoch:     6 | AUROC: 0.8462 | AUPRC: 0.4259 | MinRP: 0.4390
24/01/2026 06:39:55 >> AUPRC improved: 0.4046 ---> 0.4259 (+0.0213)
24/01/2026 06:39:55 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:39:55 >> ============================================================
24/01/2026 06:39:55 >> >>> Epoch 7/20
24/01/2026 06:40:00 >> Epoch 7 completed | Avg Loss: 1.6424
24/01/2026 06:40:00 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8746 | AUPRC: 0.3432 | MinRP: 0.3590
24/01/2026 06:40:00 >> VAL          Epoch:     7 | AUROC: 0.8394 | AUPRC: 0.4404 | MinRP: 0.4431
24/01/2026 06:40:00 >> AUPRC improved: 0.4259 ---> 0.4404 (+0.0145)
24/01/2026 06:40:00 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:40:00 >> ============================================================
24/01/2026 06:40:00 >> >>> Epoch 8/20
24/01/2026 06:40:05 >> Epoch 8 completed | Avg Loss: 1.5601
24/01/2026 06:40:05 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8617 | AUPRC: 0.3741 | MinRP: 0.3827
24/01/2026 06:40:05 >> VAL          Epoch:     8 | AUROC: 0.8416 | AUPRC: 0.4377 | MinRP: 0.4512
24/01/2026 06:40:05 >> No improvement. Wait: 4/5
24/01/2026 06:40:05 >> ============================================================
24/01/2026 06:40:05 >> >>> Epoch 9/20
24/01/2026 06:40:10 >> Epoch 9 completed | Avg Loss: 1.4830
24/01/2026 06:40:10 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8822 | AUPRC: 0.3871 | MinRP: 0.4051
24/01/2026 06:40:10 >> VAL          Epoch:     9 | AUROC: 0.8467 | AUPRC: 0.4514 | MinRP: 0.4675
24/01/2026 06:40:10 >> AUPRC improved: 0.4404 ---> 0.4514 (+0.0110)
24/01/2026 06:40:10 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:40:10 >> ============================================================
24/01/2026 06:40:10 >> >>> Epoch 10/20
24/01/2026 06:40:15 >> Epoch 10 completed | Avg Loss: 1.4433
24/01/2026 06:40:15 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8804 | AUPRC: 0.3974 | MinRP: 0.4304
24/01/2026 06:40:15 >> VAL          Epoch:    10 | AUROC: 0.8442 | AUPRC: 0.4398 | MinRP: 0.4675
24/01/2026 06:40:15 >> No improvement. Wait: 4/5
24/01/2026 06:40:15 >> ============================================================
24/01/2026 06:40:15 >> >>> Epoch 11/20
24/01/2026 06:40:19 >> Epoch 11 completed | Avg Loss: 1.4626
24/01/2026 06:40:20 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8897 | AUPRC: 0.3964 | MinRP: 0.4198
24/01/2026 06:40:20 >> VAL          Epoch:    11 | AUROC: 0.8460 | AUPRC: 0.4518 | MinRP: 0.4715
24/01/2026 06:40:20 >> AUPRC improved: 0.4514 ---> 0.4518 (+0.0004)
24/01/2026 06:40:20 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:40:20 >> ============================================================
24/01/2026 06:40:20 >> >>> Epoch 12/20
24/01/2026 06:40:24 >> Epoch 12 completed | Avg Loss: 1.4029
24/01/2026 06:40:24 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8897 | AUPRC: 0.4078 | MinRP: 0.4359
24/01/2026 06:40:24 >> VAL          Epoch:    12 | AUROC: 0.8500 | AUPRC: 0.4697 | MinRP: 0.4878
24/01/2026 06:40:24 >> AUPRC improved: 0.4518 ---> 0.4697 (+0.0179)
24/01/2026 06:40:24 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:40:24 >> ============================================================
24/01/2026 06:40:24 >> >>> Epoch 13/20
24/01/2026 06:40:29 >> Epoch 13 completed | Avg Loss: 1.3399
24/01/2026 06:40:29 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8893 | AUPRC: 0.3715 | MinRP: 0.4359
24/01/2026 06:40:29 >> VAL          Epoch:    13 | AUROC: 0.8390 | AUPRC: 0.4552 | MinRP: 0.5000
24/01/2026 06:40:29 >> No improvement. Wait: 4/5
24/01/2026 06:40:29 >> ============================================================
24/01/2026 06:40:29 >> >>> Epoch 14/20
24/01/2026 06:40:34 >> Epoch 14 completed | Avg Loss: 1.3499
24/01/2026 06:40:34 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8989 | AUPRC: 0.4084 | MinRP: 0.4125
24/01/2026 06:40:34 >> VAL          Epoch:    14 | AUROC: 0.8504 | AUPRC: 0.4328 | MinRP: 0.4593
24/01/2026 06:40:34 >> No improvement. Wait: 3/5
24/01/2026 06:40:34 >> ============================================================
24/01/2026 06:40:34 >> >>> Epoch 15/20
24/01/2026 06:40:39 >> Epoch 15 completed | Avg Loss: 1.2884
24/01/2026 06:40:39 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.8985 | AUPRC: 0.4257 | MinRP: 0.4231
24/01/2026 06:40:39 >> VAL          Epoch:    15 | AUROC: 0.8449 | AUPRC: 0.4493 | MinRP: 0.4715
24/01/2026 06:40:39 >> No improvement. Wait: 2/5
24/01/2026 06:40:39 >> ============================================================
24/01/2026 06:40:39 >> >>> Epoch 16/20
24/01/2026 06:40:44 >> Epoch 16 completed | Avg Loss: 1.3462
24/01/2026 06:40:44 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9136 | AUPRC: 0.4435 | MinRP: 0.4359
24/01/2026 06:40:45 >> VAL          Epoch:    16 | AUROC: 0.8402 | AUPRC: 0.4703 | MinRP: 0.5041
24/01/2026 06:40:45 >> AUPRC improved: 0.4697 ---> 0.4703 (+0.0005)
24/01/2026 06:40:45 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:40:45 >> ============================================================
24/01/2026 06:40:45 >> >>> Epoch 17/20
24/01/2026 06:40:49 >> Epoch 17 completed | Avg Loss: 1.3169
24/01/2026 06:40:49 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9009 | AUPRC: 0.4113 | MinRP: 0.4405
24/01/2026 06:40:50 >> VAL          Epoch:    17 | AUROC: 0.8371 | AUPRC: 0.4716 | MinRP: 0.4920
24/01/2026 06:40:50 >> AUPRC improved: 0.4703 ---> 0.4716 (+0.0013)
24/01/2026 06:40:50 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:40:50 >> ============================================================
24/01/2026 06:40:50 >> >>> Epoch 18/20
24/01/2026 06:40:54 >> Epoch 18 completed | Avg Loss: 1.2725
24/01/2026 06:40:54 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9111 | AUPRC: 0.4556 | MinRP: 0.4333
24/01/2026 06:40:54 >> VAL          Epoch:    18 | AUROC: 0.8465 | AUPRC: 0.4926 | MinRP: 0.4878
24/01/2026 06:40:54 >> AUPRC improved: 0.4716 ---> 0.4926 (+0.0210)
24/01/2026 06:40:54 >> Saving checkpoint to ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:40:54 >> ============================================================
24/01/2026 06:40:54 >> >>> Epoch 19/20
24/01/2026 06:40:59 >> Epoch 19 completed | Avg Loss: 1.2702
24/01/2026 06:40:59 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9116 | AUPRC: 0.4268 | MinRP: 0.4304
24/01/2026 06:40:59 >> VAL          Epoch:    19 | AUROC: 0.8432 | AUPRC: 0.4853 | MinRP: 0.4797
24/01/2026 06:40:59 >> No improvement. Wait: 4/5
24/01/2026 06:40:59 >> ============================================================
24/01/2026 06:40:59 >> >>> Epoch 20/20
24/01/2026 06:41:03 >> Epoch 20 completed | Avg Loss: 1.3270
24/01/2026 06:41:04 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.9126 | AUPRC: 0.4313 | MinRP: 0.4500
24/01/2026 06:41:04 >> VAL          Epoch:    20 | AUROC: 0.8465 | AUPRC: 0.4893 | MinRP: 0.5000
24/01/2026 06:41:04 >> No improvement. Wait: 3/5
24/01/2026 06:41:04 >> ============================================================

24/01/2026 06:41:04 >> ============================================================
24/01/2026 06:41:04 >> TRAINING COMPLETED
24/01/2026 06:41:04 >> ============================================================
24/01/2026 06:41:04 >> Best Validation Results:
24/01/2026 06:41:04 >>   AUROC: 0.8465 | AUPRC: 0.4926 | MinRP: 0.4878
24/01/2026 06:41:04 >> Loading best model from ../outputs/physionet_2019/sand|fold:5/checkpoint_best.bin
24/01/2026 06:41:04 >> Evaluating on test set...
24/01/2026 06:41:04 >> TEST         AUROC: 0.8351 | AUPRC: 0.3849 | MinRP: 0.4194 | Accuracy: 0.9247

24/01/2026 06:41:04 >> ============================================================
24/01/2026 06:41:04 >> Classification Report:
24/01/2026 06:41:04 >>               precision    recall  f1-score   support
24/01/2026 06:41:04 >> 
24/01/2026 06:41:04 >>          0.0     0.9804    0.9403    0.9600      7407
24/01/2026 06:41:04 >>          1.0     0.2766    0.5487    0.3678       308
24/01/2026 06:41:04 >> 
24/01/2026 06:41:04 >>     accuracy                         0.9247      7715
24/01/2026 06:41:04 >>    macro avg     0.6285    0.7445    0.6639      7715
24/01/2026 06:41:04 >> weighted avg     0.9523    0.9247    0.9363      7715
24/01/2026 06:41:04 >> 
24/01/2026 06:41:04 >> Confusion Matrix:
24/01/2026 06:41:04 >> [6965, 442]
24/01/2026 06:41:04 >> [139, 169]
24/01/2026 06:41:04 >> ============================================================
24/01/2026 06:41:04 >> Final Test Results:
24/01/2026 06:41:04 >>   AUROC: 0.8351 | AUPRC: 0.3849 | MinRP: 0.4194 | Accuracy: 0.9247
24/01/2026 06:41:04 >> ============================================================
