
17/01/2026 15:46:05 >> Namespace(dataset='physionet_2012', model_type='mtm', split_file='physionet_2012_5fold.json', fold=4, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/mtm|fold:4', lr=0.0004, train_batch_size=64, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=5.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=96, r_hid=4, dropout=0.13, down_mode='max', num_mtm_layers=4, downsample_ratio=3, logger=<utils.logger.Logger object at 0x7cf7e007de40>)

17/01/2026 15:46:05 >> Preparing dataset physionet_2012
17/01/2026 15:46:05 >> Using fold 4/5
17/01/2026 15:46:05 >> Loaded splits from physionet_2012_5fold.json
17/01/2026 15:46:06 >> # train, val, test TS: [7673, 1918, 2397]
17/01/2026 15:46:06 >> pos class weight: 6.0201
17/01/2026 15:46:06 >> % pos class in train, val, test splits: [0.1424, 0.1423, 0.1423]
17/01/2026 15:46:07 >> # static features: 8
17/01/2026 15:46:10 >> # TS variables: 36

17/01/2026 15:46:22 >> Model details:
17/01/2026 15:46:22 >> # parameters: 684674
17/01/2026 15:46:22 >> # trainable parameters: 684674, 100.0%
17/01/2026 15:46:22 >> #params by dtype:
17/01/2026 15:46:22 >> torch.float32: 684674, 100.0%

17/01/2026 15:46:22 >> No. of training batches per epoch = 120

17/01/2026 15:46:22 >> ============================================================
17/01/2026 15:46:22 >>                Starting training...
17/01/2026 15:46:22 >> ============================================================
17/01/2026 15:46:22 >> >>> Epoch 1/20
17/01/2026 15:46:58 >> Epoch 1 completed | Avg Loss: 1.1197
17/01/2026 15:47:05 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8124 | AUPRC: 0.4433 | MinRP: 0.4351
17/01/2026 15:47:12 >> VAL          Epoch:     1 | AUROC: 0.7963 | AUPRC: 0.4026 | MinRP: 0.4404
17/01/2026 15:47:12 >> AUPRC improved: 0.0000 ---> 0.4026 (+0.4026)
17/01/2026 15:47:12 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:47:12 >> ============================================================
17/01/2026 15:47:12 >> >>> Epoch 2/20
17/01/2026 15:47:47 >> Epoch 2 completed | Avg Loss: 0.8931
17/01/2026 15:47:54 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8388 | AUPRC: 0.4998 | MinRP: 0.4603
17/01/2026 15:48:01 >> VAL          Epoch:     2 | AUROC: 0.8195 | AUPRC: 0.4522 | MinRP: 0.4762
17/01/2026 15:48:01 >> AUPRC improved: 0.4026 ---> 0.4522 (+0.0497)
17/01/2026 15:48:01 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:48:01 >> ============================================================
17/01/2026 15:48:01 >> >>> Epoch 3/20
17/01/2026 15:48:36 >> Epoch 3 completed | Avg Loss: 0.8352
17/01/2026 15:48:43 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8577 | AUPRC: 0.5430 | MinRP: 0.5110
17/01/2026 15:48:49 >> VAL          Epoch:     3 | AUROC: 0.8328 | AUPRC: 0.4719 | MinRP: 0.4908
17/01/2026 15:48:49 >> AUPRC improved: 0.4522 ---> 0.4719 (+0.0197)
17/01/2026 15:48:49 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:48:49 >> ============================================================
17/01/2026 15:48:49 >> >>> Epoch 4/20
17/01/2026 15:49:17 >> Epoch 4 completed | Avg Loss: 0.8123
17/01/2026 15:49:22 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8722 | AUPRC: 0.5649 | MinRP: 0.5265
17/01/2026 15:49:27 >> VAL          Epoch:     4 | AUROC: 0.8404 | AUPRC: 0.4826 | MinRP: 0.4872
17/01/2026 15:49:27 >> AUPRC improved: 0.4719 ---> 0.4826 (+0.0107)
17/01/2026 15:49:27 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:49:28 >> ============================================================
17/01/2026 15:49:28 >> >>> Epoch 5/20
17/01/2026 15:50:01 >> Epoch 5 completed | Avg Loss: 0.7658
17/01/2026 15:50:08 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8793 | AUPRC: 0.5705 | MinRP: 0.5333
17/01/2026 15:50:15 >> VAL          Epoch:     5 | AUROC: 0.8435 | AUPRC: 0.4956 | MinRP: 0.4908
17/01/2026 15:50:15 >> AUPRC improved: 0.4826 ---> 0.4956 (+0.0130)
17/01/2026 15:50:15 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:50:15 >> ============================================================
17/01/2026 15:50:15 >> >>> Epoch 6/20
17/01/2026 15:50:50 >> Epoch 6 completed | Avg Loss: 0.7423
17/01/2026 15:50:57 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8864 | AUPRC: 0.5863 | MinRP: 0.5728
17/01/2026 15:51:04 >> VAL          Epoch:     6 | AUROC: 0.8480 | AUPRC: 0.5101 | MinRP: 0.5089
17/01/2026 15:51:04 >> AUPRC improved: 0.4956 ---> 0.5101 (+0.0145)
17/01/2026 15:51:04 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:51:04 >> ============================================================
17/01/2026 15:51:04 >> >>> Epoch 7/20
17/01/2026 15:51:39 >> Epoch 7 completed | Avg Loss: 0.7372
17/01/2026 15:51:45 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8924 | AUPRC: 0.6002 | MinRP: 0.5728
17/01/2026 15:51:52 >> VAL          Epoch:     7 | AUROC: 0.8513 | AUPRC: 0.5119 | MinRP: 0.4945
17/01/2026 15:51:52 >> AUPRC improved: 0.5101 ---> 0.5119 (+0.0019)
17/01/2026 15:51:52 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:51:52 >> ============================================================
17/01/2026 15:51:52 >> >>> Epoch 8/20
17/01/2026 15:52:27 >> Epoch 8 completed | Avg Loss: 0.7204
17/01/2026 15:52:34 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8977 | AUPRC: 0.6164 | MinRP: 0.5776
17/01/2026 15:52:41 >> VAL          Epoch:     8 | AUROC: 0.8511 | AUPRC: 0.5166 | MinRP: 0.5055
17/01/2026 15:52:41 >> AUPRC improved: 0.5119 ---> 0.5166 (+0.0046)
17/01/2026 15:52:41 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:52:41 >> ============================================================
17/01/2026 15:52:41 >> >>> Epoch 9/20
17/01/2026 15:53:15 >> Epoch 9 completed | Avg Loss: 0.7103
17/01/2026 15:53:22 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9021 | AUPRC: 0.6215 | MinRP: 0.5933
17/01/2026 15:53:30 >> VAL          Epoch:     9 | AUROC: 0.8530 | AUPRC: 0.5243 | MinRP: 0.5128
17/01/2026 15:53:30 >> AUPRC improved: 0.5166 ---> 0.5243 (+0.0078)
17/01/2026 15:53:30 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:53:30 >> ============================================================
17/01/2026 15:53:30 >> >>> Epoch 10/20
17/01/2026 15:54:04 >> Epoch 10 completed | Avg Loss: 0.6902
17/01/2026 15:54:11 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9034 | AUPRC: 0.6238 | MinRP: 0.5933
17/01/2026 15:54:18 >> VAL          Epoch:    10 | AUROC: 0.8531 | AUPRC: 0.5264 | MinRP: 0.5165
17/01/2026 15:54:18 >> AUPRC improved: 0.5243 ---> 0.5264 (+0.0020)
17/01/2026 15:54:18 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:54:18 >> ============================================================
17/01/2026 15:54:18 >> >>> Epoch 11/20
17/01/2026 15:54:52 >> Epoch 11 completed | Avg Loss: 0.6668
17/01/2026 15:54:58 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9064 | AUPRC: 0.6289 | MinRP: 0.6133
17/01/2026 15:55:06 >> VAL          Epoch:    11 | AUROC: 0.8513 | AUPRC: 0.5203 | MinRP: 0.5055
17/01/2026 15:55:06 >> No improvement. Wait: 4/5
17/01/2026 15:55:06 >> ============================================================
17/01/2026 15:55:06 >> >>> Epoch 12/20
17/01/2026 15:55:40 >> Epoch 12 completed | Avg Loss: 0.6611
17/01/2026 15:55:47 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9148 | AUPRC: 0.6473 | MinRP: 0.6139
17/01/2026 15:55:54 >> VAL          Epoch:    12 | AUROC: 0.8528 | AUPRC: 0.5315 | MinRP: 0.5145
17/01/2026 15:55:54 >> AUPRC improved: 0.5264 ---> 0.5315 (+0.0051)
17/01/2026 15:55:54 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:55:54 >> ============================================================
17/01/2026 15:55:54 >> >>> Epoch 13/20
17/01/2026 15:56:27 >> Epoch 13 completed | Avg Loss: 0.6339
17/01/2026 15:56:35 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9186 | AUPRC: 0.6519 | MinRP: 0.6200
17/01/2026 15:56:42 >> VAL          Epoch:    13 | AUROC: 0.8528 | AUPRC: 0.5283 | MinRP: 0.5092
17/01/2026 15:56:42 >> No improvement. Wait: 4/5
17/01/2026 15:56:42 >> ============================================================
17/01/2026 15:56:42 >> >>> Epoch 14/20
17/01/2026 15:57:16 >> Epoch 14 completed | Avg Loss: 0.6345
17/01/2026 15:57:23 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9272 | AUPRC: 0.6717 | MinRP: 0.6400
17/01/2026 15:57:31 >> VAL          Epoch:    14 | AUROC: 0.8499 | AUPRC: 0.5223 | MinRP: 0.5219
17/01/2026 15:57:31 >> No improvement. Wait: 3/5
17/01/2026 15:57:31 >> ============================================================
17/01/2026 15:57:31 >> >>> Epoch 15/20
17/01/2026 15:58:05 >> Epoch 15 completed | Avg Loss: 0.6169
17/01/2026 15:58:12 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9280 | AUPRC: 0.6797 | MinRP: 0.6375
17/01/2026 15:58:19 >> VAL          Epoch:    15 | AUROC: 0.8491 | AUPRC: 0.5114 | MinRP: 0.4877
17/01/2026 15:58:19 >> No improvement. Wait: 2/5
17/01/2026 15:58:19 >> ============================================================
17/01/2026 15:58:19 >> >>> Epoch 16/20
17/01/2026 15:58:52 >> Epoch 16 completed | Avg Loss: 0.5916
17/01/2026 15:58:57 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9337 | AUPRC: 0.6960 | MinRP: 0.6533
17/01/2026 15:59:03 >> VAL          Epoch:    16 | AUROC: 0.8531 | AUPRC: 0.5162 | MinRP: 0.5205
17/01/2026 15:59:03 >> No improvement. Wait: 1/5
17/01/2026 15:59:03 >> ============================================================
17/01/2026 15:59:03 >> >>> Epoch 17/20
17/01/2026 15:59:29 >> Epoch 17 completed | Avg Loss: 0.5782
17/01/2026 15:59:35 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9413 | AUPRC: 0.7082 | MinRP: 0.6667
17/01/2026 15:59:42 >> VAL          Epoch:    17 | AUROC: 0.8487 | AUPRC: 0.4982 | MinRP: 0.4891
17/01/2026 15:59:42 >> No improvement. Wait: 0/5
17/01/2026 15:59:42 >> Patience reached. Early stopping.

17/01/2026 15:59:42 >> ============================================================
17/01/2026 15:59:42 >> TRAINING COMPLETED
17/01/2026 15:59:42 >> ============================================================
17/01/2026 15:59:42 >> Best Validation Results:
17/01/2026 15:59:42 >>   AUROC: 0.8528 | AUPRC: 0.5315 | MinRP: 0.5145
17/01/2026 15:59:42 >> Loading best model from ../outputs/physionet_2012/mtm|fold:4/checkpoint_best.bin
17/01/2026 15:59:42 >> Evaluating on test set...
17/01/2026 15:59:52 >> TEST         AUROC: 0.8598 | AUPRC: 0.5221 | MinRP: 0.5132 | Accuracy: 0.8248

17/01/2026 15:59:52 >> ============================================================
17/01/2026 15:59:52 >> Classification Report:
17/01/2026 15:59:52 >>               precision    recall  f1-score   support
17/01/2026 15:59:52 >> 
17/01/2026 15:59:52 >>          0.0     0.9319    0.8585    0.8937      2056
17/01/2026 15:59:52 >>          1.0     0.4215    0.6217    0.5024       341
17/01/2026 15:59:52 >> 
17/01/2026 15:59:52 >>     accuracy                         0.8248      2397
17/01/2026 15:59:52 >>    macro avg     0.6767    0.7401    0.6980      2397
17/01/2026 15:59:52 >> weighted avg     0.8593    0.8248    0.8380      2397
17/01/2026 15:59:52 >> 
17/01/2026 15:59:52 >> Confusion Matrix:
17/01/2026 15:59:52 >> [1765, 291]
17/01/2026 15:59:52 >> [129, 212]
17/01/2026 15:59:52 >> ============================================================
17/01/2026 15:59:52 >> Final Test Results:
17/01/2026 15:59:52 >>   AUROC: 0.8598 | AUPRC: 0.5221 | MinRP: 0.5132 | Accuracy: 0.8248
17/01/2026 15:59:52 >> ============================================================
