
24/01/2026 21:44:33 >> Namespace(dataset='physionet_2012', model_type='grud', split_file='physionet_2012_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/grud|fold:1', lr=0.0002, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=5.0, max_obs=880, max_timesteps=880, device='cuda:0', seed=2026, hid_dim=128, dropout=0.1, logger=<utils.logger.Logger object at 0x7b69ca4a7760>)

24/01/2026 21:44:33 >> Preparing dataset physionet_2012
24/01/2026 21:44:34 >> Using fold 1/5
24/01/2026 21:44:34 >> Loaded splits from physionet_2012_5fold.json
24/01/2026 21:44:34 >> # train, val, test TS: [7673, 1918, 2397]
24/01/2026 21:44:35 >> pos class weight: 6.0330
24/01/2026 21:44:35 >> % pos class in train, val, test splits: [0.1422, 0.1283, 0.1544]
24/01/2026 21:44:35 >> # static features: 8
24/01/2026 21:44:35 >> [GRU-D] # TS variables: 36
24/01/2026 21:44:37 >> [GRU-D] # timesteps (hourly): 49

24/01/2026 21:44:48 >> Model details:
24/01/2026 21:44:48 >> # parameters: 117449
24/01/2026 21:44:48 >> # trainable parameters: 117449, 100.0%
24/01/2026 21:44:48 >> #params by dtype:
24/01/2026 21:44:48 >> torch.float32: 117449, 100.0%

24/01/2026 21:44:48 >> No. of training batches per epoch = 240

24/01/2026 21:44:48 >> ============================================================
24/01/2026 21:44:48 >>                Starting training...
24/01/2026 21:44:48 >> ============================================================
24/01/2026 21:44:48 >> >>> Epoch 1/20
24/01/2026 21:45:04 >> Epoch 1 completed | Avg Loss: 0.9943
24/01/2026 21:45:05 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8516 | AUPRC: 0.4843 | MinRP: 0.4967
24/01/2026 21:45:06 >> VAL          Epoch:     1 | AUROC: 0.8334 | AUPRC: 0.4611 | MinRP: 0.4756
24/01/2026 21:45:06 >> AUPRC improved: 0.0000 ---> 0.4611 (+0.4611)
24/01/2026 21:45:06 >> Saving checkpoint to ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:45:06 >> ============================================================
24/01/2026 21:45:06 >> >>> Epoch 2/20
24/01/2026 21:45:20 >> Epoch 2 completed | Avg Loss: 0.8704
24/01/2026 21:45:20 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8642 | AUPRC: 0.5153 | MinRP: 0.5155
24/01/2026 21:45:21 >> VAL          Epoch:     2 | AUROC: 0.8487 | AUPRC: 0.4822 | MinRP: 0.5040
24/01/2026 21:45:21 >> AUPRC improved: 0.4611 ---> 0.4822 (+0.0211)
24/01/2026 21:45:21 >> Saving checkpoint to ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:45:21 >> ============================================================
24/01/2026 21:45:21 >> >>> Epoch 3/20
24/01/2026 21:45:35 >> Epoch 3 completed | Avg Loss: 0.8453
24/01/2026 21:45:36 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8686 | AUPRC: 0.5237 | MinRP: 0.5232
24/01/2026 21:45:36 >> VAL          Epoch:     3 | AUROC: 0.8512 | AUPRC: 0.4884 | MinRP: 0.4878
24/01/2026 21:45:36 >> AUPRC improved: 0.4822 ---> 0.4884 (+0.0063)
24/01/2026 21:45:36 >> Saving checkpoint to ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:45:36 >> ============================================================
24/01/2026 21:45:36 >> >>> Epoch 4/20
24/01/2026 21:45:50 >> Epoch 4 completed | Avg Loss: 0.8356
24/01/2026 21:45:51 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8744 | AUPRC: 0.5344 | MinRP: 0.5433
24/01/2026 21:45:51 >> VAL          Epoch:     4 | AUROC: 0.8562 | AUPRC: 0.5099 | MinRP: 0.5060
24/01/2026 21:45:51 >> AUPRC improved: 0.4884 ---> 0.5099 (+0.0214)
24/01/2026 21:45:51 >> Saving checkpoint to ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:45:51 >> ============================================================
24/01/2026 21:45:51 >> >>> Epoch 5/20
24/01/2026 21:46:05 >> Epoch 5 completed | Avg Loss: 0.8012
24/01/2026 21:46:06 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8777 | AUPRC: 0.5443 | MinRP: 0.5361
24/01/2026 21:46:06 >> VAL          Epoch:     5 | AUROC: 0.8575 | AUPRC: 0.4960 | MinRP: 0.5061
24/01/2026 21:46:06 >> No improvement. Wait: 4/5
24/01/2026 21:46:06 >> ============================================================
24/01/2026 21:46:06 >> >>> Epoch 6/20
24/01/2026 21:46:20 >> Epoch 6 completed | Avg Loss: 0.8005
24/01/2026 21:46:21 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8859 | AUPRC: 0.5528 | MinRP: 0.5430
24/01/2026 21:46:21 >> VAL          Epoch:     6 | AUROC: 0.8652 | AUPRC: 0.5273 | MinRP: 0.5203
24/01/2026 21:46:21 >> AUPRC improved: 0.5099 ---> 0.5273 (+0.0174)
24/01/2026 21:46:21 >> Saving checkpoint to ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:46:21 >> ============================================================
24/01/2026 21:46:21 >> >>> Epoch 7/20
24/01/2026 21:46:35 >> Epoch 7 completed | Avg Loss: 0.7910
24/01/2026 21:46:36 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8904 | AUPRC: 0.5735 | MinRP: 0.5601
24/01/2026 21:46:36 >> VAL          Epoch:     7 | AUROC: 0.8628 | AUPRC: 0.5151 | MinRP: 0.5059
24/01/2026 21:46:36 >> No improvement. Wait: 4/5
24/01/2026 21:46:36 >> ============================================================
24/01/2026 21:46:36 >> >>> Epoch 8/20
24/01/2026 21:46:50 >> Epoch 8 completed | Avg Loss: 0.7707
24/01/2026 21:46:51 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8919 | AUPRC: 0.5791 | MinRP: 0.5548
24/01/2026 21:46:51 >> VAL          Epoch:     8 | AUROC: 0.8661 | AUPRC: 0.5230 | MinRP: 0.5161
24/01/2026 21:46:51 >> No improvement. Wait: 3/5
24/01/2026 21:46:51 >> ============================================================
24/01/2026 21:46:51 >> >>> Epoch 9/20
24/01/2026 21:47:05 >> Epoch 9 completed | Avg Loss: 0.7817
24/01/2026 21:47:05 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8937 | AUPRC: 0.5746 | MinRP: 0.5612
24/01/2026 21:47:06 >> VAL          Epoch:     9 | AUROC: 0.8642 | AUPRC: 0.5279 | MinRP: 0.5122
24/01/2026 21:47:06 >> AUPRC improved: 0.5273 ---> 0.5279 (+0.0006)
24/01/2026 21:47:06 >> Saving checkpoint to ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:47:06 >> ============================================================
24/01/2026 21:47:06 >> >>> Epoch 10/20
24/01/2026 21:47:20 >> Epoch 10 completed | Avg Loss: 0.7626
24/01/2026 21:47:20 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9003 | AUPRC: 0.5928 | MinRP: 0.5638
24/01/2026 21:47:21 >> VAL          Epoch:    10 | AUROC: 0.8672 | AUPRC: 0.5302 | MinRP: 0.5304
24/01/2026 21:47:21 >> AUPRC improved: 0.5279 ---> 0.5302 (+0.0024)
24/01/2026 21:47:21 >> Saving checkpoint to ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:47:21 >> ============================================================
24/01/2026 21:47:21 >> >>> Epoch 11/20
24/01/2026 21:47:34 >> Epoch 11 completed | Avg Loss: 0.7570
24/01/2026 21:47:34 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9013 | AUPRC: 0.5937 | MinRP: 0.5704
24/01/2026 21:47:35 >> VAL          Epoch:    11 | AUROC: 0.8675 | AUPRC: 0.5284 | MinRP: 0.5223
24/01/2026 21:47:35 >> No improvement. Wait: 4/5
24/01/2026 21:47:35 >> ============================================================
24/01/2026 21:47:35 >> >>> Epoch 12/20
24/01/2026 21:47:48 >> Epoch 12 completed | Avg Loss: 0.7478
24/01/2026 21:47:48 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9045 | AUPRC: 0.6069 | MinRP: 0.5748
24/01/2026 21:47:49 >> VAL          Epoch:    12 | AUROC: 0.8647 | AUPRC: 0.5122 | MinRP: 0.5122
24/01/2026 21:47:49 >> No improvement. Wait: 3/5
24/01/2026 21:47:49 >> ============================================================
24/01/2026 21:47:49 >> >>> Epoch 13/20
24/01/2026 21:48:02 >> Epoch 13 completed | Avg Loss: 0.7376
24/01/2026 21:48:02 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9075 | AUPRC: 0.6089 | MinRP: 0.5842
24/01/2026 21:48:03 >> VAL          Epoch:    13 | AUROC: 0.8677 | AUPRC: 0.5313 | MinRP: 0.5325
24/01/2026 21:48:03 >> AUPRC improved: 0.5302 ---> 0.5313 (+0.0010)
24/01/2026 21:48:03 >> Saving checkpoint to ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:48:03 >> ============================================================
24/01/2026 21:48:03 >> >>> Epoch 14/20
24/01/2026 21:48:15 >> Epoch 14 completed | Avg Loss: 0.7309
24/01/2026 21:48:16 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9131 | AUPRC: 0.6252 | MinRP: 0.6041
24/01/2026 21:48:16 >> VAL          Epoch:    14 | AUROC: 0.8669 | AUPRC: 0.5342 | MinRP: 0.5203
24/01/2026 21:48:16 >> AUPRC improved: 0.5313 ---> 0.5342 (+0.0030)
24/01/2026 21:48:16 >> Saving checkpoint to ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:48:16 >> ============================================================
24/01/2026 21:48:16 >> >>> Epoch 15/20
24/01/2026 21:48:28 >> Epoch 15 completed | Avg Loss: 0.7187
24/01/2026 21:48:29 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9144 | AUPRC: 0.6328 | MinRP: 0.5952
24/01/2026 21:48:29 >> VAL          Epoch:    15 | AUROC: 0.8675 | AUPRC: 0.5291 | MinRP: 0.5285
24/01/2026 21:48:29 >> No improvement. Wait: 4/5
24/01/2026 21:48:29 >> ============================================================
24/01/2026 21:48:29 >> >>> Epoch 16/20
24/01/2026 21:48:41 >> Epoch 16 completed | Avg Loss: 0.7192
24/01/2026 21:48:42 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9161 | AUPRC: 0.6338 | MinRP: 0.6104
24/01/2026 21:48:42 >> VAL          Epoch:    16 | AUROC: 0.8653 | AUPRC: 0.5421 | MinRP: 0.5285
24/01/2026 21:48:42 >> AUPRC improved: 0.5342 ---> 0.5421 (+0.0078)
24/01/2026 21:48:42 >> Saving checkpoint to ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:48:42 >> ============================================================
24/01/2026 21:48:42 >> >>> Epoch 17/20
24/01/2026 21:48:54 >> Epoch 17 completed | Avg Loss: 0.7046
24/01/2026 21:48:54 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9218 | AUPRC: 0.6482 | MinRP: 0.6179
24/01/2026 21:48:55 >> VAL          Epoch:    17 | AUROC: 0.8649 | AUPRC: 0.5318 | MinRP: 0.5255
24/01/2026 21:48:55 >> No improvement. Wait: 4/5
24/01/2026 21:48:55 >> ============================================================
24/01/2026 21:48:55 >> >>> Epoch 18/20
24/01/2026 21:49:07 >> Epoch 18 completed | Avg Loss: 0.6818
24/01/2026 21:49:07 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9251 | AUPRC: 0.6609 | MinRP: 0.6357
24/01/2026 21:49:08 >> VAL          Epoch:    18 | AUROC: 0.8638 | AUPRC: 0.5208 | MinRP: 0.5160
24/01/2026 21:49:08 >> No improvement. Wait: 3/5
24/01/2026 21:49:08 >> ============================================================
24/01/2026 21:49:08 >> >>> Epoch 19/20
24/01/2026 21:49:20 >> Epoch 19 completed | Avg Loss: 0.6956
24/01/2026 21:49:21 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9292 | AUPRC: 0.6656 | MinRP: 0.6357
24/01/2026 21:49:21 >> VAL          Epoch:    19 | AUROC: 0.8628 | AUPRC: 0.5291 | MinRP: 0.5122
24/01/2026 21:49:21 >> No improvement. Wait: 2/5
24/01/2026 21:49:21 >> ============================================================
24/01/2026 21:49:21 >> >>> Epoch 20/20
24/01/2026 21:49:34 >> Epoch 20 completed | Avg Loss: 0.6648
24/01/2026 21:49:34 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.9307 | AUPRC: 0.6747 | MinRP: 0.6367
24/01/2026 21:49:34 >> VAL          Epoch:    20 | AUROC: 0.8623 | AUPRC: 0.5290 | MinRP: 0.5163
24/01/2026 21:49:34 >> No improvement. Wait: 1/5
24/01/2026 21:49:34 >> ============================================================

24/01/2026 21:49:34 >> ============================================================
24/01/2026 21:49:34 >> TRAINING COMPLETED
24/01/2026 21:49:34 >> ============================================================
24/01/2026 21:49:34 >> Best Validation Results:
24/01/2026 21:49:34 >>   AUROC: 0.8653 | AUPRC: 0.5421 | MinRP: 0.5285
24/01/2026 21:49:34 >> Loading best model from ../outputs/physionet_2012/grud|fold:1/checkpoint_best.bin
24/01/2026 21:49:34 >> Evaluating on test set...
24/01/2026 21:49:35 >> TEST         AUROC: 0.8627 | AUPRC: 0.5870 | MinRP: 0.5622 | Accuracy: 0.8127

24/01/2026 21:49:35 >> ============================================================
24/01/2026 21:49:35 >> Classification Report:
24/01/2026 21:49:35 >>               precision    recall  f1-score   support
24/01/2026 21:49:35 >> 
24/01/2026 21:49:35 >>          0.0     0.9473    0.8244    0.8816      2027
24/01/2026 21:49:35 >>          1.0     0.4376    0.7486    0.5523       370
24/01/2026 21:49:35 >> 
24/01/2026 21:49:35 >>     accuracy                         0.8127      2397
24/01/2026 21:49:35 >>    macro avg     0.6924    0.7865    0.7170      2397
24/01/2026 21:49:35 >> weighted avg     0.8686    0.8127    0.8307      2397
24/01/2026 21:49:35 >> 
24/01/2026 21:49:35 >> Confusion Matrix:
24/01/2026 21:49:35 >> [1671, 356]
24/01/2026 21:49:35 >> [93, 277]
24/01/2026 21:49:35 >> ============================================================
24/01/2026 21:49:35 >> Final Test Results:
24/01/2026 21:49:35 >>   AUROC: 0.8627 | AUPRC: 0.5870 | MinRP: 0.5622 | Accuracy: 0.8127
24/01/2026 21:49:35 >> ============================================================
