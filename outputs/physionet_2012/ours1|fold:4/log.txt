28/01/2026 15:12:25 >> Namespace(dataset='physionet_2012', model='ours1', split_file='physionet_2012_5fold.json', fold=4, root_dir='/home/xiejun/codeLib/miccai', output_dir='/home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4', lr=0.0001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, grud_hid_dim=256, grud_dropout=0.2, transformer_hid_dim=64, transformer_num_layers=2, transformer_num_heads=4, transformer_dropout=0.1, fusion_hid_dim=256, fusion_dropout=0.2, lambda_aux=0.8, lambda_cos=0.5, logger=<utils.logger.Logger object at 0x745e04106140>)

28/01/2026 15:12:25 >> ============================================================
28/01/2026 15:12:25 >> Loading dataset...
28/01/2026 15:12:25 >> ============================================================

28/01/2026 15:12:25 >> Preparing dataset physionet_2012
28/01/2026 15:12:25 >> Using fold 4/5
28/01/2026 15:12:25 >> Loaded splits from physionet_2012_5fold.json
28/01/2026 15:12:26 >> # train, val, test TS: [7673, 1918, 2397]
28/01/2026 15:12:26 >> pos class weight: 6.0201
28/01/2026 15:12:26 >> % pos class in train, val, test splits: [0.1424, 0.1423, 0.1423]
28/01/2026 15:12:27 >> # static features: 8
28/01/2026 15:12:27 >> # TS variables (MedBiVT): 36
28/01/2026 15:12:29 >> # timesteps (MedBiVT): 49

28/01/2026 15:12:43 >> ============================================================
28/01/2026 15:12:43 >> Initializing ours1 model...
28/01/2026 15:12:43 >> ============================================================

28/01/2026 15:12:44 >> Model details:
28/01/2026 15:12:44 >> # parameters: 378283
28/01/2026 15:12:44 >> # trainable parameters: 378283, 100.00%
28/01/2026 15:12:44 >> #params by dtype:
28/01/2026 15:12:44 >> torch.float32: 378283, 100.00%

28/01/2026 15:12:44 >> No. of training batches per epoch = 240

28/01/2026 15:12:44 >> ============================================================
28/01/2026 15:12:44 >>                Starting training...
28/01/2026 15:12:44 >> ============================================================
28/01/2026 15:12:44 >> >>> Epoch 1/20
28/01/2026 15:12:59 >> Epoch 1 completed | Avg Loss: 2.8173
28/01/2026 15:13:01 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8343 | AUPRC: 0.4715 | MinRP: 0.4733
28/01/2026 15:13:02 >> VAL          Epoch:     1 | AUROC: 0.8079 | AUPRC: 0.4235 | MinRP: 0.4610
28/01/2026 15:13:02 >> AUPRC improved: 0.0000 ---> 0.4235 (+0.4235)
28/01/2026 15:13:02 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:13:02 >> ============================================================
28/01/2026 15:13:02 >> >>> Epoch 2/20
28/01/2026 15:13:14 >> Epoch 2 completed | Avg Loss: 2.3936
28/01/2026 15:13:15 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8510 | AUPRC: 0.5173 | MinRP: 0.4902
28/01/2026 15:13:16 >> VAL          Epoch:     2 | AUROC: 0.8265 | AUPRC: 0.4607 | MinRP: 0.4731
28/01/2026 15:13:16 >> AUPRC improved: 0.4235 ---> 0.4607 (+0.0372)
28/01/2026 15:13:16 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:13:16 >> ============================================================
28/01/2026 15:13:16 >> >>> Epoch 3/20
28/01/2026 15:13:28 >> Epoch 3 completed | Avg Loss: 2.3175
28/01/2026 15:13:29 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8584 | AUPRC: 0.5377 | MinRP: 0.5167
28/01/2026 15:13:29 >> VAL          Epoch:     3 | AUROC: 0.8331 | AUPRC: 0.4797 | MinRP: 0.4801
28/01/2026 15:13:29 >> AUPRC improved: 0.4607 ---> 0.4797 (+0.0190)
28/01/2026 15:13:29 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:13:29 >> ============================================================
28/01/2026 15:13:29 >> >>> Epoch 4/20
28/01/2026 15:13:42 >> Epoch 4 completed | Avg Loss: 2.2694
28/01/2026 15:13:43 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8640 | AUPRC: 0.5433 | MinRP: 0.5282
28/01/2026 15:13:44 >> VAL          Epoch:     4 | AUROC: 0.8364 | AUPRC: 0.4874 | MinRP: 0.4835
28/01/2026 15:13:44 >> AUPRC improved: 0.4797 ---> 0.4874 (+0.0077)
28/01/2026 15:13:44 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:13:44 >> ============================================================
28/01/2026 15:13:44 >> >>> Epoch 5/20
28/01/2026 15:13:56 >> Epoch 5 completed | Avg Loss: 2.2378
28/01/2026 15:13:56 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8688 | AUPRC: 0.5632 | MinRP: 0.5281
28/01/2026 15:13:57 >> VAL          Epoch:     5 | AUROC: 0.8413 | AUPRC: 0.5160 | MinRP: 0.5000
28/01/2026 15:13:57 >> AUPRC improved: 0.4874 ---> 0.5160 (+0.0286)
28/01/2026 15:13:57 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:13:57 >> ============================================================
28/01/2026 15:13:57 >> >>> Epoch 6/20
28/01/2026 15:14:09 >> Epoch 6 completed | Avg Loss: 2.1796
28/01/2026 15:14:10 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8703 | AUPRC: 0.5717 | MinRP: 0.5300
28/01/2026 15:14:11 >> VAL          Epoch:     6 | AUROC: 0.8430 | AUPRC: 0.5239 | MinRP: 0.5018
28/01/2026 15:14:11 >> AUPRC improved: 0.5160 ---> 0.5239 (+0.0079)
28/01/2026 15:14:11 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:14:11 >> ============================================================
28/01/2026 15:14:11 >> >>> Epoch 7/20
28/01/2026 15:14:23 >> Epoch 7 completed | Avg Loss: 2.1801
28/01/2026 15:14:23 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8720 | AUPRC: 0.5779 | MinRP: 0.5433
28/01/2026 15:14:24 >> VAL          Epoch:     7 | AUROC: 0.8430 | AUPRC: 0.5159 | MinRP: 0.5127
28/01/2026 15:14:24 >> No improvement. Wait: 4/5
28/01/2026 15:14:24 >> ============================================================
28/01/2026 15:14:24 >> >>> Epoch 8/20
28/01/2026 15:14:36 >> Epoch 8 completed | Avg Loss: 2.1557
28/01/2026 15:14:37 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8755 | AUPRC: 0.5801 | MinRP: 0.5482
28/01/2026 15:14:38 >> VAL          Epoch:     8 | AUROC: 0.8450 | AUPRC: 0.5257 | MinRP: 0.5036
28/01/2026 15:14:38 >> AUPRC improved: 0.5239 ---> 0.5257 (+0.0017)
28/01/2026 15:14:38 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:14:38 >> ============================================================
28/01/2026 15:14:38 >> >>> Epoch 9/20
28/01/2026 15:14:50 >> Epoch 9 completed | Avg Loss: 2.1565
28/01/2026 15:14:50 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8783 | AUPRC: 0.5974 | MinRP: 0.5600
28/01/2026 15:14:51 >> VAL          Epoch:     9 | AUROC: 0.8489 | AUPRC: 0.5320 | MinRP: 0.5036
28/01/2026 15:14:51 >> AUPRC improved: 0.5257 ---> 0.5320 (+0.0063)
28/01/2026 15:14:51 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:14:51 >> ============================================================
28/01/2026 15:14:51 >> >>> Epoch 10/20
28/01/2026 15:15:03 >> Epoch 10 completed | Avg Loss: 2.1426
28/01/2026 15:15:04 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8795 | AUPRC: 0.5981 | MinRP: 0.5430
28/01/2026 15:15:05 >> VAL          Epoch:    10 | AUROC: 0.8492 | AUPRC: 0.5341 | MinRP: 0.5165
28/01/2026 15:15:05 >> AUPRC improved: 0.5320 ---> 0.5341 (+0.0021)
28/01/2026 15:15:05 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:15:05 >> ============================================================
28/01/2026 15:15:05 >> >>> Epoch 11/20
28/01/2026 15:15:17 >> Epoch 11 completed | Avg Loss: 2.1215
28/01/2026 15:15:18 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8824 | AUPRC: 0.6071 | MinRP: 0.5633
28/01/2026 15:15:19 >> VAL          Epoch:    11 | AUROC: 0.8525 | AUPRC: 0.5498 | MinRP: 0.5328
28/01/2026 15:15:19 >> AUPRC improved: 0.5341 ---> 0.5498 (+0.0157)
28/01/2026 15:15:19 >> Saving checkpoint to /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:15:19 >> ============================================================
28/01/2026 15:15:19 >> >>> Epoch 12/20
28/01/2026 15:15:31 >> Epoch 12 completed | Avg Loss: 2.1049
28/01/2026 15:15:32 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8845 | AUPRC: 0.6002 | MinRP: 0.5533
28/01/2026 15:15:32 >> VAL          Epoch:    12 | AUROC: 0.8543 | AUPRC: 0.5423 | MinRP: 0.5311
28/01/2026 15:15:32 >> No improvement. Wait: 4/5
28/01/2026 15:15:32 >> ============================================================
28/01/2026 15:15:32 >> >>> Epoch 13/20
28/01/2026 15:15:45 >> Epoch 13 completed | Avg Loss: 2.0874
28/01/2026 15:15:45 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8849 | AUPRC: 0.6103 | MinRP: 0.5615
28/01/2026 15:15:46 >> VAL          Epoch:    13 | AUROC: 0.8531 | AUPRC: 0.5496 | MinRP: 0.5348
28/01/2026 15:15:46 >> No improvement. Wait: 3/5
28/01/2026 15:15:46 >> ============================================================
28/01/2026 15:15:46 >> >>> Epoch 14/20
28/01/2026 15:15:58 >> Epoch 14 completed | Avg Loss: 2.0841
28/01/2026 15:15:59 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8862 | AUPRC: 0.6047 | MinRP: 0.5600
28/01/2026 15:16:00 >> VAL          Epoch:    14 | AUROC: 0.8536 | AUPRC: 0.5473 | MinRP: 0.5348
28/01/2026 15:16:00 >> No improvement. Wait: 2/5
28/01/2026 15:16:00 >> ============================================================
28/01/2026 15:16:00 >> >>> Epoch 15/20
28/01/2026 15:16:12 >> Epoch 15 completed | Avg Loss: 2.0972
28/01/2026 15:16:13 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.8874 | AUPRC: 0.6079 | MinRP: 0.5533
28/01/2026 15:16:14 >> VAL          Epoch:    15 | AUROC: 0.8563 | AUPRC: 0.5468 | MinRP: 0.5275
28/01/2026 15:16:14 >> No improvement. Wait: 1/5
28/01/2026 15:16:14 >> ============================================================
28/01/2026 15:16:14 >> >>> Epoch 16/20
28/01/2026 15:16:26 >> Epoch 16 completed | Avg Loss: 2.0637
28/01/2026 15:16:27 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.8893 | AUPRC: 0.6113 | MinRP: 0.5667
28/01/2026 15:16:28 >> VAL          Epoch:    16 | AUROC: 0.8535 | AUPRC: 0.5471 | MinRP: 0.5302
28/01/2026 15:16:28 >> No improvement. Wait: 0/5
28/01/2026 15:16:28 >> Patience reached. Early stopping.

28/01/2026 15:16:28 >> ============================================================
28/01/2026 15:16:28 >> TRAINING COMPLETED
28/01/2026 15:16:28 >> ============================================================
28/01/2026 15:16:28 >> Best Validation Results:
28/01/2026 15:16:28 >>   AUROC: 0.8525 | AUPRC: 0.5498 | MinRP: 0.5328
28/01/2026 15:16:28 >> Loading best model from /home/xiejun/codeLib/miccai/lab1/outputs/physionet_2012/ours1|fold:4/checkpoint_best.bin
28/01/2026 15:16:28 >> Evaluating on test set...
28/01/2026 15:16:29 >> TEST         AUROC: 0.8580 | AUPRC: 0.5248 | MinRP: 0.5175 | Accuracy: 0.7267

28/01/2026 15:16:29 >> ============================================================
28/01/2026 15:16:29 >> Classification Report:
28/01/2026 15:16:29 >>               precision    recall  f1-score   support
28/01/2026 15:16:29 >> 
28/01/2026 15:16:29 >>          0.0     0.9648    0.7072    0.8162      2056
28/01/2026 15:16:29 >>          1.0     0.3236    0.8446    0.4679       341
28/01/2026 15:16:29 >> 
28/01/2026 15:16:29 >>     accuracy                         0.7267      2397
28/01/2026 15:16:29 >>    macro avg     0.6442    0.7759    0.6420      2397
28/01/2026 15:16:29 >> weighted avg     0.8736    0.7267    0.7666      2397
28/01/2026 15:16:29 >> 
28/01/2026 15:16:29 >> Confusion Matrix:
28/01/2026 15:16:29 >> [1454, 602]
28/01/2026 15:16:29 >> [53, 288]
28/01/2026 15:16:29 >> ============================================================
28/01/2026 15:16:29 >> ============================================================
28/01/2026 15:16:29 >> Final Test Results:
28/01/2026 15:16:29 >>   AUROC: 0.8580 | AUPRC: 0.5248 | MinRP: 0.5175 | Accuracy: 0.7267
28/01/2026 15:16:29 >> ============================================================
