17/01/2026 16:01:18 >> Namespace(dataset='physionet_2012', model_type='warpformer', split_file='physionet_2012_5fold.json', fold=5, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/warpformer|fold:5', lr=0.0003, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=64, num_layers=2, num_heads=2, dropout=0.1, warp_num_max=18, warpfunc='l1', warpact='relu', nonneg_trans='abs', warp_full_attn=True, logger=<utils.logger.Logger object at 0x7c735061e140>)

17/01/2026 16:01:18 >> Preparing dataset physionet_2012
17/01/2026 16:01:18 >> Using fold 5/5
17/01/2026 16:01:18 >> Loaded splits from physionet_2012_5fold.json
17/01/2026 16:01:19 >> # train, val, test TS: [7671, 1917, 2400]
17/01/2026 16:01:19 >> pos class weight: 5.9863
17/01/2026 16:01:19 >> % pos class in train, val, test splits: [0.1431, 0.1492, 0.1346]
17/01/2026 16:01:20 >> # static features: 8
17/01/2026 16:01:20 >> # TS variables (Warpformer): 36
17/01/2026 16:01:22 >> # timesteps (Warpformer): 49

17/01/2026 16:01:34 >> Model details:
17/01/2026 16:01:34 >> # parameters: 241673
17/01/2026 16:01:34 >> # trainable parameters: 241673, 100.0%
17/01/2026 16:01:34 >> #params by dtype:
17/01/2026 16:01:34 >> torch.float32: 241673, 100.0%

17/01/2026 16:01:34 >> No. of training batches per epoch = 240

17/01/2026 16:01:34 >> ============================================================
17/01/2026 16:01:34 >>                Starting training...
17/01/2026 16:01:34 >> ============================================================
17/01/2026 16:01:34 >> >>> Epoch 1/20
17/01/2026 16:01:54 >> Epoch 1 completed | Avg Loss: 1.0152
17/01/2026 16:01:56 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8325 | AUPRC: 0.4240 | MinRP: 0.4478
17/01/2026 16:01:57 >> VAL          Epoch:     1 | AUROC: 0.8281 | AUPRC: 0.4413 | MinRP: 0.4644
17/01/2026 16:01:57 >> AUPRC improved: 0.0000 ---> 0.4413 (+0.4413)
17/01/2026 16:01:57 >> Saving checkpoint to ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:01:57 >> ============================================================
17/01/2026 16:01:57 >> >>> Epoch 2/20
17/01/2026 16:02:17 >> Epoch 2 completed | Avg Loss: 0.8614
17/01/2026 16:02:19 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8559 | AUPRC: 0.4827 | MinRP: 0.5070
17/01/2026 16:02:20 >> VAL          Epoch:     2 | AUROC: 0.8457 | AUPRC: 0.5076 | MinRP: 0.5331
17/01/2026 16:02:20 >> AUPRC improved: 0.4413 ---> 0.5076 (+0.0663)
17/01/2026 16:02:20 >> Saving checkpoint to ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:02:20 >> ============================================================
17/01/2026 16:02:20 >> >>> Epoch 3/20
17/01/2026 16:02:39 >> Epoch 3 completed | Avg Loss: 0.8440
17/01/2026 16:02:41 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8630 | AUPRC: 0.5145 | MinRP: 0.5210
17/01/2026 16:02:42 >> VAL          Epoch:     3 | AUROC: 0.8506 | AUPRC: 0.5410 | MinRP: 0.5401
17/01/2026 16:02:42 >> AUPRC improved: 0.5076 ---> 0.5410 (+0.0335)
17/01/2026 16:02:42 >> Saving checkpoint to ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:02:42 >> ============================================================
17/01/2026 16:02:42 >> >>> Epoch 4/20
17/01/2026 16:03:02 >> Epoch 4 completed | Avg Loss: 0.8183
17/01/2026 16:03:04 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8725 | AUPRC: 0.5344 | MinRP: 0.5182
17/01/2026 16:03:05 >> VAL          Epoch:     4 | AUROC: 0.8513 | AUPRC: 0.5423 | MinRP: 0.5345
17/01/2026 16:03:05 >> AUPRC improved: 0.5410 ---> 0.5423 (+0.0013)
17/01/2026 16:03:05 >> Saving checkpoint to ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:03:05 >> ============================================================
17/01/2026 16:03:05 >> >>> Epoch 5/20
17/01/2026 16:03:24 >> Epoch 5 completed | Avg Loss: 0.7874
17/01/2026 16:03:26 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8801 | AUPRC: 0.5664 | MinRP: 0.5552
17/01/2026 16:03:27 >> VAL          Epoch:     5 | AUROC: 0.8567 | AUPRC: 0.5698 | MinRP: 0.5455
17/01/2026 16:03:27 >> AUPRC improved: 0.5423 ---> 0.5698 (+0.0275)
17/01/2026 16:03:27 >> Saving checkpoint to ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:03:27 >> ============================================================
17/01/2026 16:03:27 >> >>> Epoch 6/20
17/01/2026 16:03:46 >> Epoch 6 completed | Avg Loss: 0.7675
17/01/2026 16:03:48 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8804 | AUPRC: 0.5757 | MinRP: 0.5533
17/01/2026 16:03:50 >> VAL          Epoch:     6 | AUROC: 0.8528 | AUPRC: 0.5713 | MinRP: 0.5629
17/01/2026 16:03:50 >> AUPRC improved: 0.5698 ---> 0.5713 (+0.0015)
17/01/2026 16:03:50 >> Saving checkpoint to ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:03:50 >> ============================================================
17/01/2026 16:03:50 >> >>> Epoch 7/20
17/01/2026 16:04:10 >> Epoch 7 completed | Avg Loss: 0.7722
17/01/2026 16:04:12 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8892 | AUPRC: 0.5827 | MinRP: 0.5521
17/01/2026 16:04:13 >> VAL          Epoch:     7 | AUROC: 0.8550 | AUPRC: 0.5660 | MinRP: 0.5571
17/01/2026 16:04:13 >> No improvement. Wait: 4/5
17/01/2026 16:04:13 >> ============================================================
17/01/2026 16:04:13 >> >>> Epoch 8/20
17/01/2026 16:04:33 >> Epoch 8 completed | Avg Loss: 0.7495
17/01/2026 16:04:35 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8934 | AUPRC: 0.5876 | MinRP: 0.5586
17/01/2026 16:04:36 >> VAL          Epoch:     8 | AUROC: 0.8578 | AUPRC: 0.5704 | MinRP: 0.5610
17/01/2026 16:04:36 >> No improvement. Wait: 3/5
17/01/2026 16:04:36 >> ============================================================
17/01/2026 16:04:36 >> >>> Epoch 9/20
17/01/2026 16:04:56 >> Epoch 9 completed | Avg Loss: 0.7572
17/01/2026 16:04:57 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8955 | AUPRC: 0.5760 | MinRP: 0.5889
17/01/2026 16:04:59 >> VAL          Epoch:     9 | AUROC: 0.8599 | AUPRC: 0.5753 | MinRP: 0.5490
17/01/2026 16:04:59 >> AUPRC improved: 0.5713 ---> 0.5753 (+0.0040)
17/01/2026 16:04:59 >> Saving checkpoint to ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:04:59 >> ============================================================
17/01/2026 16:04:59 >> >>> Epoch 10/20
17/01/2026 16:05:19 >> Epoch 10 completed | Avg Loss: 0.7412
17/01/2026 16:05:21 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9007 | AUPRC: 0.5895 | MinRP: 0.5704
17/01/2026 16:05:23 >> VAL          Epoch:    10 | AUROC: 0.8628 | AUPRC: 0.5776 | MinRP: 0.5594
17/01/2026 16:05:23 >> AUPRC improved: 0.5753 ---> 0.5776 (+0.0024)
17/01/2026 16:05:23 >> Saving checkpoint to ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:05:23 >> ============================================================
17/01/2026 16:05:23 >> >>> Epoch 11/20
17/01/2026 16:05:42 >> Epoch 11 completed | Avg Loss: 0.7231
17/01/2026 16:05:43 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8988 | AUPRC: 0.5929 | MinRP: 0.5909
17/01/2026 16:05:44 >> VAL          Epoch:    11 | AUROC: 0.8607 | AUPRC: 0.5628 | MinRP: 0.5315
17/01/2026 16:05:44 >> No improvement. Wait: 4/5
17/01/2026 16:05:44 >> ============================================================
17/01/2026 16:05:44 >> >>> Epoch 12/20
17/01/2026 16:06:00 >> Epoch 12 completed | Avg Loss: 0.7186
17/01/2026 16:06:01 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9042 | AUPRC: 0.6019 | MinRP: 0.5939
17/01/2026 16:06:03 >> VAL          Epoch:    12 | AUROC: 0.8581 | AUPRC: 0.5722 | MinRP: 0.5490
17/01/2026 16:06:03 >> No improvement. Wait: 3/5
17/01/2026 16:06:03 >> ============================================================
17/01/2026 16:06:03 >> >>> Epoch 13/20
17/01/2026 16:06:18 >> Epoch 13 completed | Avg Loss: 0.7098
17/01/2026 16:06:19 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9106 | AUPRC: 0.6203 | MinRP: 0.6119
17/01/2026 16:06:20 >> VAL          Epoch:    13 | AUROC: 0.8577 | AUPRC: 0.5663 | MinRP: 0.5458
17/01/2026 16:06:20 >> No improvement. Wait: 2/5
17/01/2026 16:06:20 >> ============================================================
17/01/2026 16:06:20 >> >>> Epoch 14/20
17/01/2026 16:06:35 >> Epoch 14 completed | Avg Loss: 0.6962
17/01/2026 16:06:36 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9145 | AUPRC: 0.6440 | MinRP: 0.6156
17/01/2026 16:06:38 >> VAL          Epoch:    14 | AUROC: 0.8658 | AUPRC: 0.5839 | MinRP: 0.5540
17/01/2026 16:06:38 >> AUPRC improved: 0.5776 ---> 0.5839 (+0.0062)
17/01/2026 16:06:38 >> Saving checkpoint to ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:06:38 >> ============================================================
17/01/2026 16:06:38 >> >>> Epoch 15/20
17/01/2026 16:06:52 >> Epoch 15 completed | Avg Loss: 0.6932
17/01/2026 16:06:53 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9088 | AUPRC: 0.6190 | MinRP: 0.5874
17/01/2026 16:06:54 >> VAL          Epoch:    15 | AUROC: 0.8551 | AUPRC: 0.5705 | MinRP: 0.5294
17/01/2026 16:06:54 >> No improvement. Wait: 4/5
17/01/2026 16:06:54 >> ============================================================
17/01/2026 16:06:54 >> >>> Epoch 16/20
17/01/2026 16:07:07 >> Epoch 16 completed | Avg Loss: 0.6816
17/01/2026 16:07:09 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9155 | AUPRC: 0.6422 | MinRP: 0.6254
17/01/2026 16:07:10 >> VAL          Epoch:    16 | AUROC: 0.8590 | AUPRC: 0.5669 | MinRP: 0.5331
17/01/2026 16:07:10 >> No improvement. Wait: 3/5
17/01/2026 16:07:10 >> ============================================================
17/01/2026 16:07:10 >> >>> Epoch 17/20
17/01/2026 16:07:22 >> Epoch 17 completed | Avg Loss: 0.6938
17/01/2026 16:07:24 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9204 | AUPRC: 0.6561 | MinRP: 0.6399
17/01/2026 16:07:25 >> VAL          Epoch:    17 | AUROC: 0.8690 | AUPRC: 0.5852 | MinRP: 0.5556
17/01/2026 16:07:25 >> AUPRC improved: 0.5839 ---> 0.5852 (+0.0014)
17/01/2026 16:07:25 >> Saving checkpoint to ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:07:25 >> ============================================================
17/01/2026 16:07:25 >> >>> Epoch 18/20
17/01/2026 16:07:37 >> Epoch 18 completed | Avg Loss: 0.6576
17/01/2026 16:07:38 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9214 | AUPRC: 0.6564 | MinRP: 0.6399
17/01/2026 16:07:40 >> VAL          Epoch:    18 | AUROC: 0.8607 | AUPRC: 0.5597 | MinRP: 0.5331
17/01/2026 16:07:40 >> No improvement. Wait: 4/5
17/01/2026 16:07:40 >> ============================================================
17/01/2026 16:07:40 >> >>> Epoch 19/20
17/01/2026 16:07:53 >> Epoch 19 completed | Avg Loss: 0.6632
17/01/2026 16:07:54 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9235 | AUPRC: 0.6563 | MinRP: 0.6411
17/01/2026 16:07:55 >> VAL          Epoch:    19 | AUROC: 0.8632 | AUPRC: 0.5724 | MinRP: 0.5490
17/01/2026 16:07:55 >> No improvement. Wait: 3/5
17/01/2026 16:07:55 >> ============================================================
17/01/2026 16:07:55 >> >>> Epoch 20/20
17/01/2026 16:08:06 >> Epoch 20 completed | Avg Loss: 0.6419
17/01/2026 16:08:07 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.9271 | AUPRC: 0.6591 | MinRP: 0.6469
17/01/2026 16:08:07 >> VAL          Epoch:    20 | AUROC: 0.8584 | AUPRC: 0.5642 | MinRP: 0.5245
17/01/2026 16:08:07 >> No improvement. Wait: 2/5
17/01/2026 16:08:07 >> ============================================================

17/01/2026 16:08:07 >> ============================================================
17/01/2026 16:08:07 >> TRAINING COMPLETED
17/01/2026 16:08:07 >> ============================================================
17/01/2026 16:08:07 >> Best Validation Results:
17/01/2026 16:08:07 >>   AUROC: 0.8690 | AUPRC: 0.5852 | MinRP: 0.5556
17/01/2026 16:08:07 >> Loading best model from ../outputs/physionet_2012/warpformer|fold:5/checkpoint_best.bin
17/01/2026 16:08:07 >> Evaluating on test set...
17/01/2026 16:08:08 >> TEST         AUROC: 0.8462 | AUPRC: 0.4891 | MinRP: 0.4861 | Accuracy: 0.7946

17/01/2026 16:08:08 >> ============================================================
17/01/2026 16:08:08 >> Classification Report:
17/01/2026 16:08:09 >>               precision    recall  f1-score   support
17/01/2026 16:08:09 >> 
17/01/2026 16:08:09 >>          0.0     0.9480    0.8069    0.8718      2077
17/01/2026 16:08:09 >>          1.0     0.3655    0.7152    0.4838       323
17/01/2026 16:08:09 >> 
17/01/2026 16:08:09 >>     accuracy                         0.7946      2400
17/01/2026 16:08:09 >>    macro avg     0.6567    0.7611    0.6778      2400
17/01/2026 16:08:09 >> weighted avg     0.8696    0.7946    0.8196      2400
17/01/2026 16:08:09 >> 
17/01/2026 16:08:09 >> Confusion Matrix:
17/01/2026 16:08:09 >> [1676, 401]
17/01/2026 16:08:09 >> [92, 231]
17/01/2026 16:08:09 >> ============================================================
17/01/2026 16:08:09 >> Final Test Results:
17/01/2026 16:08:09 >>   AUROC: 0.8462 | AUPRC: 0.4891 | MinRP: 0.4861 | Accuracy: 0.7946
17/01/2026 16:08:09 >> ============================================================
