17/01/2026 18:29:16 >> Namespace(dataset='physionet_2012', model_type='kedgn', split_file='physionet_2012_5fold.json', fold=5, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/kedgn|fold:5', lr=0.001, train_batch_size=256, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=12, query_vector_dim=7, node_emb_dim=7, node_enc_layer=3, rarity_alpha=1.75, logger=<utils.logger.Logger object at 0x75832461e140>)

17/01/2026 18:29:16 >> Preparing dataset physionet_2012
17/01/2026 18:29:16 >> Using fold 5/5
17/01/2026 18:29:16 >> Loaded splits from physionet_2012_5fold.json
17/01/2026 18:29:17 >> # train, val, test TS: [7671, 1917, 2400]
17/01/2026 18:29:17 >> pos class weight: 5.9863
17/01/2026 18:29:17 >> % pos class in train, val, test splits: [0.1431, 0.1492, 0.1346]
17/01/2026 18:29:18 >> # static features: 8
17/01/2026 18:29:18 >> # TS variables: 36
17/01/2026 18:29:19 >> # intervals (hours): 49

17/01/2026 18:29:29 >> Model details:
17/01/2026 18:29:29 >> # parameters: 65909
17/01/2026 18:29:29 >> # trainable parameters: 65909, 100.0%
17/01/2026 18:29:29 >> #params by dtype:
17/01/2026 18:29:29 >> torch.float32: 65909, 100.0%

17/01/2026 18:29:29 >> No. of training batches per epoch = 30

17/01/2026 18:29:29 >> ============================================================
17/01/2026 18:29:29 >>                Starting training...
17/01/2026 18:29:29 >> ============================================================
17/01/2026 18:29:29 >> >>> Epoch 1/20
17/01/2026 18:31:20 >> Epoch 1 completed | Avg Loss: 0.5933
17/01/2026 18:32:16 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8461 | AUPRC: 0.4460 | MinRP: 0.4637
17/01/2026 18:33:49 >> VAL          Epoch:     1 | AUROC: 0.8324 | AUPRC: 0.4594 | MinRP: 0.4784
17/01/2026 18:33:49 >> AUPRC improved: 0.0000 ---> 0.4594 (+0.4594)
17/01/2026 18:33:49 >> Saving checkpoint to ../outputs/physionet_2012/kedgn|fold:5/checkpoint_best.bin
17/01/2026 18:33:49 >> ============================================================
17/01/2026 18:33:49 >> >>> Epoch 2/20
17/01/2026 18:35:48 >> Epoch 2 completed | Avg Loss: 0.4962
17/01/2026 18:36:55 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8600 | AUPRC: 0.4890 | MinRP: 0.4849
17/01/2026 18:38:02 >> VAL          Epoch:     2 | AUROC: 0.8368 | AUPRC: 0.4918 | MinRP: 0.4948
17/01/2026 18:38:02 >> AUPRC improved: 0.4594 ---> 0.4918 (+0.0324)
17/01/2026 18:38:02 >> Saving checkpoint to ../outputs/physionet_2012/kedgn|fold:5/checkpoint_best.bin
17/01/2026 18:38:02 >> ============================================================
17/01/2026 18:38:02 >> >>> Epoch 3/20
17/01/2026 18:40:07 >> Epoch 3 completed | Avg Loss: 0.4794
17/01/2026 18:41:39 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8612 | AUPRC: 0.4889 | MinRP: 0.4799
17/01/2026 18:43:36 >> VAL          Epoch:     3 | AUROC: 0.8452 | AUPRC: 0.5042 | MinRP: 0.4757
17/01/2026 18:43:36 >> AUPRC improved: 0.4918 ---> 0.5042 (+0.0124)
17/01/2026 18:43:36 >> Saving checkpoint to ../outputs/physionet_2012/kedgn|fold:5/checkpoint_best.bin
17/01/2026 18:43:36 >> ============================================================
17/01/2026 18:43:36 >> >>> Epoch 4/20
17/01/2026 18:45:38 >> Epoch 4 completed | Avg Loss: 0.4632
17/01/2026 18:47:23 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8758 | AUPRC: 0.5218 | MinRP: 0.5245
17/01/2026 18:49:03 >> VAL          Epoch:     4 | AUROC: 0.8645 | AUPRC: 0.5584 | MinRP: 0.5350
17/01/2026 18:49:03 >> AUPRC improved: 0.5042 ---> 0.5584 (+0.0541)
17/01/2026 18:49:03 >> Saving checkpoint to ../outputs/physionet_2012/kedgn|fold:5/checkpoint_best.bin
17/01/2026 18:49:03 >> ============================================================
17/01/2026 18:49:03 >> >>> Epoch 5/20
17/01/2026 18:51:37 >> Epoch 5 completed | Avg Loss: 0.4456
17/01/2026 18:53:29 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8826 | AUPRC: 0.5482 | MinRP: 0.5189
17/01/2026 18:55:02 >> VAL          Epoch:     5 | AUROC: 0.8589 | AUPRC: 0.5491 | MinRP: 0.5192
17/01/2026 18:55:02 >> No improvement. Wait: 4/5
17/01/2026 18:55:02 >> ============================================================
17/01/2026 18:55:02 >> >>> Epoch 6/20
17/01/2026 18:57:41 >> Epoch 6 completed | Avg Loss: 0.4366
17/01/2026 18:59:22 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8914 | AUPRC: 0.5776 | MinRP: 0.5679
17/01/2026 19:00:52 >> VAL          Epoch:     6 | AUROC: 0.8679 | AUPRC: 0.5677 | MinRP: 0.5455
17/01/2026 19:00:52 >> AUPRC improved: 0.5584 ---> 0.5677 (+0.0093)
17/01/2026 19:00:52 >> Saving checkpoint to ../outputs/physionet_2012/kedgn|fold:5/checkpoint_best.bin
17/01/2026 19:00:52 >> ============================================================
17/01/2026 19:00:52 >> >>> Epoch 7/20
17/01/2026 19:03:33 >> Epoch 7 completed | Avg Loss: 0.4218
17/01/2026 19:05:18 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8935 | AUPRC: 0.5704 | MinRP: 0.5470
17/01/2026 19:07:01 >> VAL          Epoch:     7 | AUROC: 0.8614 | AUPRC: 0.5452 | MinRP: 0.5315
17/01/2026 19:07:01 >> No improvement. Wait: 4/5
17/01/2026 19:07:01 >> ============================================================
17/01/2026 19:07:01 >> >>> Epoch 8/20
17/01/2026 19:09:33 >> Epoch 8 completed | Avg Loss: 0.4121
17/01/2026 19:11:17 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9018 | AUPRC: 0.6047 | MinRP: 0.5804
17/01/2026 19:12:55 >> VAL          Epoch:     8 | AUROC: 0.8679 | AUPRC: 0.5731 | MinRP: 0.5455
17/01/2026 19:12:55 >> AUPRC improved: 0.5677 ---> 0.5731 (+0.0054)
17/01/2026 19:12:55 >> Saving checkpoint to ../outputs/physionet_2012/kedgn|fold:5/checkpoint_best.bin
17/01/2026 19:12:55 >> ============================================================
17/01/2026 19:12:55 >> >>> Epoch 9/20
17/01/2026 19:15:32 >> Epoch 9 completed | Avg Loss: 0.4045
17/01/2026 19:17:15 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9061 | AUPRC: 0.6090 | MinRP: 0.5958
17/01/2026 19:18:53 >> VAL          Epoch:     9 | AUROC: 0.8739 | AUPRC: 0.5800 | MinRP: 0.5559
17/01/2026 19:18:53 >> AUPRC improved: 0.5731 ---> 0.5800 (+0.0069)
17/01/2026 19:18:53 >> Saving checkpoint to ../outputs/physionet_2012/kedgn|fold:5/checkpoint_best.bin
17/01/2026 19:18:53 >> ============================================================
17/01/2026 19:18:53 >> >>> Epoch 10/20
17/01/2026 19:21:29 >> Epoch 10 completed | Avg Loss: 0.4008
17/01/2026 19:23:08 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9111 | AUPRC: 0.6329 | MinRP: 0.6014
17/01/2026 19:24:50 >> VAL          Epoch:    10 | AUROC: 0.8709 | AUPRC: 0.5778 | MinRP: 0.5245
17/01/2026 19:24:50 >> No improvement. Wait: 4/5
17/01/2026 19:24:50 >> ============================================================
17/01/2026 19:24:50 >> >>> Epoch 11/20
17/01/2026 19:27:20 >> Epoch 11 completed | Avg Loss: 0.3851
17/01/2026 19:28:41 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9145 | AUPRC: 0.6424 | MinRP: 0.6212
17/01/2026 19:30:00 >> VAL          Epoch:    11 | AUROC: 0.8728 | AUPRC: 0.5794 | MinRP: 0.5398
17/01/2026 19:30:00 >> No improvement. Wait: 3/5
17/01/2026 19:30:00 >> ============================================================
17/01/2026 19:30:00 >> >>> Epoch 12/20
17/01/2026 19:31:54 >> Epoch 12 completed | Avg Loss: 0.3802
17/01/2026 19:33:07 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9198 | AUPRC: 0.6476 | MinRP: 0.6224
17/01/2026 19:34:33 >> VAL          Epoch:    12 | AUROC: 0.8746 | AUPRC: 0.5910 | MinRP: 0.5540
17/01/2026 19:34:33 >> AUPRC improved: 0.5800 ---> 0.5910 (+0.0110)
17/01/2026 19:34:33 >> Saving checkpoint to ../outputs/physionet_2012/kedgn|fold:5/checkpoint_best.bin
17/01/2026 19:34:33 >> ============================================================
17/01/2026 19:34:33 >> >>> Epoch 13/20
17/01/2026 19:36:47 >> Epoch 13 completed | Avg Loss: 0.3745
17/01/2026 19:38:10 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9248 | AUPRC: 0.6710 | MinRP: 0.6436
17/01/2026 19:39:32 >> VAL          Epoch:    13 | AUROC: 0.8732 | AUPRC: 0.5816 | MinRP: 0.5490
17/01/2026 19:39:32 >> No improvement. Wait: 4/5
17/01/2026 19:39:32 >> ============================================================
17/01/2026 19:39:32 >> >>> Epoch 14/20
17/01/2026 19:41:38 >> Epoch 14 completed | Avg Loss: 0.3621
17/01/2026 19:43:02 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9253 | AUPRC: 0.6640 | MinRP: 0.6609
17/01/2026 19:44:27 >> VAL          Epoch:    14 | AUROC: 0.8712 | AUPRC: 0.5710 | MinRP: 0.5350
17/01/2026 19:44:27 >> No improvement. Wait: 3/5
17/01/2026 19:44:27 >> ============================================================
17/01/2026 19:44:27 >> >>> Epoch 15/20
17/01/2026 19:46:32 >> Epoch 15 completed | Avg Loss: 0.3528
17/01/2026 19:47:36 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9308 | AUPRC: 0.6797 | MinRP: 0.6667
17/01/2026 19:48:28 >> VAL          Epoch:    15 | AUROC: 0.8647 | AUPRC: 0.5585 | MinRP: 0.5312
17/01/2026 19:48:28 >> No improvement. Wait: 2/5
17/01/2026 19:48:28 >> ============================================================
17/01/2026 19:48:28 >> >>> Epoch 16/20
17/01/2026 19:50:00 >> Epoch 16 completed | Avg Loss: 0.3413
17/01/2026 19:50:53 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9358 | AUPRC: 0.7050 | MinRP: 0.6794
17/01/2026 19:51:21 >> VAL          Epoch:    16 | AUROC: 0.8678 | AUPRC: 0.5667 | MinRP: 0.5261
17/01/2026 19:51:21 >> No improvement. Wait: 1/5
17/01/2026 19:51:21 >> ============================================================
17/01/2026 19:51:21 >> >>> Epoch 17/20
17/01/2026 19:51:43 >> Epoch 17 completed | Avg Loss: 0.3371
17/01/2026 19:51:52 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9407 | AUPRC: 0.7132 | MinRP: 0.6888
17/01/2026 19:52:00 >> VAL          Epoch:    17 | AUROC: 0.8673 | AUPRC: 0.5603 | MinRP: 0.5420
17/01/2026 19:52:00 >> No improvement. Wait: 0/5
17/01/2026 19:52:00 >> Patience reached. Early stopping.

17/01/2026 19:52:00 >> ============================================================
17/01/2026 19:52:00 >> TRAINING COMPLETED
17/01/2026 19:52:00 >> ============================================================
17/01/2026 19:52:00 >> Best Validation Results:
17/01/2026 19:52:00 >>   AUROC: 0.8746 | AUPRC: 0.5910 | MinRP: 0.5540
17/01/2026 19:52:00 >> Loading best model from ../outputs/physionet_2012/kedgn|fold:5/checkpoint_best.bin
17/01/2026 19:52:00 >> Evaluating on test set...
17/01/2026 19:52:11 >> TEST         AUROC: 0.8649 | AUPRC: 0.5101 | MinRP: 0.5000 | Accuracy: 0.8271

17/01/2026 19:52:11 >> ============================================================
17/01/2026 19:52:11 >> Classification Report:
17/01/2026 19:52:11 >>               precision    recall  f1-score   support
17/01/2026 19:52:11 >> 
17/01/2026 19:52:11 >>          0.0     0.9453    0.8493    0.8948      2077
17/01/2026 19:52:11 >>          1.0     0.4139    0.6842    0.5158       323
17/01/2026 19:52:11 >> 
17/01/2026 19:52:11 >>     accuracy                         0.8271      2400
17/01/2026 19:52:11 >>    macro avg     0.6796    0.7668    0.7053      2400
17/01/2026 19:52:11 >> weighted avg     0.8738    0.8271    0.8437      2400
17/01/2026 19:52:11 >> 
17/01/2026 19:52:11 >> Confusion Matrix:
17/01/2026 19:52:11 >> [1764, 313]
17/01/2026 19:52:11 >> [102, 221]
17/01/2026 19:52:11 >> ============================================================
17/01/2026 19:52:11 >> Final Test Results:
17/01/2026 19:52:11 >>   AUROC: 0.8649 | AUPRC: 0.5101 | MinRP: 0.5000 | Accuracy: 0.8271
17/01/2026 19:52:11 >> ============================================================
