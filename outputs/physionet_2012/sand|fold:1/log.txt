24/01/2026 06:26:07 >> Namespace(dataset='physionet_2012', model_type='sand', split_file='physionet_2012_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/sand|fold:1', lr=0.001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=64, num_layers=2, num_heads=4, dropout=0.2, r=10, M=16, logger=<utils.logger.Logger object at 0x7fe02361e140>)

24/01/2026 06:26:07 >> Preparing dataset physionet_2012
24/01/2026 06:26:07 >> Using fold 1/5
24/01/2026 06:26:07 >> Loaded splits from physionet_2012_5fold.json
24/01/2026 06:26:08 >> # train, val, test TS: [7673, 1918, 2397]
24/01/2026 06:26:08 >> pos class weight: 6.0330
24/01/2026 06:26:08 >> % pos class in train, val, test splits: [0.1422, 0.1283, 0.1544]
24/01/2026 06:26:09 >> # static features: 8
24/01/2026 06:26:09 >> # TS variables (SAND): 36
24/01/2026 06:26:10 >> # timesteps (hours): 49
24/01/2026 06:26:15 >> Input shape: [N, 49, 108]

24/01/2026 06:26:16 >> Model details:
24/01/2026 06:26:16 >> # parameters: 90226
24/01/2026 06:26:16 >> # trainable parameters: 87041, 96.46997539511892%
24/01/2026 06:26:16 >> #params by dtype:
24/01/2026 06:26:16 >> torch.float32: 90226, 100.0%

24/01/2026 06:26:16 >> No. of training batches per epoch = 240

24/01/2026 06:26:16 >> ============================================================
24/01/2026 06:26:16 >>                Starting training...
24/01/2026 06:26:16 >> ============================================================
24/01/2026 06:26:16 >> >>> Epoch 1/20
24/01/2026 06:26:18 >> Epoch 1 completed | Avg Loss: 1.4514
24/01/2026 06:26:18 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8340 | AUPRC: 0.4481 | MinRP: 0.4570
24/01/2026 06:26:18 >> VAL          Epoch:     1 | AUROC: 0.8354 | AUPRC: 0.4769 | MinRP: 0.4819
24/01/2026 06:26:18 >> AUPRC improved: 0.0000 ---> 0.4769 (+0.4769)
24/01/2026 06:26:18 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:1/checkpoint_best.bin
24/01/2026 06:26:18 >> ============================================================
24/01/2026 06:26:18 >> >>> Epoch 2/20
24/01/2026 06:26:20 >> Epoch 2 completed | Avg Loss: 1.0886
24/01/2026 06:26:20 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8559 | AUPRC: 0.4956 | MinRP: 0.4880
24/01/2026 06:26:20 >> VAL          Epoch:     2 | AUROC: 0.8505 | AUPRC: 0.4996 | MinRP: 0.5040
24/01/2026 06:26:20 >> AUPRC improved: 0.4769 ---> 0.4996 (+0.0227)
24/01/2026 06:26:20 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:1/checkpoint_best.bin
24/01/2026 06:26:20 >> ============================================================
24/01/2026 06:26:20 >> >>> Epoch 3/20
24/01/2026 06:26:21 >> Epoch 3 completed | Avg Loss: 1.0157
24/01/2026 06:26:21 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8532 | AUPRC: 0.5017 | MinRP: 0.4830
24/01/2026 06:26:21 >> VAL          Epoch:     3 | AUROC: 0.8410 | AUPRC: 0.4834 | MinRP: 0.4959
24/01/2026 06:26:21 >> No improvement. Wait: 4/5
24/01/2026 06:26:21 >> ============================================================
24/01/2026 06:26:21 >> >>> Epoch 4/20
24/01/2026 06:26:23 >> Epoch 4 completed | Avg Loss: 1.0156
24/01/2026 06:26:23 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8493 | AUPRC: 0.5031 | MinRP: 0.4916
24/01/2026 06:26:23 >> VAL          Epoch:     4 | AUROC: 0.8333 | AUPRC: 0.4545 | MinRP: 0.4567
24/01/2026 06:26:23 >> No improvement. Wait: 3/5
24/01/2026 06:26:23 >> ============================================================
24/01/2026 06:26:23 >> >>> Epoch 5/20
24/01/2026 06:26:25 >> Epoch 5 completed | Avg Loss: 0.9520
24/01/2026 06:26:25 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8654 | AUPRC: 0.5295 | MinRP: 0.5308
24/01/2026 06:26:25 >> VAL          Epoch:     5 | AUROC: 0.8517 | AUPRC: 0.5066 | MinRP: 0.5041
24/01/2026 06:26:25 >> AUPRC improved: 0.4996 ---> 0.5066 (+0.0070)
24/01/2026 06:26:25 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:1/checkpoint_best.bin
24/01/2026 06:26:25 >> ============================================================
24/01/2026 06:26:25 >> >>> Epoch 6/20
24/01/2026 06:26:26 >> Epoch 6 completed | Avg Loss: 0.9362
24/01/2026 06:26:26 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8630 | AUPRC: 0.5024 | MinRP: 0.4845
24/01/2026 06:26:26 >> VAL          Epoch:     6 | AUROC: 0.8491 | AUPRC: 0.4967 | MinRP: 0.4959
24/01/2026 06:26:26 >> No improvement. Wait: 4/5
24/01/2026 06:26:26 >> ============================================================
24/01/2026 06:26:26 >> >>> Epoch 7/20
24/01/2026 06:26:28 >> Epoch 7 completed | Avg Loss: 0.9384
24/01/2026 06:26:28 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8585 | AUPRC: 0.5119 | MinRP: 0.5137
24/01/2026 06:26:28 >> VAL          Epoch:     7 | AUROC: 0.8323 | AUPRC: 0.4513 | MinRP: 0.4575
24/01/2026 06:26:28 >> No improvement. Wait: 3/5
24/01/2026 06:26:28 >> ============================================================
24/01/2026 06:26:28 >> >>> Epoch 8/20
24/01/2026 06:26:29 >> Epoch 8 completed | Avg Loss: 0.9175
24/01/2026 06:26:29 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8706 | AUPRC: 0.5346 | MinRP: 0.5137
24/01/2026 06:26:29 >> VAL          Epoch:     8 | AUROC: 0.8489 | AUPRC: 0.4966 | MinRP: 0.4921
24/01/2026 06:26:29 >> No improvement. Wait: 2/5
24/01/2026 06:26:29 >> ============================================================
24/01/2026 06:26:29 >> >>> Epoch 9/20
24/01/2026 06:26:31 >> Epoch 9 completed | Avg Loss: 0.9508
24/01/2026 06:26:31 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8734 | AUPRC: 0.5296 | MinRP: 0.5217
24/01/2026 06:26:31 >> VAL          Epoch:     9 | AUROC: 0.8536 | AUPRC: 0.5078 | MinRP: 0.4960
24/01/2026 06:26:31 >> AUPRC improved: 0.5066 ---> 0.5078 (+0.0012)
24/01/2026 06:26:31 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:1/checkpoint_best.bin
24/01/2026 06:26:31 >> ============================================================
24/01/2026 06:26:31 >> >>> Epoch 10/20
24/01/2026 06:26:32 >> Epoch 10 completed | Avg Loss: 0.9243
24/01/2026 06:26:32 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8745 | AUPRC: 0.5274 | MinRP: 0.5324
24/01/2026 06:26:33 >> VAL          Epoch:    10 | AUROC: 0.8508 | AUPRC: 0.4962 | MinRP: 0.5000
24/01/2026 06:26:33 >> No improvement. Wait: 4/5
24/01/2026 06:26:33 >> ============================================================
24/01/2026 06:26:33 >> >>> Epoch 11/20
24/01/2026 06:26:34 >> Epoch 11 completed | Avg Loss: 0.8891
24/01/2026 06:26:34 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8736 | AUPRC: 0.5382 | MinRP: 0.5258
24/01/2026 06:26:34 >> VAL          Epoch:    11 | AUROC: 0.8435 | AUPRC: 0.4806 | MinRP: 0.4553
24/01/2026 06:26:34 >> No improvement. Wait: 3/5
24/01/2026 06:26:34 >> ============================================================
24/01/2026 06:26:34 >> >>> Epoch 12/20
24/01/2026 06:26:36 >> Epoch 12 completed | Avg Loss: 0.8759
24/01/2026 06:26:36 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8729 | AUPRC: 0.5243 | MinRP: 0.5171
24/01/2026 06:26:36 >> VAL          Epoch:    12 | AUROC: 0.8551 | AUPRC: 0.5136 | MinRP: 0.5122
24/01/2026 06:26:36 >> AUPRC improved: 0.5078 ---> 0.5136 (+0.0058)
24/01/2026 06:26:36 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:1/checkpoint_best.bin
24/01/2026 06:26:36 >> ============================================================
24/01/2026 06:26:36 >> >>> Epoch 13/20
24/01/2026 06:26:38 >> Epoch 13 completed | Avg Loss: 0.8814
24/01/2026 06:26:38 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8753 | AUPRC: 0.5372 | MinRP: 0.5274
24/01/2026 06:26:38 >> VAL          Epoch:    13 | AUROC: 0.8513 | AUPRC: 0.5004 | MinRP: 0.5060
24/01/2026 06:26:38 >> No improvement. Wait: 4/5
24/01/2026 06:26:38 >> ============================================================
24/01/2026 06:26:38 >> >>> Epoch 14/20
24/01/2026 06:26:39 >> Epoch 14 completed | Avg Loss: 0.8569
24/01/2026 06:26:40 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8782 | AUPRC: 0.5416 | MinRP: 0.5155
24/01/2026 06:26:40 >> VAL          Epoch:    14 | AUROC: 0.8517 | AUPRC: 0.4995 | MinRP: 0.5081
24/01/2026 06:26:40 >> No improvement. Wait: 3/5
24/01/2026 06:26:40 >> ============================================================
24/01/2026 06:26:40 >> >>> Epoch 15/20
24/01/2026 06:26:41 >> Epoch 15 completed | Avg Loss: 0.8348
24/01/2026 06:26:41 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.8869 | AUPRC: 0.5736 | MinRP: 0.5292
24/01/2026 06:26:41 >> VAL          Epoch:    15 | AUROC: 0.8466 | AUPRC: 0.4870 | MinRP: 0.4919
24/01/2026 06:26:41 >> No improvement. Wait: 2/5
24/01/2026 06:26:41 >> ============================================================
24/01/2026 06:26:41 >> >>> Epoch 16/20
24/01/2026 06:26:42 >> Epoch 16 completed | Avg Loss: 0.8263
24/01/2026 06:26:43 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.8894 | AUPRC: 0.5634 | MinRP: 0.5612
24/01/2026 06:26:43 >> VAL          Epoch:    16 | AUROC: 0.8526 | AUPRC: 0.5093 | MinRP: 0.5163
24/01/2026 06:26:43 >> No improvement. Wait: 1/5
24/01/2026 06:26:43 >> ============================================================
24/01/2026 06:26:43 >> >>> Epoch 17/20
24/01/2026 06:26:44 >> Epoch 17 completed | Avg Loss: 0.8208
24/01/2026 06:26:44 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.8862 | AUPRC: 0.5617 | MinRP: 0.5430
24/01/2026 06:26:44 >> VAL          Epoch:    17 | AUROC: 0.8485 | AUPRC: 0.5035 | MinRP: 0.5060
24/01/2026 06:26:44 >> No improvement. Wait: 0/5
24/01/2026 06:26:44 >> Patience reached. Early stopping.

24/01/2026 06:26:44 >> ============================================================
24/01/2026 06:26:44 >> TRAINING COMPLETED
24/01/2026 06:26:44 >> ============================================================
24/01/2026 06:26:44 >> Best Validation Results:
24/01/2026 06:26:44 >>   AUROC: 0.8551 | AUPRC: 0.5136 | MinRP: 0.5122
24/01/2026 06:26:44 >> Loading best model from ../outputs/physionet_2012/sand|fold:1/checkpoint_best.bin
24/01/2026 06:26:44 >> Evaluating on test set...
24/01/2026 06:26:44 >> TEST         AUROC: 0.8352 | AUPRC: 0.5359 | MinRP: 0.5040 | Accuracy: 0.8068

24/01/2026 06:26:44 >> ============================================================
24/01/2026 06:26:44 >> Classification Report:
24/01/2026 06:26:44 >>               precision    recall  f1-score   support
24/01/2026 06:26:44 >> 
24/01/2026 06:26:44 >>          0.0     0.9320    0.8323    0.8793      2027
24/01/2026 06:26:44 >>          1.0     0.4208    0.6676    0.5162       370
24/01/2026 06:26:44 >> 
24/01/2026 06:26:44 >>     accuracy                         0.8068      2397
24/01/2026 06:26:44 >>    macro avg     0.6764    0.7499    0.6978      2397
24/01/2026 06:26:44 >> weighted avg     0.8531    0.8068    0.8233      2397
24/01/2026 06:26:44 >> 
24/01/2026 06:26:44 >> Confusion Matrix:
24/01/2026 06:26:44 >> [1687, 340]
24/01/2026 06:26:44 >> [123, 247]
24/01/2026 06:26:44 >> ============================================================
24/01/2026 06:26:44 >> Final Test Results:
24/01/2026 06:26:44 >>   AUROC: 0.8352 | AUPRC: 0.5359 | MinRP: 0.5040 | Accuracy: 0.8068
24/01/2026 06:26:44 >> ============================================================
