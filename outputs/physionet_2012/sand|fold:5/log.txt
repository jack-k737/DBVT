24/01/2026 06:28:34 >> Namespace(dataset='physionet_2012', model_type='sand', split_file='physionet_2012_5fold.json', fold=5, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/sand|fold:5', lr=0.001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=64, num_layers=2, num_heads=4, dropout=0.2, r=10, M=16, logger=<utils.logger.Logger object at 0x7ac53a01e140>)

24/01/2026 06:28:34 >> Preparing dataset physionet_2012
24/01/2026 06:28:34 >> Using fold 5/5
24/01/2026 06:28:34 >> Loaded splits from physionet_2012_5fold.json
24/01/2026 06:28:35 >> # train, val, test TS: [7671, 1917, 2400]
24/01/2026 06:28:35 >> pos class weight: 5.9863
24/01/2026 06:28:35 >> % pos class in train, val, test splits: [0.1431, 0.1492, 0.1346]
24/01/2026 06:28:35 >> # static features: 8
24/01/2026 06:28:36 >> # TS variables (SAND): 36
24/01/2026 06:28:37 >> # timesteps (hours): 49
24/01/2026 06:28:42 >> Input shape: [N, 49, 108]

24/01/2026 06:28:43 >> Model details:
24/01/2026 06:28:43 >> # parameters: 90226
24/01/2026 06:28:43 >> # trainable parameters: 87041, 96.46997539511892%
24/01/2026 06:28:43 >> #params by dtype:
24/01/2026 06:28:43 >> torch.float32: 90226, 100.0%

24/01/2026 06:28:43 >> No. of training batches per epoch = 240

24/01/2026 06:28:43 >> ============================================================
24/01/2026 06:28:43 >>                Starting training...
24/01/2026 06:28:43 >> ============================================================
24/01/2026 06:28:43 >> >>> Epoch 1/20
24/01/2026 06:28:45 >> Epoch 1 completed | Avg Loss: 1.4601
24/01/2026 06:28:45 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8471 | AUPRC: 0.4909 | MinRP: 0.4881
24/01/2026 06:28:45 >> VAL          Epoch:     1 | AUROC: 0.8246 | AUPRC: 0.5033 | MinRP: 0.4650
24/01/2026 06:28:45 >> AUPRC improved: 0.0000 ---> 0.5033 (+0.5033)
24/01/2026 06:28:45 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:5/checkpoint_best.bin
24/01/2026 06:28:45 >> ============================================================
24/01/2026 06:28:45 >> >>> Epoch 2/20
24/01/2026 06:28:46 >> Epoch 2 completed | Avg Loss: 1.0810
24/01/2026 06:28:46 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8513 | AUPRC: 0.5022 | MinRP: 0.4885
24/01/2026 06:28:46 >> VAL          Epoch:     2 | AUROC: 0.8328 | AUPRC: 0.5125 | MinRP: 0.4825
24/01/2026 06:28:46 >> AUPRC improved: 0.5033 ---> 0.5125 (+0.0093)
24/01/2026 06:28:46 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:5/checkpoint_best.bin
24/01/2026 06:28:46 >> ============================================================
24/01/2026 06:28:46 >> >>> Epoch 3/20
24/01/2026 06:28:48 >> Epoch 3 completed | Avg Loss: 1.0901
24/01/2026 06:28:48 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8630 | AUPRC: 0.5314 | MinRP: 0.5192
24/01/2026 06:28:48 >> VAL          Epoch:     3 | AUROC: 0.8420 | AUPRC: 0.5306 | MinRP: 0.5105
24/01/2026 06:28:48 >> AUPRC improved: 0.5125 ---> 0.5306 (+0.0181)
24/01/2026 06:28:48 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:5/checkpoint_best.bin
24/01/2026 06:28:48 >> ============================================================
24/01/2026 06:28:48 >> >>> Epoch 4/20
24/01/2026 06:28:49 >> Epoch 4 completed | Avg Loss: 1.0223
24/01/2026 06:28:49 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8519 | AUPRC: 0.5063 | MinRP: 0.4871
24/01/2026 06:28:49 >> VAL          Epoch:     4 | AUROC: 0.8247 | AUPRC: 0.5012 | MinRP: 0.4688
24/01/2026 06:28:49 >> No improvement. Wait: 4/5
24/01/2026 06:28:49 >> ============================================================
24/01/2026 06:28:49 >> >>> Epoch 5/20
24/01/2026 06:28:51 >> Epoch 5 completed | Avg Loss: 0.9952
24/01/2026 06:28:51 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8617 | AUPRC: 0.5298 | MinRP: 0.5261
24/01/2026 06:28:51 >> VAL          Epoch:     5 | AUROC: 0.8395 | AUPRC: 0.5262 | MinRP: 0.4825
24/01/2026 06:28:51 >> No improvement. Wait: 3/5
24/01/2026 06:28:51 >> ============================================================
24/01/2026 06:28:51 >> >>> Epoch 6/20
24/01/2026 06:28:52 >> Epoch 6 completed | Avg Loss: 1.0178
24/01/2026 06:28:52 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8693 | AUPRC: 0.5413 | MinRP: 0.5315
24/01/2026 06:28:52 >> VAL          Epoch:     6 | AUROC: 0.8486 | AUPRC: 0.5481 | MinRP: 0.5035
24/01/2026 06:28:52 >> AUPRC improved: 0.5306 ---> 0.5481 (+0.0175)
24/01/2026 06:28:52 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:5/checkpoint_best.bin
24/01/2026 06:28:52 >> ============================================================
24/01/2026 06:28:52 >> >>> Epoch 7/20
24/01/2026 06:28:54 >> Epoch 7 completed | Avg Loss: 0.9643
24/01/2026 06:28:54 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8718 | AUPRC: 0.5304 | MinRP: 0.5322
24/01/2026 06:28:54 >> VAL          Epoch:     7 | AUROC: 0.8454 | AUPRC: 0.5274 | MinRP: 0.5070
24/01/2026 06:28:54 >> No improvement. Wait: 4/5
24/01/2026 06:28:54 >> ============================================================
24/01/2026 06:28:54 >> >>> Epoch 8/20
24/01/2026 06:28:55 >> Epoch 8 completed | Avg Loss: 0.9463
24/01/2026 06:28:55 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8711 | AUPRC: 0.5470 | MinRP: 0.5296
24/01/2026 06:28:55 >> VAL          Epoch:     8 | AUROC: 0.8432 | AUPRC: 0.5394 | MinRP: 0.5034
24/01/2026 06:28:55 >> No improvement. Wait: 3/5
24/01/2026 06:28:55 >> ============================================================
24/01/2026 06:28:55 >> >>> Epoch 9/20
24/01/2026 06:28:57 >> Epoch 9 completed | Avg Loss: 0.9241
24/01/2026 06:28:57 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8760 | AUPRC: 0.5437 | MinRP: 0.5372
24/01/2026 06:28:57 >> VAL          Epoch:     9 | AUROC: 0.8460 | AUPRC: 0.5255 | MinRP: 0.5035
24/01/2026 06:28:57 >> No improvement. Wait: 2/5
24/01/2026 06:28:57 >> ============================================================
24/01/2026 06:28:57 >> >>> Epoch 10/20
24/01/2026 06:28:59 >> Epoch 10 completed | Avg Loss: 0.9317
24/01/2026 06:28:59 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8741 | AUPRC: 0.5473 | MinRP: 0.5347
24/01/2026 06:28:59 >> VAL          Epoch:    10 | AUROC: 0.8501 | AUPRC: 0.5395 | MinRP: 0.4983
24/01/2026 06:28:59 >> No improvement. Wait: 1/5
24/01/2026 06:28:59 >> ============================================================
24/01/2026 06:28:59 >> >>> Epoch 11/20
24/01/2026 06:29:01 >> Epoch 11 completed | Avg Loss: 0.8886
24/01/2026 06:29:01 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8696 | AUPRC: 0.5391 | MinRP: 0.5070
24/01/2026 06:29:01 >> VAL          Epoch:    11 | AUROC: 0.8434 | AUPRC: 0.5411 | MinRP: 0.4983
24/01/2026 06:29:01 >> No improvement. Wait: 0/5
24/01/2026 06:29:01 >> Patience reached. Early stopping.

24/01/2026 06:29:01 >> ============================================================
24/01/2026 06:29:01 >> TRAINING COMPLETED
24/01/2026 06:29:01 >> ============================================================
24/01/2026 06:29:01 >> Best Validation Results:
24/01/2026 06:29:01 >>   AUROC: 0.8486 | AUPRC: 0.5481 | MinRP: 0.5035
24/01/2026 06:29:01 >> Loading best model from ../outputs/physionet_2012/sand|fold:5/checkpoint_best.bin
24/01/2026 06:29:01 >> Evaluating on test set...
24/01/2026 06:29:01 >> TEST         AUROC: 0.8413 | AUPRC: 0.4591 | MinRP: 0.4863 | Accuracy: 0.6725

24/01/2026 06:29:01 >> ============================================================
24/01/2026 06:29:01 >> Classification Report:
24/01/2026 06:29:01 >>               precision    recall  f1-score   support
24/01/2026 06:29:01 >> 
24/01/2026 06:29:01 >>          0.0     0.9722    0.6399    0.7718      2077
24/01/2026 06:29:01 >>          1.0     0.2759    0.8824    0.4204       323
24/01/2026 06:29:01 >> 
24/01/2026 06:29:01 >>     accuracy                         0.6725      2400
24/01/2026 06:29:01 >>    macro avg     0.6240    0.7611    0.5961      2400
24/01/2026 06:29:01 >> weighted avg     0.8785    0.6725    0.7245      2400
24/01/2026 06:29:01 >> 
24/01/2026 06:29:01 >> Confusion Matrix:
24/01/2026 06:29:01 >> [1329, 748]
24/01/2026 06:29:01 >> [38, 285]
24/01/2026 06:29:01 >> ============================================================
24/01/2026 06:29:01 >> Final Test Results:
24/01/2026 06:29:01 >>   AUROC: 0.8413 | AUPRC: 0.4591 | MinRP: 0.4863 | Accuracy: 0.6725
24/01/2026 06:29:01 >> ============================================================
