17/01/2026 20:23:48 >> Namespace(dataset='physionet_2012', model_type='raindrop', split_file='physionet_2012_5fold.json', fold=4, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/raindrop|fold:4', lr=0.0008, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=3.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=128, num_layers=2, num_heads=4, dropout=0.18, logger=<utils.logger.Logger object at 0x7b0f13b06140>)

17/01/2026 20:23:48 >> Preparing dataset physionet_2012
17/01/2026 20:23:48 >> Using fold 4/5
17/01/2026 20:23:48 >> Loaded splits from physionet_2012_5fold.json
17/01/2026 20:23:49 >> # train, val, test TS: [7673, 1918, 2397]
17/01/2026 20:23:49 >> pos class weight: 6.0201
17/01/2026 20:23:49 >> % pos class in train, val, test splits: [0.1424, 0.1423, 0.1423]
17/01/2026 20:23:50 >> # static features: 8
17/01/2026 20:23:50 >> # TS variables: 36
17/01/2026 20:23:52 >> # timesteps (Raindrop): 49

17/01/2026 20:23:57 >> Model details:
17/01/2026 20:23:57 >> # parameters: 862438
17/01/2026 20:23:57 >> # trainable parameters: 862438, 100.0%
17/01/2026 20:23:57 >> #params by dtype:
17/01/2026 20:23:57 >> torch.float32: 862438, 100.0%

17/01/2026 20:23:57 >> No. of training batches per epoch = 240

17/01/2026 20:23:57 >> ============================================================
17/01/2026 20:23:57 >>                Starting training...
17/01/2026 20:23:57 >> ============================================================
17/01/2026 20:23:57 >> >>> Epoch 1/20
17/01/2026 20:24:12 >> Epoch 1 completed | Avg Loss: 0.6779
17/01/2026 20:24:14 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.7595 | AUPRC: 0.3687 | MinRP: 0.3738
17/01/2026 20:24:16 >> VAL          Epoch:     1 | AUROC: 0.7452 | AUPRC: 0.3123 | MinRP: 0.3527
17/01/2026 20:24:16 >> AUPRC improved: 0.0000 ---> 0.3123 (+0.3123)
17/01/2026 20:24:16 >> Saving checkpoint to ../outputs/physionet_2012/raindrop|fold:4/checkpoint_best.bin
17/01/2026 20:24:16 >> ============================================================
17/01/2026 20:24:16 >> >>> Epoch 2/20
17/01/2026 20:24:29 >> Epoch 2 completed | Avg Loss: 0.5777
17/01/2026 20:24:31 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8090 | AUPRC: 0.4508 | MinRP: 0.4500
17/01/2026 20:24:33 >> VAL          Epoch:     2 | AUROC: 0.7847 | AUPRC: 0.3836 | MinRP: 0.4029
17/01/2026 20:24:33 >> AUPRC improved: 0.3123 ---> 0.3836 (+0.0713)
17/01/2026 20:24:33 >> Saving checkpoint to ../outputs/physionet_2012/raindrop|fold:4/checkpoint_best.bin
17/01/2026 20:24:33 >> ============================================================
17/01/2026 20:24:33 >> >>> Epoch 3/20
17/01/2026 20:24:47 >> Epoch 3 completed | Avg Loss: 0.5336
17/01/2026 20:24:49 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8301 | AUPRC: 0.4723 | MinRP: 0.4467
17/01/2026 20:24:51 >> VAL          Epoch:     3 | AUROC: 0.7936 | AUPRC: 0.3844 | MinRP: 0.4066
17/01/2026 20:24:51 >> AUPRC improved: 0.3836 ---> 0.3844 (+0.0008)
17/01/2026 20:24:51 >> Saving checkpoint to ../outputs/physionet_2012/raindrop|fold:4/checkpoint_best.bin
17/01/2026 20:24:51 >> ============================================================
17/01/2026 20:24:51 >> >>> Epoch 4/20
17/01/2026 20:25:04 >> Epoch 4 completed | Avg Loss: 0.5044
17/01/2026 20:25:06 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8463 | AUPRC: 0.5044 | MinRP: 0.4790
17/01/2026 20:25:08 >> VAL          Epoch:     4 | AUROC: 0.8019 | AUPRC: 0.4143 | MinRP: 0.4194
17/01/2026 20:25:08 >> AUPRC improved: 0.3844 ---> 0.4143 (+0.0299)
17/01/2026 20:25:08 >> Saving checkpoint to ../outputs/physionet_2012/raindrop|fold:4/checkpoint_best.bin
17/01/2026 20:25:08 >> ============================================================
17/01/2026 20:25:08 >> >>> Epoch 5/20
17/01/2026 20:25:22 >> Epoch 5 completed | Avg Loss: 0.4882
17/01/2026 20:25:24 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8540 | AUPRC: 0.5040 | MinRP: 0.4803
17/01/2026 20:25:26 >> VAL          Epoch:     5 | AUROC: 0.8083 | AUPRC: 0.4267 | MinRP: 0.4261
17/01/2026 20:25:26 >> AUPRC improved: 0.4143 ---> 0.4267 (+0.0123)
17/01/2026 20:25:26 >> Saving checkpoint to ../outputs/physionet_2012/raindrop|fold:4/checkpoint_best.bin
17/01/2026 20:25:26 >> ============================================================
17/01/2026 20:25:26 >> >>> Epoch 6/20
17/01/2026 20:25:39 >> Epoch 6 completed | Avg Loss: 0.4811
17/01/2026 20:25:41 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8627 | AUPRC: 0.5284 | MinRP: 0.4675
17/01/2026 20:25:43 >> VAL          Epoch:     6 | AUROC: 0.8034 | AUPRC: 0.4242 | MinRP: 0.4249
17/01/2026 20:25:43 >> No improvement. Wait: 4/5
17/01/2026 20:25:43 >> ============================================================
17/01/2026 20:25:43 >> >>> Epoch 7/20
17/01/2026 20:25:56 >> Epoch 7 completed | Avg Loss: 0.4654
17/01/2026 20:25:58 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8685 | AUPRC: 0.5368 | MinRP: 0.4873
17/01/2026 20:26:00 >> VAL          Epoch:     7 | AUROC: 0.8068 | AUPRC: 0.4230 | MinRP: 0.4249
17/01/2026 20:26:00 >> No improvement. Wait: 3/5
17/01/2026 20:26:00 >> ============================================================
17/01/2026 20:26:00 >> >>> Epoch 8/20
17/01/2026 20:26:14 >> Epoch 8 completed | Avg Loss: 0.4458
17/01/2026 20:26:16 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8771 | AUPRC: 0.5400 | MinRP: 0.4936
17/01/2026 20:26:17 >> VAL          Epoch:     8 | AUROC: 0.8069 | AUPRC: 0.4393 | MinRP: 0.4322
17/01/2026 20:26:17 >> AUPRC improved: 0.4267 ---> 0.4393 (+0.0127)
17/01/2026 20:26:17 >> Saving checkpoint to ../outputs/physionet_2012/raindrop|fold:4/checkpoint_best.bin
17/01/2026 20:26:17 >> ============================================================
17/01/2026 20:26:17 >> >>> Epoch 9/20
17/01/2026 20:26:31 >> Epoch 9 completed | Avg Loss: 0.4341
17/01/2026 20:26:33 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8906 | AUPRC: 0.5676 | MinRP: 0.5115
17/01/2026 20:26:34 >> VAL          Epoch:     9 | AUROC: 0.8080 | AUPRC: 0.4387 | MinRP: 0.4505
17/01/2026 20:26:34 >> No improvement. Wait: 4/5
17/01/2026 20:26:34 >> ============================================================
17/01/2026 20:26:34 >> >>> Epoch 10/20
17/01/2026 20:26:48 >> Epoch 10 completed | Avg Loss: 0.4215
17/01/2026 20:26:49 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9050 | AUPRC: 0.5995 | MinRP: 0.5433
17/01/2026 20:26:51 >> VAL          Epoch:    10 | AUROC: 0.8112 | AUPRC: 0.4389 | MinRP: 0.4420
17/01/2026 20:26:51 >> No improvement. Wait: 3/5
17/01/2026 20:26:51 >> ============================================================
17/01/2026 20:26:51 >> >>> Epoch 11/20
17/01/2026 20:27:04 >> Epoch 11 completed | Avg Loss: 0.4093
17/01/2026 20:27:06 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9099 | AUPRC: 0.6173 | MinRP: 0.5515
17/01/2026 20:27:07 >> VAL          Epoch:    11 | AUROC: 0.8141 | AUPRC: 0.4443 | MinRP: 0.4579
17/01/2026 20:27:07 >> AUPRC improved: 0.4393 ---> 0.4443 (+0.0050)
17/01/2026 20:27:07 >> Saving checkpoint to ../outputs/physionet_2012/raindrop|fold:4/checkpoint_best.bin
17/01/2026 20:27:07 >> ============================================================
17/01/2026 20:27:07 >> >>> Epoch 12/20
17/01/2026 20:27:21 >> Epoch 12 completed | Avg Loss: 0.3967
17/01/2026 20:27:23 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9105 | AUPRC: 0.6178 | MinRP: 0.5633
17/01/2026 20:27:25 >> VAL          Epoch:    12 | AUROC: 0.8158 | AUPRC: 0.4515 | MinRP: 0.4495
17/01/2026 20:27:25 >> AUPRC improved: 0.4443 ---> 0.4515 (+0.0072)
17/01/2026 20:27:25 >> Saving checkpoint to ../outputs/physionet_2012/raindrop|fold:4/checkpoint_best.bin
17/01/2026 20:27:25 >> ============================================================
17/01/2026 20:27:25 >> >>> Epoch 13/20
17/01/2026 20:27:38 >> Epoch 13 completed | Avg Loss: 0.3857
17/01/2026 20:27:40 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9168 | AUPRC: 0.6270 | MinRP: 0.5633
17/01/2026 20:27:42 >> VAL          Epoch:    13 | AUROC: 0.8081 | AUPRC: 0.4449 | MinRP: 0.4565
17/01/2026 20:27:42 >> No improvement. Wait: 4/5
17/01/2026 20:27:42 >> ============================================================
17/01/2026 20:27:42 >> >>> Epoch 14/20
17/01/2026 20:27:55 >> Epoch 14 completed | Avg Loss: 0.3760
17/01/2026 20:27:57 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9223 | AUPRC: 0.6270 | MinRP: 0.5695
17/01/2026 20:27:58 >> VAL          Epoch:    14 | AUROC: 0.8076 | AUPRC: 0.4468 | MinRP: 0.4359
17/01/2026 20:27:58 >> No improvement. Wait: 3/5
17/01/2026 20:27:58 >> ============================================================
17/01/2026 20:27:58 >> >>> Epoch 15/20
17/01/2026 20:28:12 >> Epoch 15 completed | Avg Loss: 0.3646
17/01/2026 20:28:13 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9288 | AUPRC: 0.6588 | MinRP: 0.6059
17/01/2026 20:28:15 >> VAL          Epoch:    15 | AUROC: 0.8098 | AUPRC: 0.4491 | MinRP: 0.4432
17/01/2026 20:28:15 >> No improvement. Wait: 2/5
17/01/2026 20:28:15 >> ============================================================
17/01/2026 20:28:15 >> >>> Epoch 16/20
17/01/2026 20:28:30 >> Epoch 16 completed | Avg Loss: 0.3487
17/01/2026 20:28:32 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9425 | AUPRC: 0.6996 | MinRP: 0.6335
17/01/2026 20:28:33 >> VAL          Epoch:    16 | AUROC: 0.8061 | AUPRC: 0.4443 | MinRP: 0.4507
17/01/2026 20:28:33 >> No improvement. Wait: 1/5
17/01/2026 20:28:33 >> ============================================================
17/01/2026 20:28:33 >> >>> Epoch 17/20
17/01/2026 20:28:47 >> Epoch 17 completed | Avg Loss: 0.3228
17/01/2026 20:28:48 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9445 | AUPRC: 0.7055 | MinRP: 0.6192
17/01/2026 20:28:50 >> VAL          Epoch:    17 | AUROC: 0.8142 | AUPRC: 0.4618 | MinRP: 0.4638
17/01/2026 20:28:50 >> AUPRC improved: 0.4515 ---> 0.4618 (+0.0103)
17/01/2026 20:28:50 >> Saving checkpoint to ../outputs/physionet_2012/raindrop|fold:4/checkpoint_best.bin
17/01/2026 20:28:50 >> ============================================================
17/01/2026 20:28:50 >> >>> Epoch 18/20
17/01/2026 20:29:04 >> Epoch 18 completed | Avg Loss: 0.3287
17/01/2026 20:29:05 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9530 | AUPRC: 0.7310 | MinRP: 0.6667
17/01/2026 20:29:07 >> VAL          Epoch:    18 | AUROC: 0.8071 | AUPRC: 0.4346 | MinRP: 0.4505
17/01/2026 20:29:07 >> No improvement. Wait: 4/5
17/01/2026 20:29:07 >> ============================================================
17/01/2026 20:29:07 >> >>> Epoch 19/20
17/01/2026 20:29:20 >> Epoch 19 completed | Avg Loss: 0.3087
17/01/2026 20:29:22 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9545 | AUPRC: 0.7322 | MinRP: 0.6808
17/01/2026 20:29:24 >> VAL          Epoch:    19 | AUROC: 0.8031 | AUPRC: 0.4406 | MinRP: 0.4388
17/01/2026 20:29:24 >> No improvement. Wait: 3/5
17/01/2026 20:29:24 >> ============================================================
17/01/2026 20:29:24 >> >>> Epoch 20/20
17/01/2026 20:29:37 >> Epoch 20 completed | Avg Loss: 0.3020
17/01/2026 20:29:39 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.9618 | AUPRC: 0.7779 | MinRP: 0.7021
17/01/2026 20:29:41 >> VAL          Epoch:    20 | AUROC: 0.8046 | AUPRC: 0.4345 | MinRP: 0.4520
17/01/2026 20:29:41 >> No improvement. Wait: 2/5
17/01/2026 20:29:41 >> ============================================================

17/01/2026 20:29:41 >> ============================================================
17/01/2026 20:29:41 >> TRAINING COMPLETED
17/01/2026 20:29:41 >> ============================================================
17/01/2026 20:29:41 >> Best Validation Results:
17/01/2026 20:29:41 >>   AUROC: 0.8142 | AUPRC: 0.4618 | MinRP: 0.4638
17/01/2026 20:29:41 >> Loading best model from ../outputs/physionet_2012/raindrop|fold:4/checkpoint_best.bin
17/01/2026 20:29:41 >> Evaluating on test set...
17/01/2026 20:29:43 >> TEST         AUROC: 0.8102 | AUPRC: 0.4102 | MinRP: 0.4176 | Accuracy: 0.7614

17/01/2026 20:29:43 >> ============================================================
17/01/2026 20:29:43 >> Classification Report:
17/01/2026 20:29:43 >>               precision    recall  f1-score   support
17/01/2026 20:29:43 >> 
17/01/2026 20:29:43 >>          0.0     0.9365    0.7743    0.8477      2056
17/01/2026 20:29:43 >>          1.0     0.3343    0.6833    0.4489       341
17/01/2026 20:29:43 >> 
17/01/2026 20:29:43 >>     accuracy                         0.7614      2397
17/01/2026 20:29:43 >>    macro avg     0.6354    0.7288    0.6483      2397
17/01/2026 20:29:43 >> weighted avg     0.8508    0.7614    0.7910      2397
17/01/2026 20:29:43 >> 
17/01/2026 20:29:43 >> Confusion Matrix:
17/01/2026 20:29:43 >> [1592, 464]
17/01/2026 20:29:43 >> [108, 233]
17/01/2026 20:29:43 >> ============================================================
17/01/2026 20:29:43 >> Final Test Results:
17/01/2026 20:29:43 >>   AUROC: 0.8102 | AUPRC: 0.4102 | MinRP: 0.4176 | Accuracy: 0.7614
17/01/2026 20:29:43 >> ============================================================
