17/01/2026 15:46:05 >> Namespace(dataset='physionet_2012', model_type='mtm', split_file='physionet_2012_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/mtm|fold:1', lr=0.0004, train_batch_size=64, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=5.0, max_obs=880, max_timesteps=880, device='cuda:2', seed=2026, hid_dim=96, r_hid=4, dropout=0.13, down_mode='max', num_mtm_layers=4, downsample_ratio=3, logger=<utils.logger.Logger object at 0x77326df79e40>)

17/01/2026 15:46:05 >> Preparing dataset physionet_2012
17/01/2026 15:46:05 >> Using fold 1/5
17/01/2026 15:46:05 >> Loaded splits from physionet_2012_5fold.json
17/01/2026 15:46:06 >> # train, val, test TS: [7673, 1918, 2397]
17/01/2026 15:46:06 >> pos class weight: 6.0330
17/01/2026 15:46:06 >> % pos class in train, val, test splits: [0.1422, 0.1283, 0.1544]
17/01/2026 15:46:07 >> # static features: 8
17/01/2026 15:46:10 >> # TS variables: 36

17/01/2026 15:46:22 >> Model details:
17/01/2026 15:46:22 >> # parameters: 684674
17/01/2026 15:46:22 >> # trainable parameters: 684674, 100.0%
17/01/2026 15:46:22 >> #params by dtype:
17/01/2026 15:46:22 >> torch.float32: 684674, 100.0%

17/01/2026 15:46:22 >> No. of training batches per epoch = 120

17/01/2026 15:46:22 >> ============================================================
17/01/2026 15:46:22 >>                Starting training...
17/01/2026 15:46:22 >> ============================================================
17/01/2026 15:46:22 >> >>> Epoch 1/20
17/01/2026 15:46:55 >> Epoch 1 completed | Avg Loss: 1.1105
17/01/2026 15:47:04 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.7991 | AUPRC: 0.4137 | MinRP: 0.4281
17/01/2026 15:47:13 >> VAL          Epoch:     1 | AUROC: 0.7970 | AUPRC: 0.3866 | MinRP: 0.4593
17/01/2026 15:47:13 >> AUPRC improved: 0.0000 ---> 0.3866 (+0.3866)
17/01/2026 15:47:13 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:1/checkpoint_best.bin
17/01/2026 15:47:13 >> ============================================================
17/01/2026 15:47:13 >> >>> Epoch 2/20
17/01/2026 15:47:59 >> Epoch 2 completed | Avg Loss: 0.9138
17/01/2026 15:48:07 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8420 | AUPRC: 0.4544 | MinRP: 0.4593
17/01/2026 15:48:16 >> VAL          Epoch:     2 | AUROC: 0.8325 | AUPRC: 0.4421 | MinRP: 0.4756
17/01/2026 15:48:16 >> AUPRC improved: 0.3866 ---> 0.4421 (+0.0556)
17/01/2026 15:48:16 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:1/checkpoint_best.bin
17/01/2026 15:48:16 >> ============================================================
17/01/2026 15:48:16 >> >>> Epoch 3/20
17/01/2026 15:49:00 >> Epoch 3 completed | Avg Loss: 0.8557
17/01/2026 15:49:11 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8627 | AUPRC: 0.5002 | MinRP: 0.4913
17/01/2026 15:49:21 >> VAL          Epoch:     3 | AUROC: 0.8486 | AUPRC: 0.4815 | MinRP: 0.4777
17/01/2026 15:49:21 >> AUPRC improved: 0.4421 ---> 0.4815 (+0.0394)
17/01/2026 15:49:21 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:1/checkpoint_best.bin
17/01/2026 15:49:21 >> ============================================================
17/01/2026 15:49:21 >> >>> Epoch 4/20
17/01/2026 15:50:03 >> Epoch 4 completed | Avg Loss: 0.8229
17/01/2026 15:50:08 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8678 | AUPRC: 0.5138 | MinRP: 0.5034
17/01/2026 15:50:13 >> VAL          Epoch:     4 | AUROC: 0.8514 | AUPRC: 0.4956 | MinRP: 0.5040
17/01/2026 15:50:13 >> AUPRC improved: 0.4815 ---> 0.4956 (+0.0141)
17/01/2026 15:50:13 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:1/checkpoint_best.bin
17/01/2026 15:50:13 >> ============================================================
17/01/2026 15:50:13 >> >>> Epoch 5/20
17/01/2026 15:50:43 >> Epoch 5 completed | Avg Loss: 0.7902
17/01/2026 15:50:51 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8799 | AUPRC: 0.5414 | MinRP: 0.5034
17/01/2026 15:50:59 >> VAL          Epoch:     5 | AUROC: 0.8592 | AUPRC: 0.5097 | MinRP: 0.5041
17/01/2026 15:50:59 >> AUPRC improved: 0.4956 ---> 0.5097 (+0.0140)
17/01/2026 15:50:59 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:1/checkpoint_best.bin
17/01/2026 15:50:59 >> ============================================================
17/01/2026 15:50:59 >> >>> Epoch 6/20
17/01/2026 15:51:35 >> Epoch 6 completed | Avg Loss: 0.7758
17/01/2026 15:51:42 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8842 | AUPRC: 0.5583 | MinRP: 0.5342
17/01/2026 15:51:49 >> VAL          Epoch:     6 | AUROC: 0.8588 | AUPRC: 0.5167 | MinRP: 0.5080
17/01/2026 15:51:49 >> AUPRC improved: 0.5097 ---> 0.5167 (+0.0071)
17/01/2026 15:51:49 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:1/checkpoint_best.bin
17/01/2026 15:51:49 >> ============================================================
17/01/2026 15:51:49 >> >>> Epoch 7/20
17/01/2026 15:52:26 >> Epoch 7 completed | Avg Loss: 0.7581
17/01/2026 15:52:34 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8908 | AUPRC: 0.5817 | MinRP: 0.5495
17/01/2026 15:52:42 >> VAL          Epoch:     7 | AUROC: 0.8629 | AUPRC: 0.5304 | MinRP: 0.5244
17/01/2026 15:52:42 >> AUPRC improved: 0.5167 ---> 0.5304 (+0.0137)
17/01/2026 15:52:42 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:1/checkpoint_best.bin
17/01/2026 15:52:42 >> ============================================================
17/01/2026 15:52:42 >> >>> Epoch 8/20
17/01/2026 15:53:16 >> Epoch 8 completed | Avg Loss: 0.7347
17/01/2026 15:53:23 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8979 | AUPRC: 0.5960 | MinRP: 0.5601
17/01/2026 15:53:30 >> VAL          Epoch:     8 | AUROC: 0.8653 | AUPRC: 0.5341 | MinRP: 0.5244
17/01/2026 15:53:30 >> AUPRC improved: 0.5304 ---> 0.5341 (+0.0037)
17/01/2026 15:53:30 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:1/checkpoint_best.bin
17/01/2026 15:53:30 >> ============================================================
17/01/2026 15:53:30 >> >>> Epoch 9/20
17/01/2026 15:54:07 >> Epoch 9 completed | Avg Loss: 0.7130
17/01/2026 15:54:16 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8980 | AUPRC: 0.5955 | MinRP: 0.5604
17/01/2026 15:54:24 >> VAL          Epoch:     9 | AUROC: 0.8669 | AUPRC: 0.5348 | MinRP: 0.5244
17/01/2026 15:54:24 >> AUPRC improved: 0.5341 ---> 0.5348 (+0.0007)
17/01/2026 15:54:24 >> Saving checkpoint to ../outputs/physionet_2012/mtm|fold:1/checkpoint_best.bin
17/01/2026 15:54:24 >> ============================================================
17/01/2026 15:54:24 >> >>> Epoch 10/20
17/01/2026 15:54:57 >> Epoch 10 completed | Avg Loss: 0.6998
17/01/2026 15:55:04 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9083 | AUPRC: 0.6176 | MinRP: 0.5898
17/01/2026 15:55:11 >> VAL          Epoch:    10 | AUROC: 0.8686 | AUPRC: 0.5303 | MinRP: 0.5447
17/01/2026 15:55:11 >> No improvement. Wait: 4/5
17/01/2026 15:55:11 >> ============================================================
17/01/2026 15:55:11 >> >>> Epoch 11/20
17/01/2026 15:55:49 >> Epoch 11 completed | Avg Loss: 0.6937
17/01/2026 15:55:57 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9104 | AUPRC: 0.6258 | MinRP: 0.5973
17/01/2026 15:56:05 >> VAL          Epoch:    11 | AUROC: 0.8672 | AUPRC: 0.5317 | MinRP: 0.5285
17/01/2026 15:56:05 >> No improvement. Wait: 3/5
17/01/2026 15:56:05 >> ============================================================
17/01/2026 15:56:05 >> >>> Epoch 12/20
17/01/2026 15:56:32 >> Epoch 12 completed | Avg Loss: 0.6588
17/01/2026 15:56:37 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9194 | AUPRC: 0.6534 | MinRP: 0.6233
17/01/2026 15:56:42 >> VAL          Epoch:    12 | AUROC: 0.8702 | AUPRC: 0.5286 | MinRP: 0.5285
17/01/2026 15:56:42 >> No improvement. Wait: 2/5
17/01/2026 15:56:42 >> ============================================================
17/01/2026 15:56:42 >> >>> Epoch 13/20
17/01/2026 15:57:21 >> Epoch 13 completed | Avg Loss: 0.6572
17/01/2026 15:57:28 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9220 | AUPRC: 0.6560 | MinRP: 0.6259
17/01/2026 15:57:35 >> VAL          Epoch:    13 | AUROC: 0.8682 | AUPRC: 0.5310 | MinRP: 0.5366
17/01/2026 15:57:35 >> No improvement. Wait: 1/5
17/01/2026 15:57:35 >> ============================================================
17/01/2026 15:57:35 >> >>> Epoch 14/20
17/01/2026 15:58:09 >> Epoch 14 completed | Avg Loss: 0.6338
17/01/2026 15:58:16 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9289 | AUPRC: 0.6680 | MinRP: 0.6190
17/01/2026 15:58:25 >> VAL          Epoch:    14 | AUROC: 0.8672 | AUPRC: 0.5266 | MinRP: 0.5038
17/01/2026 15:58:25 >> No improvement. Wait: 0/5
17/01/2026 15:58:25 >> Patience reached. Early stopping.

17/01/2026 15:58:25 >> ============================================================
17/01/2026 15:58:25 >> TRAINING COMPLETED
17/01/2026 15:58:25 >> ============================================================
17/01/2026 15:58:25 >> Best Validation Results:
17/01/2026 15:58:25 >>   AUROC: 0.8669 | AUPRC: 0.5348 | MinRP: 0.5244
17/01/2026 15:58:25 >> Loading best model from ../outputs/physionet_2012/mtm|fold:1/checkpoint_best.bin
17/01/2026 15:58:25 >> Evaluating on test set...
17/01/2026 15:58:35 >> TEST         AUROC: 0.8633 | AUPRC: 0.5808 | MinRP: 0.5568 | Accuracy: 0.8223

17/01/2026 15:58:35 >> ============================================================
17/01/2026 15:58:35 >> Classification Report:
17/01/2026 15:58:35 >>               precision    recall  f1-score   support
17/01/2026 15:58:35 >> 
17/01/2026 15:58:35 >>          0.0     0.9386    0.8451    0.8894      2027
17/01/2026 15:58:35 >>          1.0     0.4510    0.6973    0.5478       370
17/01/2026 15:58:35 >> 
17/01/2026 15:58:35 >>     accuracy                         0.8223      2397
17/01/2026 15:58:35 >>    macro avg     0.6948    0.7712    0.7186      2397
17/01/2026 15:58:35 >> weighted avg     0.8634    0.8223    0.8367      2397
17/01/2026 15:58:35 >> 
17/01/2026 15:58:35 >> Confusion Matrix:
17/01/2026 15:58:35 >> [1713, 314]
17/01/2026 15:58:35 >> [112, 258]
17/01/2026 15:58:35 >> ============================================================
17/01/2026 15:58:35 >> Final Test Results:
17/01/2026 15:58:35 >>   AUROC: 0.8633 | AUPRC: 0.5808 | MinRP: 0.5568 | Accuracy: 0.8223
17/01/2026 15:58:35 >> ============================================================
