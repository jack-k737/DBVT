24/01/2026 06:30:29 >> Namespace(dataset='physionet_2012', model_type='tcn', split_file='physionet_2012_5fold.json', fold=4, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/tcn|fold:4', lr=0.001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=64, num_layers=4, kernel_size=3, dropout=0.2, logger=<utils.logger.Logger object at 0x75a458a1e140>)

24/01/2026 06:30:29 >> Preparing dataset physionet_2012
24/01/2026 06:30:29 >> Using fold 4/5
24/01/2026 06:30:29 >> Loaded splits from physionet_2012_5fold.json
24/01/2026 06:30:30 >> # train, val, test TS: [7673, 1918, 2397]
24/01/2026 06:30:30 >> pos class weight: 6.0201
24/01/2026 06:30:30 >> % pos class in train, val, test splits: [0.1424, 0.1423, 0.1423]
24/01/2026 06:30:31 >> # static features: 8
24/01/2026 06:30:31 >> # TS variables (TCN/SAND): 36
24/01/2026 06:30:32 >> # timesteps (hours): 49
24/01/2026 06:30:37 >> Input shape: [N, 49, 108]

24/01/2026 06:30:38 >> Model details:
24/01/2026 06:30:38 >> # parameters: 124289
24/01/2026 06:30:38 >> # trainable parameters: 124289, 100.0%
24/01/2026 06:30:38 >> #params by dtype:
24/01/2026 06:30:38 >> torch.float32: 124289, 100.0%

24/01/2026 06:30:38 >> No. of training batches per epoch = 240

24/01/2026 06:30:38 >> ============================================================
24/01/2026 06:30:38 >>                Starting training...
24/01/2026 06:30:38 >> ============================================================
24/01/2026 06:30:38 >> >>> Epoch 1/20
24/01/2026 06:30:40 >> Epoch 1 completed | Avg Loss: 0.9857
24/01/2026 06:30:40 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8368 | AUPRC: 0.5444 | MinRP: 0.5033
24/01/2026 06:30:40 >> VAL          Epoch:     1 | AUROC: 0.8109 | AUPRC: 0.4536 | MinRP: 0.4571
24/01/2026 06:30:40 >> AUPRC improved: 0.0000 ---> 0.4536 (+0.4536)
24/01/2026 06:30:40 >> Saving checkpoint to ../outputs/physionet_2012/tcn|fold:4/checkpoint_best.bin
24/01/2026 06:30:40 >> ============================================================
24/01/2026 06:30:40 >> >>> Epoch 2/20
24/01/2026 06:30:42 >> Epoch 2 completed | Avg Loss: 0.8809
24/01/2026 06:30:42 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8534 | AUPRC: 0.5708 | MinRP: 0.5267
24/01/2026 06:30:42 >> VAL          Epoch:     2 | AUROC: 0.8219 | AUPRC: 0.4791 | MinRP: 0.4691
24/01/2026 06:30:42 >> AUPRC improved: 0.4536 ---> 0.4791 (+0.0255)
24/01/2026 06:30:42 >> Saving checkpoint to ../outputs/physionet_2012/tcn|fold:4/checkpoint_best.bin
24/01/2026 06:30:42 >> ============================================================
24/01/2026 06:30:42 >> >>> Epoch 3/20
24/01/2026 06:30:43 >> Epoch 3 completed | Avg Loss: 0.8444
24/01/2026 06:30:43 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8630 | AUPRC: 0.5830 | MinRP: 0.5382
24/01/2026 06:30:43 >> VAL          Epoch:     3 | AUROC: 0.8252 | AUPRC: 0.4846 | MinRP: 0.4872
24/01/2026 06:30:43 >> AUPRC improved: 0.4791 ---> 0.4846 (+0.0055)
24/01/2026 06:30:43 >> Saving checkpoint to ../outputs/physionet_2012/tcn|fold:4/checkpoint_best.bin
24/01/2026 06:30:43 >> ============================================================
24/01/2026 06:30:43 >> >>> Epoch 4/20
24/01/2026 06:30:45 >> Epoch 4 completed | Avg Loss: 0.8153
24/01/2026 06:30:45 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8850 | AUPRC: 0.6268 | MinRP: 0.5515
24/01/2026 06:30:45 >> VAL          Epoch:     4 | AUROC: 0.8284 | AUPRC: 0.4934 | MinRP: 0.4745
24/01/2026 06:30:45 >> AUPRC improved: 0.4846 ---> 0.4934 (+0.0088)
24/01/2026 06:30:45 >> Saving checkpoint to ../outputs/physionet_2012/tcn|fold:4/checkpoint_best.bin
24/01/2026 06:30:45 >> ============================================================
24/01/2026 06:30:45 >> >>> Epoch 5/20
24/01/2026 06:30:46 >> Epoch 5 completed | Avg Loss: 0.7883
24/01/2026 06:30:46 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8957 | AUPRC: 0.6525 | MinRP: 0.5967
24/01/2026 06:30:46 >> VAL          Epoch:     5 | AUROC: 0.8282 | AUPRC: 0.4979 | MinRP: 0.5018
24/01/2026 06:30:46 >> AUPRC improved: 0.4934 ---> 0.4979 (+0.0045)
24/01/2026 06:30:46 >> Saving checkpoint to ../outputs/physionet_2012/tcn|fold:4/checkpoint_best.bin
24/01/2026 06:30:46 >> ============================================================
24/01/2026 06:30:46 >> >>> Epoch 6/20
24/01/2026 06:30:48 >> Epoch 6 completed | Avg Loss: 0.7295
24/01/2026 06:30:48 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.9116 | AUPRC: 0.6898 | MinRP: 0.6312
24/01/2026 06:30:48 >> VAL          Epoch:     6 | AUROC: 0.8212 | AUPRC: 0.4752 | MinRP: 0.4688
24/01/2026 06:30:48 >> No improvement. Wait: 4/5
24/01/2026 06:30:48 >> ============================================================
24/01/2026 06:30:48 >> >>> Epoch 7/20
24/01/2026 06:30:49 >> Epoch 7 completed | Avg Loss: 0.7082
24/01/2026 06:30:49 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9245 | AUPRC: 0.7250 | MinRP: 0.6600
24/01/2026 06:30:49 >> VAL          Epoch:     7 | AUROC: 0.8210 | AUPRC: 0.4823 | MinRP: 0.4762
24/01/2026 06:30:49 >> No improvement. Wait: 3/5
24/01/2026 06:30:49 >> ============================================================
24/01/2026 06:30:49 >> >>> Epoch 8/20
24/01/2026 06:30:51 >> Epoch 8 completed | Avg Loss: 0.6548
24/01/2026 06:30:51 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9399 | AUPRC: 0.7562 | MinRP: 0.7000
24/01/2026 06:30:51 >> VAL          Epoch:     8 | AUROC: 0.8183 | AUPRC: 0.4753 | MinRP: 0.4698
24/01/2026 06:30:51 >> No improvement. Wait: 2/5
24/01/2026 06:30:51 >> ============================================================
24/01/2026 06:30:51 >> >>> Epoch 9/20
24/01/2026 06:30:52 >> Epoch 9 completed | Avg Loss: 0.5939
24/01/2026 06:30:52 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9595 | AUPRC: 0.8430 | MinRP: 0.7733
24/01/2026 06:30:52 >> VAL          Epoch:     9 | AUROC: 0.8062 | AUPRC: 0.4511 | MinRP: 0.4469
24/01/2026 06:30:52 >> No improvement. Wait: 1/5
24/01/2026 06:30:52 >> ============================================================
24/01/2026 06:30:52 >> >>> Epoch 10/20
24/01/2026 06:30:54 >> Epoch 10 completed | Avg Loss: 0.5465
24/01/2026 06:30:54 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9673 | AUPRC: 0.8648 | MinRP: 0.7900
24/01/2026 06:30:54 >> VAL          Epoch:    10 | AUROC: 0.8098 | AUPRC: 0.4482 | MinRP: 0.4429
24/01/2026 06:30:54 >> No improvement. Wait: 0/5
24/01/2026 06:30:54 >> Patience reached. Early stopping.

24/01/2026 06:30:54 >> ============================================================
24/01/2026 06:30:54 >> TRAINING COMPLETED
24/01/2026 06:30:54 >> ============================================================
24/01/2026 06:30:54 >> Best Validation Results:
24/01/2026 06:30:54 >>   AUROC: 0.8282 | AUPRC: 0.4979 | MinRP: 0.5018
24/01/2026 06:30:54 >> Loading best model from ../outputs/physionet_2012/tcn|fold:4/checkpoint_best.bin
24/01/2026 06:30:54 >> Evaluating on test set...
24/01/2026 06:30:54 >> TEST         AUROC: 0.8264 | AUPRC: 0.4765 | MinRP: 0.4985 | Accuracy: 0.8123

24/01/2026 06:30:54 >> ============================================================
24/01/2026 06:30:54 >> Classification Report:
24/01/2026 06:30:54 >>               precision    recall  f1-score   support
24/01/2026 06:30:54 >> 
24/01/2026 06:30:54 >>          0.0     0.9336    0.8410    0.8849      2056
24/01/2026 06:30:54 >>          1.0     0.4000    0.6393    0.4921       341
24/01/2026 06:30:54 >> 
24/01/2026 06:30:54 >>     accuracy                         0.8123      2397
24/01/2026 06:30:54 >>    macro avg     0.6668    0.7401    0.6885      2397
24/01/2026 06:30:54 >> weighted avg     0.8577    0.8123    0.8290      2397
24/01/2026 06:30:54 >> 
24/01/2026 06:30:54 >> Confusion Matrix:
24/01/2026 06:30:54 >> [1729, 327]
24/01/2026 06:30:54 >> [123, 218]
24/01/2026 06:30:54 >> ============================================================
24/01/2026 06:30:54 >> Final Test Results:
24/01/2026 06:30:54 >>   AUROC: 0.8264 | AUPRC: 0.4765 | MinRP: 0.4985 | Accuracy: 0.8123
24/01/2026 06:30:54 >> ============================================================
