17/01/2026 19:52:17 >> Namespace(dataset='physionet_2012', model_type='strats', split_file='physionet_2012_5fold.json', fold=2, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/strats|fold:2', lr=0.0001, train_batch_size=16, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:2', seed=2026, hid_dim=256, num_layers=3, num_heads=16, dropout=0.11, attention_dropout=0.25, logger=<utils.logger.Logger object at 0x739c71f06140>)

17/01/2026 19:52:17 >> Preparing dataset physionet_2012
17/01/2026 19:52:17 >> Using fold 2/5
17/01/2026 19:52:17 >> Loaded splits from physionet_2012_5fold.json
17/01/2026 19:52:18 >> # train, val, test TS: [7673, 1918, 2397]
17/01/2026 19:52:18 >> pos class weight: 5.8265
17/01/2026 19:52:18 >> % pos class in train, val, test splits: [0.1465, 0.1257, 0.1427]
17/01/2026 19:52:19 >> # static features: 8
17/01/2026 19:52:21 >> # TS variables: 36

17/01/2026 19:52:28 >> Model details:
17/01/2026 19:52:28 >> # parameters: 1795137
17/01/2026 19:52:28 >> # trainable parameters: 1795137, 100.0%
17/01/2026 19:52:28 >> #params by dtype:
17/01/2026 19:52:28 >> torch.float32: 1795137, 100.0%

17/01/2026 19:52:28 >> No. of training batches per epoch = 480

17/01/2026 19:52:28 >> ============================================================
17/01/2026 19:52:28 >>                Starting training...
17/01/2026 19:52:28 >> ============================================================
17/01/2026 19:52:28 >> >>> Epoch 1/20
17/01/2026 19:53:33 >> Epoch 1 completed | Avg Loss: 1.0561
17/01/2026 19:53:39 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8298 | AUPRC: 0.4845 | MinRP: 0.4653
17/01/2026 19:53:44 >> VAL          Epoch:     1 | AUROC: 0.8213 | AUPRC: 0.4375 | MinRP: 0.4398
17/01/2026 19:53:44 >> AUPRC improved: 0.0000 ---> 0.4375 (+0.4375)
17/01/2026 19:53:44 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:2/checkpoint_best.bin
17/01/2026 19:53:44 >> ============================================================
17/01/2026 19:53:44 >> >>> Epoch 2/20
17/01/2026 19:54:45 >> Epoch 2 completed | Avg Loss: 0.9616
17/01/2026 19:54:50 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8511 | AUPRC: 0.5293 | MinRP: 0.5018
17/01/2026 19:54:56 >> VAL          Epoch:     2 | AUROC: 0.8484 | AUPRC: 0.4911 | MinRP: 0.4939
17/01/2026 19:54:56 >> AUPRC improved: 0.4375 ---> 0.4911 (+0.0536)
17/01/2026 19:54:56 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:2/checkpoint_best.bin
17/01/2026 19:54:56 >> ============================================================
17/01/2026 19:54:56 >> >>> Epoch 3/20
17/01/2026 19:55:57 >> Epoch 3 completed | Avg Loss: 0.9130
17/01/2026 19:56:02 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8472 | AUPRC: 0.4932 | MinRP: 0.5000
17/01/2026 19:56:08 >> VAL          Epoch:     3 | AUROC: 0.8457 | AUPRC: 0.4624 | MinRP: 0.4855
17/01/2026 19:56:08 >> No improvement. Wait: 4/5
17/01/2026 19:56:08 >> ============================================================
17/01/2026 19:56:08 >> >>> Epoch 4/20
17/01/2026 19:57:11 >> Epoch 4 completed | Avg Loss: 0.9061
17/01/2026 19:57:17 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8640 | AUPRC: 0.5492 | MinRP: 0.5172
17/01/2026 19:57:22 >> VAL          Epoch:     4 | AUROC: 0.8559 | AUPRC: 0.5143 | MinRP: 0.4938
17/01/2026 19:57:22 >> AUPRC improved: 0.4911 ---> 0.5143 (+0.0232)
17/01/2026 19:57:22 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:2/checkpoint_best.bin
17/01/2026 19:57:22 >> ============================================================
17/01/2026 19:57:22 >> >>> Epoch 5/20
17/01/2026 19:58:24 >> Epoch 5 completed | Avg Loss: 0.8718
17/01/2026 19:58:29 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8664 | AUPRC: 0.5438 | MinRP: 0.5298
17/01/2026 19:58:34 >> VAL          Epoch:     5 | AUROC: 0.8650 | AUPRC: 0.5180 | MinRP: 0.5270
17/01/2026 19:58:34 >> AUPRC improved: 0.5143 ---> 0.5180 (+0.0037)
17/01/2026 19:58:34 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:2/checkpoint_best.bin
17/01/2026 19:58:34 >> ============================================================
17/01/2026 19:58:34 >> >>> Epoch 6/20
17/01/2026 19:59:35 >> Epoch 6 completed | Avg Loss: 0.8763
17/01/2026 19:59:40 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8738 | AUPRC: 0.5546 | MinRP: 0.5206
17/01/2026 19:59:46 >> VAL          Epoch:     6 | AUROC: 0.8653 | AUPRC: 0.5259 | MinRP: 0.5187
17/01/2026 19:59:46 >> AUPRC improved: 0.5180 ---> 0.5259 (+0.0079)
17/01/2026 19:59:46 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:2/checkpoint_best.bin
17/01/2026 19:59:46 >> ============================================================
17/01/2026 19:59:46 >> >>> Epoch 7/20
17/01/2026 20:00:48 >> Epoch 7 completed | Avg Loss: 0.8680
17/01/2026 20:00:54 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8701 | AUPRC: 0.5416 | MinRP: 0.5298
17/01/2026 20:00:59 >> VAL          Epoch:     7 | AUROC: 0.8675 | AUPRC: 0.5212 | MinRP: 0.5207
17/01/2026 20:00:59 >> No improvement. Wait: 4/5
17/01/2026 20:00:59 >> ============================================================
17/01/2026 20:00:59 >> >>> Epoch 8/20
17/01/2026 20:02:02 >> Epoch 8 completed | Avg Loss: 0.8587
17/01/2026 20:02:07 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8797 | AUPRC: 0.5734 | MinRP: 0.5385
17/01/2026 20:02:12 >> VAL          Epoch:     8 | AUROC: 0.8690 | AUPRC: 0.5407 | MinRP: 0.5410
17/01/2026 20:02:12 >> AUPRC improved: 0.5259 ---> 0.5407 (+0.0148)
17/01/2026 20:02:12 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:2/checkpoint_best.bin
17/01/2026 20:02:12 >> ============================================================
17/01/2026 20:02:12 >> >>> Epoch 9/20
17/01/2026 20:03:13 >> Epoch 9 completed | Avg Loss: 0.8384
17/01/2026 20:03:18 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8796 | AUPRC: 0.5843 | MinRP: 0.5684
17/01/2026 20:03:24 >> VAL          Epoch:     9 | AUROC: 0.8708 | AUPRC: 0.5558 | MinRP: 0.5311
17/01/2026 20:03:24 >> AUPRC improved: 0.5407 ---> 0.5558 (+0.0151)
17/01/2026 20:03:24 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:2/checkpoint_best.bin
17/01/2026 20:03:24 >> ============================================================
17/01/2026 20:03:24 >> >>> Epoch 10/20
17/01/2026 20:04:26 >> Epoch 10 completed | Avg Loss: 0.8308
17/01/2026 20:04:31 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8841 | AUPRC: 0.5674 | MinRP: 0.5333
17/01/2026 20:04:37 >> VAL          Epoch:    10 | AUROC: 0.8719 | AUPRC: 0.5403 | MinRP: 0.5304
17/01/2026 20:04:37 >> No improvement. Wait: 4/5
17/01/2026 20:04:37 >> ============================================================
17/01/2026 20:04:37 >> >>> Epoch 11/20
17/01/2026 20:05:39 >> Epoch 11 completed | Avg Loss: 0.8353
17/01/2026 20:05:44 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8862 | AUPRC: 0.5959 | MinRP: 0.5522
17/01/2026 20:05:49 >> VAL          Epoch:    11 | AUROC: 0.8676 | AUPRC: 0.5586 | MinRP: 0.5311
17/01/2026 20:05:49 >> AUPRC improved: 0.5558 ---> 0.5586 (+0.0028)
17/01/2026 20:05:49 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:2/checkpoint_best.bin
17/01/2026 20:05:49 >> ============================================================
17/01/2026 20:05:49 >> >>> Epoch 12/20
17/01/2026 20:06:50 >> Epoch 12 completed | Avg Loss: 0.8206
17/01/2026 20:06:56 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8850 | AUPRC: 0.5988 | MinRP: 0.5439
17/01/2026 20:07:01 >> VAL          Epoch:    12 | AUROC: 0.8709 | AUPRC: 0.5531 | MinRP: 0.5413
17/01/2026 20:07:01 >> No improvement. Wait: 4/5
17/01/2026 20:07:01 >> ============================================================
17/01/2026 20:07:01 >> >>> Epoch 13/20
17/01/2026 20:08:04 >> Epoch 13 completed | Avg Loss: 0.8131
17/01/2026 20:08:09 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8889 | AUPRC: 0.5907 | MinRP: 0.5719
17/01/2026 20:08:15 >> VAL          Epoch:    13 | AUROC: 0.8733 | AUPRC: 0.5343 | MinRP: 0.5187
17/01/2026 20:08:15 >> No improvement. Wait: 3/5
17/01/2026 20:08:15 >> ============================================================
17/01/2026 20:08:15 >> >>> Epoch 14/20
17/01/2026 20:09:17 >> Epoch 14 completed | Avg Loss: 0.8294
17/01/2026 20:09:22 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8928 | AUPRC: 0.5959 | MinRP: 0.5649
17/01/2026 20:09:28 >> VAL          Epoch:    14 | AUROC: 0.8754 | AUPRC: 0.5487 | MinRP: 0.5267
17/01/2026 20:09:28 >> No improvement. Wait: 2/5
17/01/2026 20:09:28 >> ============================================================
17/01/2026 20:09:28 >> >>> Epoch 15/20
17/01/2026 20:10:29 >> Epoch 15 completed | Avg Loss: 0.8085
17/01/2026 20:10:34 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.8946 | AUPRC: 0.6039 | MinRP: 0.5544
17/01/2026 20:10:39 >> VAL          Epoch:    15 | AUROC: 0.8701 | AUPRC: 0.5406 | MinRP: 0.5394
17/01/2026 20:10:39 >> No improvement. Wait: 1/5
17/01/2026 20:10:39 >> ============================================================
17/01/2026 20:10:39 >> >>> Epoch 16/20
17/01/2026 20:11:41 >> Epoch 16 completed | Avg Loss: 0.7844
17/01/2026 20:11:47 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9011 | AUPRC: 0.6234 | MinRP: 0.5860
17/01/2026 20:11:52 >> VAL          Epoch:    16 | AUROC: 0.8721 | AUPRC: 0.5607 | MinRP: 0.5270
17/01/2026 20:11:52 >> AUPRC improved: 0.5586 ---> 0.5607 (+0.0021)
17/01/2026 20:11:52 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:2/checkpoint_best.bin
17/01/2026 20:11:52 >> ============================================================
17/01/2026 20:11:52 >> >>> Epoch 17/20
17/01/2026 20:12:56 >> Epoch 17 completed | Avg Loss: 0.8089
17/01/2026 20:13:01 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9023 | AUPRC: 0.6215 | MinRP: 0.5825
17/01/2026 20:13:06 >> VAL          Epoch:    17 | AUROC: 0.8746 | AUPRC: 0.5487 | MinRP: 0.5560
17/01/2026 20:13:06 >> No improvement. Wait: 4/5
17/01/2026 20:13:06 >> ============================================================
17/01/2026 20:13:06 >> >>> Epoch 18/20
17/01/2026 20:14:07 >> Epoch 18 completed | Avg Loss: 0.7784
17/01/2026 20:14:13 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9065 | AUPRC: 0.6289 | MinRP: 0.5789
17/01/2026 20:14:16 >> VAL          Epoch:    18 | AUROC: 0.8720 | AUPRC: 0.5412 | MinRP: 0.5187
17/01/2026 20:14:16 >> No improvement. Wait: 3/5
17/01/2026 20:14:16 >> ============================================================
17/01/2026 20:14:16 >> >>> Epoch 19/20
17/01/2026 20:14:51 >> Epoch 19 completed | Avg Loss: 0.7727
17/01/2026 20:14:55 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9099 | AUPRC: 0.6500 | MinRP: 0.5895
17/01/2026 20:14:58 >> VAL          Epoch:    19 | AUROC: 0.8675 | AUPRC: 0.5473 | MinRP: 0.5311
17/01/2026 20:14:58 >> No improvement. Wait: 2/5
17/01/2026 20:14:58 >> ============================================================
17/01/2026 20:14:58 >> >>> Epoch 20/20
17/01/2026 20:15:33 >> Epoch 20 completed | Avg Loss: 0.7822
17/01/2026 20:15:36 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.9049 | AUPRC: 0.6446 | MinRP: 0.5965
17/01/2026 20:15:39 >> VAL          Epoch:    20 | AUROC: 0.8648 | AUPRC: 0.5318 | MinRP: 0.5062
17/01/2026 20:15:39 >> No improvement. Wait: 1/5
17/01/2026 20:15:39 >> ============================================================

17/01/2026 20:15:39 >> ============================================================
17/01/2026 20:15:39 >> TRAINING COMPLETED
17/01/2026 20:15:39 >> ============================================================
17/01/2026 20:15:39 >> Best Validation Results:
17/01/2026 20:15:39 >>   AUROC: 0.8721 | AUPRC: 0.5607 | MinRP: 0.5270
17/01/2026 20:15:39 >> Loading best model from ../outputs/physionet_2012/strats|fold:2/checkpoint_best.bin
17/01/2026 20:15:39 >> Evaluating on test set...
17/01/2026 20:15:43 >> TEST         AUROC: 0.8637 | AUPRC: 0.5306 | MinRP: 0.5160 | Accuracy: 0.8068

17/01/2026 20:15:43 >> ============================================================
17/01/2026 20:15:43 >> Classification Report:
17/01/2026 20:15:43 >>               precision    recall  f1-score   support
17/01/2026 20:15:43 >> 
17/01/2026 20:15:43 >>          0.0     0.9482    0.8195    0.8791      2055
17/01/2026 20:15:43 >>          1.0     0.4026    0.7310    0.5192       342
17/01/2026 20:15:43 >> 
17/01/2026 20:15:43 >>     accuracy                         0.8068      2397
17/01/2026 20:15:43 >>    macro avg     0.6754    0.7752    0.6992      2397
17/01/2026 20:15:43 >> weighted avg     0.8703    0.8068    0.8278      2397
17/01/2026 20:15:43 >> 
17/01/2026 20:15:43 >> Confusion Matrix:
17/01/2026 20:15:43 >> [1684, 371]
17/01/2026 20:15:43 >> [92, 250]
17/01/2026 20:15:43 >> ============================================================
17/01/2026 20:15:43 >> Final Test Results:
17/01/2026 20:15:43 >>   AUROC: 0.8637 | AUPRC: 0.5306 | MinRP: 0.5160 | Accuracy: 0.8068
17/01/2026 20:15:43 >> ============================================================
