17/01/2026 18:04:46 >> Namespace(dataset='physionet_2012', model_type='hipatch', split_file='physionet_2012_5fold.json', fold=3, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/hipatch|fold:3', lr=0.0003, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=64, num_heads=2, num_layers=1, patch_size=7, alpha=0.8, res=1, logger=<utils.logger.Logger object at 0x7b52d0106140>)

17/01/2026 18:04:46 >> Preparing dataset physionet_2012
17/01/2026 18:04:46 >> Using fold 3/5
17/01/2026 18:04:46 >> Loaded splits from physionet_2012_5fold.json
17/01/2026 18:04:47 >> # train, val, test TS: [7673, 1918, 2397]
17/01/2026 18:04:47 >> pos class weight: 6.0137
17/01/2026 18:04:47 >> % pos class in train, val, test splits: [0.1426, 0.1470, 0.1381]
17/01/2026 18:04:48 >> # static features: 8
17/01/2026 18:04:48 >> # TS variables: 36
17/01/2026 18:04:48 >> # patches: 8 | patch_layer: 4 | patch_size: 7h | stride: 6h
17/01/2026 18:04:50 >> # max obs per patch: 20

17/01/2026 18:04:57 >> Model details:
17/01/2026 18:04:57 >> # parameters: 184222
17/01/2026 18:04:57 >> # trainable parameters: 184222, 100.0%
17/01/2026 18:04:57 >> #params by dtype:
17/01/2026 18:04:57 >> torch.float32: 184222, 100.0%

17/01/2026 18:04:57 >> No. of training batches per epoch = 240

17/01/2026 18:04:57 >> ============================================================
17/01/2026 18:04:57 >>                Starting training...
17/01/2026 18:04:57 >> ============================================================
17/01/2026 18:04:57 >> >>> Epoch 1/20
17/01/2026 18:06:27 >> Epoch 1 completed | Avg Loss: 0.5763
17/01/2026 18:06:36 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8281 | AUPRC: 0.4548 | MinRP: 0.4692
17/01/2026 18:06:45 >> VAL          Epoch:     1 | AUROC: 0.8460 | AUPRC: 0.5172 | MinRP: 0.4895
17/01/2026 18:06:45 >> AUPRC improved: 0.0000 ---> 0.5172 (+0.5172)
17/01/2026 18:06:45 >> Saving checkpoint to ../outputs/physionet_2012/hipatch|fold:3/checkpoint_best.bin
17/01/2026 18:06:45 >> ============================================================
17/01/2026 18:06:45 >> >>> Epoch 2/20
17/01/2026 18:08:15 >> Epoch 2 completed | Avg Loss: 0.5012
17/01/2026 18:08:25 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8306 | AUPRC: 0.4611 | MinRP: 0.4676
17/01/2026 18:08:34 >> VAL          Epoch:     2 | AUROC: 0.8391 | AUPRC: 0.4898 | MinRP: 0.4787
17/01/2026 18:08:34 >> No improvement. Wait: 4/5
17/01/2026 18:08:34 >> ============================================================
17/01/2026 18:08:34 >> >>> Epoch 3/20
17/01/2026 18:10:03 >> Epoch 3 completed | Avg Loss: 0.4842
17/01/2026 18:10:13 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8608 | AUPRC: 0.5220 | MinRP: 0.5085
17/01/2026 18:10:22 >> VAL          Epoch:     3 | AUROC: 0.8577 | AUPRC: 0.5393 | MinRP: 0.5265
17/01/2026 18:10:22 >> AUPRC improved: 0.5172 ---> 0.5393 (+0.0221)
17/01/2026 18:10:22 >> Saving checkpoint to ../outputs/physionet_2012/hipatch|fold:3/checkpoint_best.bin
17/01/2026 18:10:22 >> ============================================================
17/01/2026 18:10:22 >> >>> Epoch 4/20
17/01/2026 18:11:52 >> Epoch 4 completed | Avg Loss: 0.4754
17/01/2026 18:12:01 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8762 | AUPRC: 0.5405 | MinRP: 0.5342
17/01/2026 18:12:08 >> VAL          Epoch:     4 | AUROC: 0.8641 | AUPRC: 0.5625 | MinRP: 0.5228
17/01/2026 18:12:08 >> AUPRC improved: 0.5393 ---> 0.5625 (+0.0232)
17/01/2026 18:12:08 >> Saving checkpoint to ../outputs/physionet_2012/hipatch|fold:3/checkpoint_best.bin
17/01/2026 18:12:08 >> ============================================================
17/01/2026 18:12:08 >> >>> Epoch 5/20
17/01/2026 18:13:32 >> Epoch 5 completed | Avg Loss: 0.4656
17/01/2026 18:13:41 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8796 | AUPRC: 0.5503 | MinRP: 0.5377
17/01/2026 18:13:51 >> VAL          Epoch:     5 | AUROC: 0.8609 | AUPRC: 0.5439 | MinRP: 0.5069
17/01/2026 18:13:51 >> No improvement. Wait: 4/5
17/01/2026 18:13:51 >> ============================================================
17/01/2026 18:13:51 >> >>> Epoch 6/20
17/01/2026 18:15:20 >> Epoch 6 completed | Avg Loss: 0.4429
17/01/2026 18:15:30 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8917 | AUPRC: 0.5697 | MinRP: 0.5657
17/01/2026 18:15:39 >> VAL          Epoch:     6 | AUROC: 0.8574 | AUPRC: 0.5451 | MinRP: 0.5177
17/01/2026 18:15:39 >> No improvement. Wait: 3/5
17/01/2026 18:15:39 >> ============================================================
17/01/2026 18:15:39 >> >>> Epoch 7/20
17/01/2026 18:17:07 >> Epoch 7 completed | Avg Loss: 0.4378
17/01/2026 18:17:17 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9031 | AUPRC: 0.5999 | MinRP: 0.5853
17/01/2026 18:17:26 >> VAL          Epoch:     7 | AUROC: 0.8569 | AUPRC: 0.5427 | MinRP: 0.5142
17/01/2026 18:17:26 >> No improvement. Wait: 2/5
17/01/2026 18:17:26 >> ============================================================
17/01/2026 18:17:26 >> >>> Epoch 8/20
17/01/2026 18:18:52 >> Epoch 8 completed | Avg Loss: 0.4263
17/01/2026 18:19:02 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9072 | AUPRC: 0.6089 | MinRP: 0.5822
17/01/2026 18:19:11 >> VAL          Epoch:     8 | AUROC: 0.8550 | AUPRC: 0.5506 | MinRP: 0.5265
17/01/2026 18:19:11 >> No improvement. Wait: 1/5
17/01/2026 18:19:11 >> ============================================================
17/01/2026 18:19:11 >> >>> Epoch 9/20
17/01/2026 18:20:38 >> Epoch 9 completed | Avg Loss: 0.4136
17/01/2026 18:20:48 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9170 | AUPRC: 0.6334 | MinRP: 0.6041
17/01/2026 18:20:56 >> VAL          Epoch:     9 | AUROC: 0.8538 | AUPRC: 0.5553 | MinRP: 0.5300
17/01/2026 18:20:56 >> No improvement. Wait: 0/5
17/01/2026 18:20:56 >> Patience reached. Early stopping.

17/01/2026 18:20:56 >> ============================================================
17/01/2026 18:20:56 >> TRAINING COMPLETED
17/01/2026 18:20:56 >> ============================================================
17/01/2026 18:20:56 >> Best Validation Results:
17/01/2026 18:20:56 >>   AUROC: 0.8641 | AUPRC: 0.5625 | MinRP: 0.5228
17/01/2026 18:20:56 >> Loading best model from ../outputs/physionet_2012/hipatch|fold:3/checkpoint_best.bin
17/01/2026 18:20:57 >> Evaluating on test set...
17/01/2026 18:21:08 >> TEST         AUROC: 0.8728 | AUPRC: 0.5660 | MinRP: 0.4887 | Accuracy: 0.7247

17/01/2026 18:21:08 >> ============================================================
17/01/2026 18:21:08 >> Classification Report:
17/01/2026 18:21:08 >>               precision    recall  f1-score   support
17/01/2026 18:21:08 >> 
17/01/2026 18:21:08 >>          0.0     0.9737    0.6994    0.8141      2066
17/01/2026 18:21:08 >>          1.0     0.3198    0.8822    0.4695       331
17/01/2026 18:21:08 >> 
17/01/2026 18:21:08 >>     accuracy                         0.7247      2397
17/01/2026 18:21:08 >>    macro avg     0.6468    0.7908    0.6418      2397
17/01/2026 18:21:08 >> weighted avg     0.8834    0.7247    0.7665      2397
17/01/2026 18:21:08 >> 
17/01/2026 18:21:08 >> Confusion Matrix:
17/01/2026 18:21:08 >> [1445, 621]
17/01/2026 18:21:08 >> [39, 292]
17/01/2026 18:21:08 >> ============================================================
17/01/2026 18:21:08 >> Final Test Results:
17/01/2026 18:21:08 >>   AUROC: 0.8728 | AUPRC: 0.5660 | MinRP: 0.4887 | Accuracy: 0.7247
17/01/2026 18:21:08 >> ============================================================
