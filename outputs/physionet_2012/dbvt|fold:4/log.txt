07/02/2026 20:17:57 >> Namespace(dataset='physionet_2012', model_type='dbvt', split_file='physionet_2012_5fold.json', fold=4, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/dbvt|fold:4', lr=0.0001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, gru_hid_dim=128, gru_dropout=0.3, transformer_hid_dim=64, transformer_num_layers=2, transformer_num_heads=4, transformer_dropout=0.1, fusion_hid_dim=256, fusion_dropout=0.2, lambda_aux=0.8, lambda_cos=0.5, logger=<utils.logger.Logger object at 0x77492ee1e140>)

07/02/2026 20:17:57 >> Preparing dataset physionet_2012
07/02/2026 20:17:57 >> Using fold 4/5
07/02/2026 20:17:57 >> Loaded splits from physionet_2012_5fold.json
07/02/2026 20:17:58 >> # train, val, test TS: [7673, 1918, 2397]
07/02/2026 20:17:59 >> pos class weight: 6.0201
07/02/2026 20:17:59 >> % pos class in train, val, test splits: [0.1424, 0.1423, 0.1423]
07/02/2026 20:17:59 >> # static features: 8
07/02/2026 20:18:00 >> # TS variables (DBVT): 36
07/02/2026 20:18:01 >> # timesteps (DBVT): 49

07/02/2026 20:18:19 >> Model details:
07/02/2026 20:18:19 >> # parameters: 378283
07/02/2026 20:18:19 >> # trainable parameters: 378283, 100.0%
07/02/2026 20:18:19 >> #params by dtype:
07/02/2026 20:18:19 >> torch.float32: 378283, 100.0%

07/02/2026 20:18:19 >> No. of training batches per epoch = 240

07/02/2026 20:18:19 >> ============================================================
07/02/2026 20:18:19 >>                Starting training...
07/02/2026 20:18:19 >> ============================================================
07/02/2026 20:18:19 >> >>> Epoch 1/20
07/02/2026 20:18:37 >> Epoch 1 completed | Avg Loss: 2.8173
07/02/2026 20:18:40 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8343 | AUPRC: 0.4715 | MinRP: 0.4733
07/02/2026 20:18:41 >> VAL          Epoch:     1 | AUROC: 0.8079 | AUPRC: 0.4235 | MinRP: 0.4610
07/02/2026 20:18:41 >> AUPRC improved: 0.0000 ---> 0.4235 (+0.4235)
07/02/2026 20:18:41 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:18:41 >> ============================================================
07/02/2026 20:18:41 >> >>> Epoch 2/20
07/02/2026 20:18:57 >> Epoch 2 completed | Avg Loss: 2.3936
07/02/2026 20:18:58 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8510 | AUPRC: 0.5173 | MinRP: 0.4902
07/02/2026 20:19:00 >> VAL          Epoch:     2 | AUROC: 0.8265 | AUPRC: 0.4607 | MinRP: 0.4731
07/02/2026 20:19:00 >> AUPRC improved: 0.4235 ---> 0.4607 (+0.0372)
07/02/2026 20:19:00 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:19:00 >> ============================================================
07/02/2026 20:19:00 >> >>> Epoch 3/20
07/02/2026 20:19:15 >> Epoch 3 completed | Avg Loss: 2.3175
07/02/2026 20:19:17 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8584 | AUPRC: 0.5377 | MinRP: 0.5167
07/02/2026 20:19:18 >> VAL          Epoch:     3 | AUROC: 0.8331 | AUPRC: 0.4797 | MinRP: 0.4801
07/02/2026 20:19:18 >> AUPRC improved: 0.4607 ---> 0.4797 (+0.0190)
07/02/2026 20:19:18 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:19:18 >> ============================================================
07/02/2026 20:19:18 >> >>> Epoch 4/20
07/02/2026 20:19:34 >> Epoch 4 completed | Avg Loss: 2.2694
07/02/2026 20:19:35 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8640 | AUPRC: 0.5433 | MinRP: 0.5282
07/02/2026 20:19:37 >> VAL          Epoch:     4 | AUROC: 0.8364 | AUPRC: 0.4874 | MinRP: 0.4835
07/02/2026 20:19:37 >> AUPRC improved: 0.4797 ---> 0.4874 (+0.0077)
07/02/2026 20:19:37 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:19:37 >> ============================================================
07/02/2026 20:19:37 >> >>> Epoch 5/20
07/02/2026 20:19:53 >> Epoch 5 completed | Avg Loss: 2.2378
07/02/2026 20:19:54 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8688 | AUPRC: 0.5632 | MinRP: 0.5281
07/02/2026 20:19:56 >> VAL          Epoch:     5 | AUROC: 0.8413 | AUPRC: 0.5160 | MinRP: 0.5000
07/02/2026 20:19:56 >> AUPRC improved: 0.4874 ---> 0.5160 (+0.0286)
07/02/2026 20:19:56 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:19:56 >> ============================================================
07/02/2026 20:19:56 >> >>> Epoch 6/20
07/02/2026 20:20:11 >> Epoch 6 completed | Avg Loss: 2.1796
07/02/2026 20:20:13 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8703 | AUPRC: 0.5717 | MinRP: 0.5300
07/02/2026 20:20:14 >> VAL          Epoch:     6 | AUROC: 0.8430 | AUPRC: 0.5239 | MinRP: 0.5018
07/02/2026 20:20:14 >> AUPRC improved: 0.5160 ---> 0.5239 (+0.0079)
07/02/2026 20:20:14 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:20:14 >> ============================================================
07/02/2026 20:20:14 >> >>> Epoch 7/20
07/02/2026 20:20:30 >> Epoch 7 completed | Avg Loss: 2.1801
07/02/2026 20:20:32 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8720 | AUPRC: 0.5779 | MinRP: 0.5433
07/02/2026 20:20:33 >> VAL          Epoch:     7 | AUROC: 0.8430 | AUPRC: 0.5159 | MinRP: 0.5127
07/02/2026 20:20:33 >> No improvement. Wait: 4/5
07/02/2026 20:20:33 >> ============================================================
07/02/2026 20:20:33 >> >>> Epoch 8/20
07/02/2026 20:20:49 >> Epoch 8 completed | Avg Loss: 2.1557
07/02/2026 20:20:50 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8755 | AUPRC: 0.5801 | MinRP: 0.5482
07/02/2026 20:20:52 >> VAL          Epoch:     8 | AUROC: 0.8450 | AUPRC: 0.5257 | MinRP: 0.5036
07/02/2026 20:20:52 >> AUPRC improved: 0.5239 ---> 0.5257 (+0.0017)
07/02/2026 20:20:52 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:20:52 >> ============================================================
07/02/2026 20:20:52 >> >>> Epoch 9/20
07/02/2026 20:21:08 >> Epoch 9 completed | Avg Loss: 2.1565
07/02/2026 20:21:09 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8783 | AUPRC: 0.5974 | MinRP: 0.5600
07/02/2026 20:21:11 >> VAL          Epoch:     9 | AUROC: 0.8489 | AUPRC: 0.5320 | MinRP: 0.5036
07/02/2026 20:21:11 >> AUPRC improved: 0.5257 ---> 0.5320 (+0.0063)
07/02/2026 20:21:11 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:21:11 >> ============================================================
07/02/2026 20:21:11 >> >>> Epoch 10/20
07/02/2026 20:21:26 >> Epoch 10 completed | Avg Loss: 2.1426
07/02/2026 20:21:28 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8795 | AUPRC: 0.5981 | MinRP: 0.5430
07/02/2026 20:21:29 >> VAL          Epoch:    10 | AUROC: 0.8492 | AUPRC: 0.5341 | MinRP: 0.5165
07/02/2026 20:21:29 >> AUPRC improved: 0.5320 ---> 0.5341 (+0.0021)
07/02/2026 20:21:29 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:21:29 >> ============================================================
07/02/2026 20:21:29 >> >>> Epoch 11/20
07/02/2026 20:21:45 >> Epoch 11 completed | Avg Loss: 2.1215
07/02/2026 20:21:47 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8824 | AUPRC: 0.6071 | MinRP: 0.5633
07/02/2026 20:21:48 >> VAL          Epoch:    11 | AUROC: 0.8525 | AUPRC: 0.5498 | MinRP: 0.5328
07/02/2026 20:21:48 >> AUPRC improved: 0.5341 ---> 0.5498 (+0.0157)
07/02/2026 20:21:48 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:21:48 >> ============================================================
07/02/2026 20:21:48 >> >>> Epoch 12/20
07/02/2026 20:22:03 >> Epoch 12 completed | Avg Loss: 2.1049
07/02/2026 20:22:05 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8845 | AUPRC: 0.6002 | MinRP: 0.5533
07/02/2026 20:22:06 >> VAL          Epoch:    12 | AUROC: 0.8543 | AUPRC: 0.5423 | MinRP: 0.5311
07/02/2026 20:22:06 >> No improvement. Wait: 4/5
07/02/2026 20:22:06 >> ============================================================
07/02/2026 20:22:06 >> >>> Epoch 13/20
07/02/2026 20:22:22 >> Epoch 13 completed | Avg Loss: 2.0874
07/02/2026 20:22:23 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8849 | AUPRC: 0.6103 | MinRP: 0.5615
07/02/2026 20:22:25 >> VAL          Epoch:    13 | AUROC: 0.8531 | AUPRC: 0.5496 | MinRP: 0.5348
07/02/2026 20:22:25 >> No improvement. Wait: 3/5
07/02/2026 20:22:25 >> ============================================================
07/02/2026 20:22:25 >> >>> Epoch 14/20
07/02/2026 20:22:40 >> Epoch 14 completed | Avg Loss: 2.0841
07/02/2026 20:22:42 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8862 | AUPRC: 0.6047 | MinRP: 0.5600
07/02/2026 20:22:43 >> VAL          Epoch:    14 | AUROC: 0.8536 | AUPRC: 0.5473 | MinRP: 0.5348
07/02/2026 20:22:43 >> No improvement. Wait: 2/5
07/02/2026 20:22:43 >> ============================================================
07/02/2026 20:22:43 >> >>> Epoch 15/20
07/02/2026 20:22:59 >> Epoch 15 completed | Avg Loss: 2.0972
07/02/2026 20:23:01 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.8874 | AUPRC: 0.6079 | MinRP: 0.5533
07/02/2026 20:23:02 >> VAL          Epoch:    15 | AUROC: 0.8563 | AUPRC: 0.5468 | MinRP: 0.5275
07/02/2026 20:23:02 >> No improvement. Wait: 1/5
07/02/2026 20:23:02 >> ============================================================
07/02/2026 20:23:02 >> >>> Epoch 16/20
07/02/2026 20:23:18 >> Epoch 16 completed | Avg Loss: 2.0637
07/02/2026 20:23:19 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.8893 | AUPRC: 0.6113 | MinRP: 0.5667
07/02/2026 20:23:21 >> VAL          Epoch:    16 | AUROC: 0.8535 | AUPRC: 0.5471 | MinRP: 0.5302
07/02/2026 20:23:21 >> No improvement. Wait: 0/5
07/02/2026 20:23:21 >> Patience reached. Early stopping.

07/02/2026 20:23:21 >> ============================================================
07/02/2026 20:23:21 >> TRAINING COMPLETED
07/02/2026 20:23:21 >> ============================================================
07/02/2026 20:23:21 >> Best Validation Results:
07/02/2026 20:23:21 >>   AUROC: 0.8525 | AUPRC: 0.5498 | MinRP: 0.5328
07/02/2026 20:23:21 >> Loading best model from ../outputs/physionet_2012/dbvt|fold:4/checkpoint_best.bin
07/02/2026 20:23:21 >> Evaluating on test set...
07/02/2026 20:23:23 >> TEST         AUROC: 0.8580 | AUPRC: 0.5248 | MinRP: 0.5175 | Accuracy: 0.7267

07/02/2026 20:23:23 >> ============================================================
07/02/2026 20:23:23 >> Classification Report:
07/02/2026 20:23:23 >>               precision    recall  f1-score   support
07/02/2026 20:23:23 >> 
07/02/2026 20:23:23 >>          0.0     0.9648    0.7072    0.8162      2056
07/02/2026 20:23:23 >>          1.0     0.3236    0.8446    0.4679       341
07/02/2026 20:23:23 >> 
07/02/2026 20:23:23 >>     accuracy                         0.7267      2397
07/02/2026 20:23:23 >>    macro avg     0.6442    0.7759    0.6420      2397
07/02/2026 20:23:23 >> weighted avg     0.8736    0.7267    0.7666      2397
07/02/2026 20:23:23 >> 
07/02/2026 20:23:23 >> Confusion Matrix:
07/02/2026 20:23:23 >> [1454, 602]
07/02/2026 20:23:23 >> [53, 288]
07/02/2026 20:23:23 >> ============================================================
07/02/2026 20:23:23 >> Final Test Results:
07/02/2026 20:23:23 >>   AUROC: 0.8580 | AUPRC: 0.5248 | MinRP: 0.5175 | Accuracy: 0.7267
07/02/2026 20:23:23 >> ============================================================
