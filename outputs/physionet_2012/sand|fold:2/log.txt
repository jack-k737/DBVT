24/01/2026 06:26:49 >> Namespace(dataset='physionet_2012', model_type='sand', split_file='physionet_2012_5fold.json', fold=2, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/sand|fold:2', lr=0.001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=64, num_layers=2, num_heads=4, dropout=0.2, r=10, M=16, logger=<utils.logger.Logger object at 0x7f6280906140>)

24/01/2026 06:26:49 >> Preparing dataset physionet_2012
24/01/2026 06:26:49 >> Using fold 2/5
24/01/2026 06:26:49 >> Loaded splits from physionet_2012_5fold.json
24/01/2026 06:26:50 >> # train, val, test TS: [7673, 1918, 2397]
24/01/2026 06:26:50 >> pos class weight: 5.8265
24/01/2026 06:26:50 >> % pos class in train, val, test splits: [0.1465, 0.1257, 0.1427]
24/01/2026 06:26:51 >> # static features: 8
24/01/2026 06:26:51 >> # TS variables (SAND): 36
24/01/2026 06:26:53 >> # timesteps (hours): 49
24/01/2026 06:26:58 >> Input shape: [N, 49, 108]

24/01/2026 06:26:58 >> Model details:
24/01/2026 06:26:58 >> # parameters: 90226
24/01/2026 06:26:58 >> # trainable parameters: 87041, 96.46997539511892%
24/01/2026 06:26:58 >> #params by dtype:
24/01/2026 06:26:58 >> torch.float32: 90226, 100.0%

24/01/2026 06:26:58 >> No. of training batches per epoch = 240

24/01/2026 06:26:58 >> ============================================================
24/01/2026 06:26:58 >>                Starting training...
24/01/2026 06:26:58 >> ============================================================
24/01/2026 06:26:58 >> >>> Epoch 1/20
24/01/2026 06:27:00 >> Epoch 1 completed | Avg Loss: 1.3280
24/01/2026 06:27:00 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8421 | AUPRC: 0.5124 | MinRP: 0.4882
24/01/2026 06:27:00 >> VAL          Epoch:     1 | AUROC: 0.8404 | AUPRC: 0.4744 | MinRP: 0.4730
24/01/2026 06:27:00 >> AUPRC improved: 0.0000 ---> 0.4744 (+0.4744)
24/01/2026 06:27:00 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:2/checkpoint_best.bin
24/01/2026 06:27:00 >> ============================================================
24/01/2026 06:27:00 >> >>> Epoch 2/20
24/01/2026 06:27:02 >> Epoch 2 completed | Avg Loss: 1.1101
24/01/2026 06:27:02 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8471 | AUPRC: 0.5196 | MinRP: 0.5000
24/01/2026 06:27:02 >> VAL          Epoch:     2 | AUROC: 0.8487 | AUPRC: 0.4921 | MinRP: 0.5000
24/01/2026 06:27:02 >> AUPRC improved: 0.4744 ---> 0.4921 (+0.0177)
24/01/2026 06:27:02 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:2/checkpoint_best.bin
24/01/2026 06:27:02 >> ============================================================
24/01/2026 06:27:02 >> >>> Epoch 3/20
24/01/2026 06:27:04 >> Epoch 3 completed | Avg Loss: 1.0804
24/01/2026 06:27:04 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8483 | AUPRC: 0.5208 | MinRP: 0.4930
24/01/2026 06:27:04 >> VAL          Epoch:     3 | AUROC: 0.8413 | AUPRC: 0.4795 | MinRP: 0.4813
24/01/2026 06:27:04 >> No improvement. Wait: 4/5
24/01/2026 06:27:04 >> ============================================================
24/01/2026 06:27:04 >> >>> Epoch 4/20
24/01/2026 06:27:06 >> Epoch 4 completed | Avg Loss: 1.0417
24/01/2026 06:27:06 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8323 | AUPRC: 0.4714 | MinRP: 0.4833
24/01/2026 06:27:06 >> VAL          Epoch:     4 | AUROC: 0.8156 | AUPRC: 0.4492 | MinRP: 0.4298
24/01/2026 06:27:06 >> No improvement. Wait: 3/5
24/01/2026 06:27:06 >> ============================================================
24/01/2026 06:27:06 >> >>> Epoch 5/20
24/01/2026 06:27:07 >> Epoch 5 completed | Avg Loss: 0.9773
24/01/2026 06:27:07 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8574 | AUPRC: 0.5450 | MinRP: 0.5228
24/01/2026 06:27:07 >> VAL          Epoch:     5 | AUROC: 0.8458 | AUPRC: 0.4838 | MinRP: 0.4922
24/01/2026 06:27:07 >> No improvement. Wait: 2/5
24/01/2026 06:27:07 >> ============================================================
24/01/2026 06:27:07 >> >>> Epoch 6/20
24/01/2026 06:27:09 >> Epoch 6 completed | Avg Loss: 0.9684
24/01/2026 06:27:09 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8585 | AUPRC: 0.5350 | MinRP: 0.4983
24/01/2026 06:27:09 >> VAL          Epoch:     6 | AUROC: 0.8475 | AUPRC: 0.4849 | MinRP: 0.5041
24/01/2026 06:27:09 >> No improvement. Wait: 1/5
24/01/2026 06:27:09 >> ============================================================
24/01/2026 06:27:09 >> >>> Epoch 7/20
24/01/2026 06:27:12 >> Epoch 7 completed | Avg Loss: 0.9573
24/01/2026 06:27:12 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8505 | AUPRC: 0.5283 | MinRP: 0.5052
24/01/2026 06:27:12 >> VAL          Epoch:     7 | AUROC: 0.8477 | AUPRC: 0.4957 | MinRP: 0.5205
24/01/2026 06:27:12 >> AUPRC improved: 0.4921 ---> 0.4957 (+0.0036)
24/01/2026 06:27:12 >> Saving checkpoint to ../outputs/physionet_2012/sand|fold:2/checkpoint_best.bin
24/01/2026 06:27:12 >> ============================================================
24/01/2026 06:27:12 >> >>> Epoch 8/20
24/01/2026 06:27:14 >> Epoch 8 completed | Avg Loss: 0.9765
24/01/2026 06:27:14 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8631 | AUPRC: 0.5430 | MinRP: 0.5280
24/01/2026 06:27:14 >> VAL          Epoch:     8 | AUROC: 0.8501 | AUPRC: 0.4849 | MinRP: 0.4940
24/01/2026 06:27:14 >> No improvement. Wait: 4/5
24/01/2026 06:27:14 >> ============================================================
24/01/2026 06:27:14 >> >>> Epoch 9/20
24/01/2026 06:27:16 >> Epoch 9 completed | Avg Loss: 0.9481
24/01/2026 06:27:16 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8593 | AUPRC: 0.5464 | MinRP: 0.5088
24/01/2026 06:27:16 >> VAL          Epoch:     9 | AUROC: 0.8435 | AUPRC: 0.4873 | MinRP: 0.5372
24/01/2026 06:27:16 >> No improvement. Wait: 3/5
24/01/2026 06:27:16 >> ============================================================
24/01/2026 06:27:16 >> >>> Epoch 10/20
24/01/2026 06:27:18 >> Epoch 10 completed | Avg Loss: 0.9131
24/01/2026 06:27:18 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8600 | AUPRC: 0.5346 | MinRP: 0.5136
24/01/2026 06:27:18 >> VAL          Epoch:    10 | AUROC: 0.8403 | AUPRC: 0.4674 | MinRP: 0.4877
24/01/2026 06:27:18 >> No improvement. Wait: 2/5
24/01/2026 06:27:18 >> ============================================================
24/01/2026 06:27:18 >> >>> Epoch 11/20
24/01/2026 06:27:20 >> Epoch 11 completed | Avg Loss: 0.9054
24/01/2026 06:27:20 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8668 | AUPRC: 0.5664 | MinRP: 0.5524
24/01/2026 06:27:20 >> VAL          Epoch:    11 | AUROC: 0.8432 | AUPRC: 0.4825 | MinRP: 0.5021
24/01/2026 06:27:20 >> No improvement. Wait: 1/5
24/01/2026 06:27:20 >> ============================================================
24/01/2026 06:27:20 >> >>> Epoch 12/20
24/01/2026 06:27:22 >> Epoch 12 completed | Avg Loss: 0.8679
24/01/2026 06:27:22 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8693 | AUPRC: 0.5596 | MinRP: 0.5333
24/01/2026 06:27:22 >> VAL          Epoch:    12 | AUROC: 0.8501 | AUPRC: 0.4839 | MinRP: 0.4901
24/01/2026 06:27:22 >> No improvement. Wait: 0/5
24/01/2026 06:27:22 >> Patience reached. Early stopping.

24/01/2026 06:27:22 >> ============================================================
24/01/2026 06:27:22 >> TRAINING COMPLETED
24/01/2026 06:27:22 >> ============================================================
24/01/2026 06:27:22 >> Best Validation Results:
24/01/2026 06:27:22 >>   AUROC: 0.8477 | AUPRC: 0.4957 | MinRP: 0.5205
24/01/2026 06:27:22 >> Loading best model from ../outputs/physionet_2012/sand|fold:2/checkpoint_best.bin
24/01/2026 06:27:22 >> Evaluating on test set...
24/01/2026 06:27:22 >> TEST         AUROC: 0.8340 | AUPRC: 0.4883 | MinRP: 0.4884 | Accuracy: 0.8519

24/01/2026 06:27:22 >> ============================================================
24/01/2026 06:27:22 >> Classification Report:
24/01/2026 06:27:22 >>               precision    recall  f1-score   support
24/01/2026 06:27:22 >> 
24/01/2026 06:27:22 >>          0.0     0.9079    0.9207    0.9142      2055
24/01/2026 06:27:22 >>          1.0     0.4792    0.4386    0.4580       342
24/01/2026 06:27:22 >> 
24/01/2026 06:27:22 >>     accuracy                         0.8519      2397
24/01/2026 06:27:22 >>    macro avg     0.6936    0.6796    0.6861      2397
24/01/2026 06:27:22 >> weighted avg     0.8467    0.8519    0.8491      2397
24/01/2026 06:27:22 >> 
24/01/2026 06:27:22 >> Confusion Matrix:
24/01/2026 06:27:22 >> [1892, 163]
24/01/2026 06:27:22 >> [192, 150]
24/01/2026 06:27:22 >> ============================================================
24/01/2026 06:27:22 >> Final Test Results:
24/01/2026 06:27:22 >>   AUROC: 0.8340 | AUPRC: 0.4883 | MinRP: 0.4884 | Accuracy: 0.8519
24/01/2026 06:27:22 >> ============================================================
