17/01/2026 18:04:46 >> Namespace(dataset='physionet_2012', model_type='hipatch', split_file='physionet_2012_5fold.json', fold=4, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/hipatch|fold:4', lr=0.0003, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=64, num_heads=2, num_layers=1, patch_size=7, alpha=0.8, res=1, logger=<utils.logger.Logger object at 0x77c569306140>)

17/01/2026 18:04:46 >> Preparing dataset physionet_2012
17/01/2026 18:04:46 >> Using fold 4/5
17/01/2026 18:04:46 >> Loaded splits from physionet_2012_5fold.json
17/01/2026 18:04:47 >> # train, val, test TS: [7673, 1918, 2397]
17/01/2026 18:04:47 >> pos class weight: 6.0201
17/01/2026 18:04:47 >> % pos class in train, val, test splits: [0.1424, 0.1423, 0.1423]
17/01/2026 18:04:48 >> # static features: 8
17/01/2026 18:04:48 >> # TS variables: 36
17/01/2026 18:04:48 >> # patches: 8 | patch_layer: 4 | patch_size: 7h | stride: 6h
17/01/2026 18:04:50 >> # max obs per patch: 20

17/01/2026 18:04:57 >> Model details:
17/01/2026 18:04:57 >> # parameters: 184222
17/01/2026 18:04:57 >> # trainable parameters: 184222, 100.0%
17/01/2026 18:04:57 >> #params by dtype:
17/01/2026 18:04:57 >> torch.float32: 184222, 100.0%

17/01/2026 18:04:57 >> No. of training batches per epoch = 240

17/01/2026 18:04:57 >> ============================================================
17/01/2026 18:04:57 >>                Starting training...
17/01/2026 18:04:57 >> ============================================================
17/01/2026 18:04:57 >> >>> Epoch 1/20
17/01/2026 18:06:27 >> Epoch 1 completed | Avg Loss: 0.5553
17/01/2026 18:06:36 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8580 | AUPRC: 0.5546 | MinRP: 0.5097
17/01/2026 18:06:46 >> VAL          Epoch:     1 | AUROC: 0.8500 | AUPRC: 0.5350 | MinRP: 0.5073
17/01/2026 18:06:46 >> AUPRC improved: 0.0000 ---> 0.5350 (+0.5350)
17/01/2026 18:06:46 >> Saving checkpoint to ../outputs/physionet_2012/hipatch|fold:4/checkpoint_best.bin
17/01/2026 18:06:46 >> ============================================================
17/01/2026 18:06:46 >> >>> Epoch 2/20
17/01/2026 18:08:15 >> Epoch 2 completed | Avg Loss: 0.4741
17/01/2026 18:08:25 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8680 | AUPRC: 0.5770 | MinRP: 0.5567
17/01/2026 18:08:34 >> VAL          Epoch:     2 | AUROC: 0.8499 | AUPRC: 0.5241 | MinRP: 0.5219
17/01/2026 18:08:34 >> No improvement. Wait: 4/5
17/01/2026 18:08:34 >> ============================================================
17/01/2026 18:08:34 >> >>> Epoch 3/20
17/01/2026 18:10:04 >> Epoch 3 completed | Avg Loss: 0.4522
17/01/2026 18:10:13 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8712 | AUPRC: 0.5888 | MinRP: 0.5500
17/01/2026 18:10:23 >> VAL          Epoch:     3 | AUROC: 0.8555 | AUPRC: 0.5261 | MinRP: 0.4929
17/01/2026 18:10:23 >> No improvement. Wait: 3/5
17/01/2026 18:10:23 >> ============================================================
17/01/2026 18:10:23 >> >>> Epoch 4/20
17/01/2026 18:11:52 >> Epoch 4 completed | Avg Loss: 0.4389
17/01/2026 18:12:01 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8870 | AUPRC: 0.5986 | MinRP: 0.5681
17/01/2026 18:12:09 >> VAL          Epoch:     4 | AUROC: 0.8550 | AUPRC: 0.5316 | MinRP: 0.5109
17/01/2026 18:12:09 >> No improvement. Wait: 2/5
17/01/2026 18:12:09 >> ============================================================
17/01/2026 18:12:09 >> >>> Epoch 5/20
17/01/2026 18:13:33 >> Epoch 5 completed | Avg Loss: 0.4285
17/01/2026 18:13:42 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8904 | AUPRC: 0.6298 | MinRP: 0.5767
17/01/2026 18:13:51 >> VAL          Epoch:     5 | AUROC: 0.8602 | AUPRC: 0.5458 | MinRP: 0.5421
17/01/2026 18:13:51 >> AUPRC improved: 0.5350 ---> 0.5458 (+0.0108)
17/01/2026 18:13:51 >> Saving checkpoint to ../outputs/physionet_2012/hipatch|fold:4/checkpoint_best.bin
17/01/2026 18:13:51 >> ============================================================
17/01/2026 18:13:51 >> >>> Epoch 6/20
17/01/2026 18:15:21 >> Epoch 6 completed | Avg Loss: 0.4153
17/01/2026 18:15:31 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8967 | AUPRC: 0.6382 | MinRP: 0.5833
17/01/2026 18:15:40 >> VAL          Epoch:     6 | AUROC: 0.8587 | AUPRC: 0.5384 | MinRP: 0.5438
17/01/2026 18:15:40 >> No improvement. Wait: 4/5
17/01/2026 18:15:40 >> ============================================================
17/01/2026 18:15:40 >> >>> Epoch 7/20
17/01/2026 18:17:08 >> Epoch 7 completed | Avg Loss: 0.4032
17/01/2026 18:17:18 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.9038 | AUPRC: 0.6520 | MinRP: 0.6200
17/01/2026 18:17:27 >> VAL          Epoch:     7 | AUROC: 0.8608 | AUPRC: 0.5441 | MinRP: 0.5165
17/01/2026 18:17:27 >> No improvement. Wait: 3/5
17/01/2026 18:17:27 >> ============================================================
17/01/2026 18:17:27 >> >>> Epoch 8/20
17/01/2026 18:18:54 >> Epoch 8 completed | Avg Loss: 0.3860
17/01/2026 18:19:03 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.9094 | AUPRC: 0.6615 | MinRP: 0.6192
17/01/2026 18:19:12 >> VAL          Epoch:     8 | AUROC: 0.8555 | AUPRC: 0.5461 | MinRP: 0.5165
17/01/2026 18:19:12 >> AUPRC improved: 0.5458 ---> 0.5461 (+0.0003)
17/01/2026 18:19:12 >> Saving checkpoint to ../outputs/physionet_2012/hipatch|fold:4/checkpoint_best.bin
17/01/2026 18:19:12 >> ============================================================
17/01/2026 18:19:12 >> >>> Epoch 9/20
17/01/2026 18:20:39 >> Epoch 9 completed | Avg Loss: 0.3804
17/01/2026 18:20:49 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.9165 | AUPRC: 0.6784 | MinRP: 0.6424
17/01/2026 18:20:58 >> VAL          Epoch:     9 | AUROC: 0.8517 | AUPRC: 0.5320 | MinRP: 0.4964
17/01/2026 18:20:58 >> No improvement. Wait: 4/5
17/01/2026 18:20:58 >> ============================================================
17/01/2026 18:20:58 >> >>> Epoch 10/20
17/01/2026 18:22:01 >> Epoch 10 completed | Avg Loss: 0.3641
17/01/2026 18:22:07 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.9239 | AUPRC: 0.6998 | MinRP: 0.6667
17/01/2026 18:22:13 >> VAL          Epoch:    10 | AUROC: 0.8583 | AUPRC: 0.5459 | MinRP: 0.5092
17/01/2026 18:22:13 >> No improvement. Wait: 3/5
17/01/2026 18:22:13 >> ============================================================
17/01/2026 18:22:13 >> >>> Epoch 11/20
17/01/2026 18:23:14 >> Epoch 11 completed | Avg Loss: 0.3523
17/01/2026 18:23:21 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.9323 | AUPRC: 0.7257 | MinRP: 0.6733
17/01/2026 18:23:28 >> VAL          Epoch:    11 | AUROC: 0.8541 | AUPRC: 0.5266 | MinRP: 0.5201
17/01/2026 18:23:28 >> No improvement. Wait: 2/5
17/01/2026 18:23:28 >> ============================================================
17/01/2026 18:23:28 >> >>> Epoch 12/20
17/01/2026 18:24:28 >> Epoch 12 completed | Avg Loss: 0.3450
17/01/2026 18:24:34 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.9336 | AUPRC: 0.7311 | MinRP: 0.6867
17/01/2026 18:24:40 >> VAL          Epoch:    12 | AUROC: 0.8564 | AUPRC: 0.5528 | MinRP: 0.5321
17/01/2026 18:24:40 >> AUPRC improved: 0.5461 ---> 0.5528 (+0.0067)
17/01/2026 18:24:40 >> Saving checkpoint to ../outputs/physionet_2012/hipatch|fold:4/checkpoint_best.bin
17/01/2026 18:24:40 >> ============================================================
17/01/2026 18:24:40 >> >>> Epoch 13/20
17/01/2026 18:25:40 >> Epoch 13 completed | Avg Loss: 0.3216
17/01/2026 18:25:47 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9468 | AUPRC: 0.7777 | MinRP: 0.7243
17/01/2026 18:25:53 >> VAL          Epoch:    13 | AUROC: 0.8541 | AUPRC: 0.5499 | MinRP: 0.5136
17/01/2026 18:25:53 >> No improvement. Wait: 4/5
17/01/2026 18:25:53 >> ============================================================
17/01/2026 18:25:53 >> >>> Epoch 14/20
17/01/2026 18:26:53 >> Epoch 14 completed | Avg Loss: 0.3011
17/01/2026 18:26:59 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9502 | AUPRC: 0.7858 | MinRP: 0.7377
17/01/2026 18:27:05 >> VAL          Epoch:    14 | AUROC: 0.8522 | AUPRC: 0.5452 | MinRP: 0.5092
17/01/2026 18:27:05 >> No improvement. Wait: 3/5
17/01/2026 18:27:05 >> ============================================================
17/01/2026 18:27:05 >> >>> Epoch 15/20
17/01/2026 18:27:41 >> Epoch 15 completed | Avg Loss: 0.2840
17/01/2026 18:27:45 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9521 | AUPRC: 0.7991 | MinRP: 0.7517
17/01/2026 18:27:48 >> VAL          Epoch:    15 | AUROC: 0.8505 | AUPRC: 0.5158 | MinRP: 0.5072
17/01/2026 18:27:48 >> No improvement. Wait: 2/5
17/01/2026 18:27:48 >> ============================================================
17/01/2026 18:27:48 >> >>> Epoch 16/20
17/01/2026 18:28:21 >> Epoch 16 completed | Avg Loss: 0.2699
17/01/2026 18:28:24 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9651 | AUPRC: 0.8479 | MinRP: 0.7800
17/01/2026 18:28:27 >> VAL          Epoch:    16 | AUROC: 0.8424 | AUPRC: 0.5188 | MinRP: 0.4982
17/01/2026 18:28:27 >> No improvement. Wait: 1/5
17/01/2026 18:28:27 >> ============================================================
17/01/2026 18:28:27 >> >>> Epoch 17/20
17/01/2026 18:29:00 >> Epoch 17 completed | Avg Loss: 0.2625
17/01/2026 18:29:03 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9595 | AUPRC: 0.8217 | MinRP: 0.7667
17/01/2026 18:29:06 >> VAL          Epoch:    17 | AUROC: 0.8382 | AUPRC: 0.5035 | MinRP: 0.4909
17/01/2026 18:29:06 >> No improvement. Wait: 0/5
17/01/2026 18:29:06 >> Patience reached. Early stopping.

17/01/2026 18:29:06 >> ============================================================
17/01/2026 18:29:06 >> TRAINING COMPLETED
17/01/2026 18:29:06 >> ============================================================
17/01/2026 18:29:06 >> Best Validation Results:
17/01/2026 18:29:06 >>   AUROC: 0.8564 | AUPRC: 0.5528 | MinRP: 0.5321
17/01/2026 18:29:06 >> Loading best model from ../outputs/physionet_2012/hipatch|fold:4/checkpoint_best.bin
17/01/2026 18:29:06 >> Evaluating on test set...
17/01/2026 18:29:10 >> TEST         AUROC: 0.8477 | AUPRC: 0.5120 | MinRP: 0.5015 | Accuracy: 0.7764

17/01/2026 18:29:10 >> ============================================================
17/01/2026 18:29:10 >> Classification Report:
17/01/2026 18:29:10 >>               precision    recall  f1-score   support
17/01/2026 18:29:10 >> 
17/01/2026 18:29:10 >>          0.0     0.9492    0.7811    0.8570      2056
17/01/2026 18:29:10 >>          1.0     0.3617    0.7478    0.4876       341
17/01/2026 18:29:10 >> 
17/01/2026 18:29:10 >>     accuracy                         0.7764      2397
17/01/2026 18:29:10 >>    macro avg     0.6554    0.7645    0.6723      2397
17/01/2026 18:29:10 >> weighted avg     0.8656    0.7764    0.8044      2397
17/01/2026 18:29:10 >> 
17/01/2026 18:29:10 >> Confusion Matrix:
17/01/2026 18:29:10 >> [1606, 450]
17/01/2026 18:29:10 >> [86, 255]
17/01/2026 18:29:10 >> ============================================================
17/01/2026 18:29:10 >> Final Test Results:
17/01/2026 18:29:10 >>   AUROC: 0.8477 | AUPRC: 0.5120 | MinRP: 0.5015 | Accuracy: 0.7764
17/01/2026 18:29:10 >> ============================================================
