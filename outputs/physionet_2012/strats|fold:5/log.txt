17/01/2026 19:52:17 >> Namespace(dataset='physionet_2012', model_type='strats', split_file='physionet_2012_5fold.json', fold=5, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/strats|fold:5', lr=0.0001, train_batch_size=16, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=1.0, max_obs=880, max_timesteps=880, device='cuda:3', seed=2026, hid_dim=256, num_layers=3, num_heads=16, dropout=0.11, attention_dropout=0.25, logger=<utils.logger.Logger object at 0x730d2801e140>)

17/01/2026 19:52:17 >> Preparing dataset physionet_2012
17/01/2026 19:52:17 >> Using fold 5/5
17/01/2026 19:52:17 >> Loaded splits from physionet_2012_5fold.json
17/01/2026 19:52:18 >> # train, val, test TS: [7671, 1917, 2400]
17/01/2026 19:52:18 >> pos class weight: 5.9863
17/01/2026 19:52:18 >> % pos class in train, val, test splits: [0.1431, 0.1492, 0.1346]
17/01/2026 19:52:19 >> # static features: 8
17/01/2026 19:52:22 >> # TS variables: 36

17/01/2026 19:52:29 >> Model details:
17/01/2026 19:52:29 >> # parameters: 1795137
17/01/2026 19:52:29 >> # trainable parameters: 1795137, 100.0%
17/01/2026 19:52:29 >> #params by dtype:
17/01/2026 19:52:29 >> torch.float32: 1795137, 100.0%

17/01/2026 19:52:29 >> No. of training batches per epoch = 480

17/01/2026 19:52:29 >> ============================================================
17/01/2026 19:52:29 >>                Starting training...
17/01/2026 19:52:29 >> ============================================================
17/01/2026 19:52:29 >> >>> Epoch 1/20
17/01/2026 19:54:15 >> Epoch 1 completed | Avg Loss: 1.1151
17/01/2026 19:54:24 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.7823 | AUPRC: 0.3755 | MinRP: 0.3933
17/01/2026 19:54:33 >> VAL          Epoch:     1 | AUROC: 0.7730 | AUPRC: 0.3441 | MinRP: 0.3898
17/01/2026 19:54:33 >> AUPRC improved: 0.0000 ---> 0.3441 (+0.3441)
17/01/2026 19:54:33 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 19:54:33 >> ============================================================
17/01/2026 19:54:33 >> >>> Epoch 2/20
17/01/2026 19:56:19 >> Epoch 2 completed | Avg Loss: 1.0054
17/01/2026 19:56:29 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8402 | AUPRC: 0.4729 | MinRP: 0.5035
17/01/2026 19:56:37 >> VAL          Epoch:     2 | AUROC: 0.8199 | AUPRC: 0.4397 | MinRP: 0.4580
17/01/2026 19:56:37 >> AUPRC improved: 0.3441 ---> 0.4397 (+0.0956)
17/01/2026 19:56:37 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 19:56:37 >> ============================================================
17/01/2026 19:56:37 >> >>> Epoch 3/20
17/01/2026 19:58:22 >> Epoch 3 completed | Avg Loss: 0.9525
17/01/2026 19:58:31 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8659 | AUPRC: 0.5357 | MinRP: 0.5379
17/01/2026 19:58:40 >> VAL          Epoch:     3 | AUROC: 0.8506 | AUPRC: 0.5144 | MinRP: 0.4967
17/01/2026 19:58:40 >> AUPRC improved: 0.4397 ---> 0.5144 (+0.0747)
17/01/2026 19:58:40 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 19:58:40 >> ============================================================
17/01/2026 19:58:40 >> >>> Epoch 4/20
17/01/2026 20:00:26 >> Epoch 4 completed | Avg Loss: 0.9112
17/01/2026 20:00:35 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8750 | AUPRC: 0.5464 | MinRP: 0.5524
17/01/2026 20:00:44 >> VAL          Epoch:     4 | AUROC: 0.8587 | AUPRC: 0.5187 | MinRP: 0.5105
17/01/2026 20:00:44 >> AUPRC improved: 0.5144 ---> 0.5187 (+0.0043)
17/01/2026 20:00:44 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 20:00:44 >> ============================================================
17/01/2026 20:00:44 >> >>> Epoch 5/20
17/01/2026 20:02:29 >> Epoch 5 completed | Avg Loss: 0.8978
17/01/2026 20:02:39 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8752 | AUPRC: 0.5398 | MinRP: 0.5310
17/01/2026 20:02:47 >> VAL          Epoch:     5 | AUROC: 0.8574 | AUPRC: 0.5450 | MinRP: 0.5119
17/01/2026 20:02:47 >> AUPRC improved: 0.5187 ---> 0.5450 (+0.0263)
17/01/2026 20:02:47 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 20:02:47 >> ============================================================
17/01/2026 20:02:47 >> >>> Epoch 6/20
17/01/2026 20:04:28 >> Epoch 6 completed | Avg Loss: 0.8983
17/01/2026 20:04:36 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8778 | AUPRC: 0.5566 | MinRP: 0.5417
17/01/2026 20:04:43 >> VAL          Epoch:     6 | AUROC: 0.8608 | AUPRC: 0.5522 | MinRP: 0.5382
17/01/2026 20:04:43 >> AUPRC improved: 0.5450 ---> 0.5522 (+0.0072)
17/01/2026 20:04:43 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 20:04:43 >> ============================================================
17/01/2026 20:04:43 >> >>> Epoch 7/20
17/01/2026 20:06:29 >> Epoch 7 completed | Avg Loss: 0.8652
17/01/2026 20:06:38 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8813 | AUPRC: 0.5500 | MinRP: 0.5455
17/01/2026 20:06:46 >> VAL          Epoch:     7 | AUROC: 0.8640 | AUPRC: 0.5718 | MinRP: 0.5385
17/01/2026 20:06:46 >> AUPRC improved: 0.5522 ---> 0.5718 (+0.0196)
17/01/2026 20:06:46 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 20:06:46 >> ============================================================
17/01/2026 20:06:46 >> >>> Epoch 8/20
17/01/2026 20:08:32 >> Epoch 8 completed | Avg Loss: 0.8831
17/01/2026 20:08:41 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8865 | AUPRC: 0.5837 | MinRP: 0.5529
17/01/2026 20:08:49 >> VAL          Epoch:     8 | AUROC: 0.8628 | AUPRC: 0.5762 | MinRP: 0.5385
17/01/2026 20:08:49 >> AUPRC improved: 0.5718 ---> 0.5762 (+0.0044)
17/01/2026 20:08:49 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 20:08:49 >> ============================================================
17/01/2026 20:08:49 >> >>> Epoch 9/20
17/01/2026 20:10:35 >> Epoch 9 completed | Avg Loss: 0.8576
17/01/2026 20:10:44 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8920 | AUPRC: 0.5839 | MinRP: 0.5594
17/01/2026 20:10:53 >> VAL          Epoch:     9 | AUROC: 0.8620 | AUPRC: 0.5746 | MinRP: 0.5226
17/01/2026 20:10:53 >> No improvement. Wait: 4/5
17/01/2026 20:10:53 >> ============================================================
17/01/2026 20:10:53 >> >>> Epoch 10/20
17/01/2026 20:12:38 >> Epoch 10 completed | Avg Loss: 0.8418
17/01/2026 20:12:47 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8953 | AUPRC: 0.6072 | MinRP: 0.5714
17/01/2026 20:12:56 >> VAL          Epoch:    10 | AUROC: 0.8701 | AUPRC: 0.5923 | MinRP: 0.5315
17/01/2026 20:12:56 >> AUPRC improved: 0.5762 ---> 0.5923 (+0.0162)
17/01/2026 20:12:56 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 20:12:56 >> ============================================================
17/01/2026 20:12:56 >> >>> Epoch 11/20
17/01/2026 20:14:12 >> Epoch 11 completed | Avg Loss: 0.8411
17/01/2026 20:14:18 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8962 | AUPRC: 0.6165 | MinRP: 0.5979
17/01/2026 20:14:23 >> VAL          Epoch:    11 | AUROC: 0.8662 | AUPRC: 0.5925 | MinRP: 0.5350
17/01/2026 20:14:23 >> AUPRC improved: 0.5923 ---> 0.5925 (+0.0001)
17/01/2026 20:14:23 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 20:14:23 >> ============================================================
17/01/2026 20:14:23 >> >>> Epoch 12/20
17/01/2026 20:15:35 >> Epoch 12 completed | Avg Loss: 0.8396
17/01/2026 20:15:41 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8953 | AUPRC: 0.5981 | MinRP: 0.5664
17/01/2026 20:15:47 >> VAL          Epoch:    12 | AUROC: 0.8685 | AUPRC: 0.5776 | MinRP: 0.5226
17/01/2026 20:15:47 >> No improvement. Wait: 4/5
17/01/2026 20:15:47 >> ============================================================
17/01/2026 20:15:47 >> >>> Epoch 13/20
17/01/2026 20:16:57 >> Epoch 13 completed | Avg Loss: 0.8303
17/01/2026 20:17:03 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.9032 | AUPRC: 0.6285 | MinRP: 0.5897
17/01/2026 20:17:09 >> VAL          Epoch:    13 | AUROC: 0.8691 | AUPRC: 0.5934 | MinRP: 0.5356
17/01/2026 20:17:09 >> AUPRC improved: 0.5925 ---> 0.5934 (+0.0009)
17/01/2026 20:17:09 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 20:17:09 >> ============================================================
17/01/2026 20:17:09 >> >>> Epoch 14/20
17/01/2026 20:18:21 >> Epoch 14 completed | Avg Loss: 0.8450
17/01/2026 20:18:26 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.9029 | AUPRC: 0.6122 | MinRP: 0.5764
17/01/2026 20:18:32 >> VAL          Epoch:    14 | AUROC: 0.8648 | AUPRC: 0.5813 | MinRP: 0.5315
17/01/2026 20:18:32 >> No improvement. Wait: 4/5
17/01/2026 20:18:32 >> ============================================================
17/01/2026 20:18:32 >> >>> Epoch 15/20
17/01/2026 20:19:42 >> Epoch 15 completed | Avg Loss: 0.8241
17/01/2026 20:19:48 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.9042 | AUPRC: 0.6304 | MinRP: 0.6000
17/01/2026 20:19:51 >> VAL          Epoch:    15 | AUROC: 0.8689 | AUPRC: 0.6065 | MinRP: 0.5524
17/01/2026 20:19:51 >> AUPRC improved: 0.5934 ---> 0.6065 (+0.0131)
17/01/2026 20:19:51 >> Saving checkpoint to ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 20:19:51 >> ============================================================
17/01/2026 20:19:51 >> >>> Epoch 16/20
17/01/2026 20:20:30 >> Epoch 16 completed | Avg Loss: 0.7805
17/01/2026 20:20:33 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.9060 | AUPRC: 0.6302 | MinRP: 0.5889
17/01/2026 20:20:37 >> VAL          Epoch:    16 | AUROC: 0.8646 | AUPRC: 0.5893 | MinRP: 0.5274
17/01/2026 20:20:37 >> No improvement. Wait: 4/5
17/01/2026 20:20:37 >> ============================================================
17/01/2026 20:20:37 >> >>> Epoch 17/20
17/01/2026 20:21:15 >> Epoch 17 completed | Avg Loss: 0.8058
17/01/2026 20:21:19 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.9132 | AUPRC: 0.6517 | MinRP: 0.6154
17/01/2026 20:21:22 >> VAL          Epoch:    17 | AUROC: 0.8676 | AUPRC: 0.5853 | MinRP: 0.5433
17/01/2026 20:21:22 >> No improvement. Wait: 3/5
17/01/2026 20:21:22 >> ============================================================
17/01/2026 20:21:22 >> >>> Epoch 18/20
17/01/2026 20:21:59 >> Epoch 18 completed | Avg Loss: 0.7846
17/01/2026 20:22:03 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.9151 | AUPRC: 0.6676 | MinRP: 0.6341
17/01/2026 20:22:06 >> VAL          Epoch:    18 | AUROC: 0.8715 | AUPRC: 0.5971 | MinRP: 0.5296
17/01/2026 20:22:06 >> No improvement. Wait: 2/5
17/01/2026 20:22:06 >> ============================================================
17/01/2026 20:22:06 >> >>> Epoch 19/20
17/01/2026 20:22:45 >> Epoch 19 completed | Avg Loss: 0.8004
17/01/2026 20:22:48 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.9182 | AUPRC: 0.6759 | MinRP: 0.6332
17/01/2026 20:22:52 >> VAL          Epoch:    19 | AUROC: 0.8628 | AUPRC: 0.5809 | MinRP: 0.5354
17/01/2026 20:22:52 >> No improvement. Wait: 1/5
17/01/2026 20:22:52 >> ============================================================
17/01/2026 20:22:52 >> >>> Epoch 20/20
17/01/2026 20:23:30 >> Epoch 20 completed | Avg Loss: 0.7854
17/01/2026 20:23:33 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.9192 | AUPRC: 0.6745 | MinRP: 0.6367
17/01/2026 20:23:37 >> VAL          Epoch:    20 | AUROC: 0.8646 | AUPRC: 0.5844 | MinRP: 0.5315
17/01/2026 20:23:37 >> No improvement. Wait: 0/5
17/01/2026 20:23:37 >> Patience reached. Early stopping.

17/01/2026 20:23:37 >> ============================================================
17/01/2026 20:23:37 >> TRAINING COMPLETED
17/01/2026 20:23:37 >> ============================================================
17/01/2026 20:23:37 >> Best Validation Results:
17/01/2026 20:23:37 >>   AUROC: 0.8689 | AUPRC: 0.6065 | MinRP: 0.5524
17/01/2026 20:23:37 >> Loading best model from ../outputs/physionet_2012/strats|fold:5/checkpoint_best.bin
17/01/2026 20:23:37 >> Evaluating on test set...
17/01/2026 20:23:41 >> TEST         AUROC: 0.8559 | AUPRC: 0.5030 | MinRP: 0.4799 | Accuracy: 0.8337

17/01/2026 20:23:41 >> ============================================================
17/01/2026 20:23:41 >> Classification Report:
17/01/2026 20:23:41 >>               precision    recall  f1-score   support
17/01/2026 20:23:41 >> 
17/01/2026 20:23:41 >>          0.0     0.9361    0.8671    0.9003      2077
17/01/2026 20:23:41 >>          1.0     0.4202    0.6192    0.5006       323
17/01/2026 20:23:41 >> 
17/01/2026 20:23:41 >>     accuracy                         0.8337      2400
17/01/2026 20:23:41 >>    macro avg     0.6781    0.7432    0.7005      2400
17/01/2026 20:23:41 >> weighted avg     0.8666    0.8337    0.8465      2400
17/01/2026 20:23:41 >> 
17/01/2026 20:23:41 >> Confusion Matrix:
17/01/2026 20:23:41 >> [1801, 276]
17/01/2026 20:23:41 >> [123, 200]
17/01/2026 20:23:41 >> ============================================================
17/01/2026 20:23:41 >> Final Test Results:
17/01/2026 20:23:41 >>   AUROC: 0.8559 | AUPRC: 0.5030 | MinRP: 0.4799 | Accuracy: 0.8337
17/01/2026 20:23:41 >> ============================================================
