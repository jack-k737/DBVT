06/02/2026 10:22:11 >> Namespace(dataset='physionet_2012', model_type='dbvt', split_file='physionet_2012_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/dbvt|fold:1', lr=0.0001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:0', seed=2026, gru_hid_dim=128, gru_dropout=0.3, transformer_hid_dim=64, transformer_num_layers=2, transformer_num_heads=4, transformer_dropout=0.1, fusion_hid_dim=256, fusion_dropout=0.2, lambda_aux=0.8, lambda_cos=0.5, logger=<utils.logger.Logger object at 0x7c6e2d906140>)

06/02/2026 10:22:11 >> Preparing dataset physionet_2012
06/02/2026 10:22:12 >> Using fold 1/5
06/02/2026 10:22:12 >> Loaded splits from physionet_2012_5fold.json
06/02/2026 10:22:13 >> # train, val, test TS: [7673, 1918, 2397]
06/02/2026 10:22:13 >> pos class weight: 6.0330
06/02/2026 10:22:13 >> % pos class in train, val, test splits: [0.1422, 0.1283, 0.1544]
06/02/2026 10:22:13 >> # static features: 8
06/02/2026 10:22:13 >> # TS variables (DBVT): 36
06/02/2026 10:22:15 >> # timesteps (DBVT): 49

06/02/2026 10:22:31 >> Model details:
06/02/2026 10:22:31 >> # parameters: 378283
06/02/2026 10:22:31 >> # trainable parameters: 378283, 100.0%
06/02/2026 10:22:31 >> #params by dtype:
06/02/2026 10:22:31 >> torch.float32: 378283, 100.0%

06/02/2026 10:22:31 >> No. of training batches per epoch = 240

06/02/2026 10:22:31 >> ============================================================
06/02/2026 10:22:31 >>                Starting training...
06/02/2026 10:22:31 >> ============================================================
06/02/2026 10:22:31 >> >>> Epoch 1/20
06/02/2026 10:22:46 >> Epoch 1 completed | Avg Loss: 2.8767
06/02/2026 10:22:48 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8370 | AUPRC: 0.4673 | MinRP: 0.4730
06/02/2026 10:22:50 >> VAL          Epoch:     1 | AUROC: 0.8282 | AUPRC: 0.4462 | MinRP: 0.4777
06/02/2026 10:22:50 >> AUPRC improved: 0.0000 ---> 0.4462 (+0.4462)
06/02/2026 10:22:50 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
06/02/2026 10:22:50 >> ============================================================
06/02/2026 10:22:50 >> >>> Epoch 2/20
06/02/2026 10:23:03 >> Epoch 2 completed | Avg Loss: 2.4711
06/02/2026 10:23:04 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8597 | AUPRC: 0.5128 | MinRP: 0.5240
06/02/2026 10:23:06 >> VAL          Epoch:     2 | AUROC: 0.8595 | AUPRC: 0.5149 | MinRP: 0.5081
06/02/2026 10:23:06 >> AUPRC improved: 0.4462 ---> 0.5149 (+0.0686)
06/02/2026 10:23:06 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
06/02/2026 10:23:06 >> ============================================================
06/02/2026 10:23:06 >> >>> Epoch 3/20
06/02/2026 10:23:19 >> Epoch 3 completed | Avg Loss: 2.3097
06/02/2026 10:23:21 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8687 | AUPRC: 0.5403 | MinRP: 0.5430
06/02/2026 10:23:22 >> VAL          Epoch:     3 | AUROC: 0.8672 | AUPRC: 0.5309 | MinRP: 0.5163
06/02/2026 10:23:22 >> AUPRC improved: 0.5149 ---> 0.5309 (+0.0160)
06/02/2026 10:23:22 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
06/02/2026 10:23:22 >> ============================================================
06/02/2026 10:23:22 >> >>> Epoch 4/20
06/02/2026 10:23:37 >> Epoch 4 completed | Avg Loss: 2.2748
06/02/2026 10:23:38 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8697 | AUPRC: 0.5478 | MinRP: 0.5361
06/02/2026 10:23:39 >> VAL          Epoch:     4 | AUROC: 0.8660 | AUPRC: 0.5314 | MinRP: 0.5139
06/02/2026 10:23:39 >> AUPRC improved: 0.5309 ---> 0.5314 (+0.0005)
06/02/2026 10:23:39 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
06/02/2026 10:23:39 >> ============================================================
06/02/2026 10:23:39 >> >>> Epoch 5/20
06/02/2026 10:23:54 >> Epoch 5 completed | Avg Loss: 2.2299
06/02/2026 10:23:55 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8729 | AUPRC: 0.5647 | MinRP: 0.5436
06/02/2026 10:23:56 >> VAL          Epoch:     5 | AUROC: 0.8679 | AUPRC: 0.5285 | MinRP: 0.5301
06/02/2026 10:23:56 >> No improvement. Wait: 4/5
06/02/2026 10:23:56 >> ============================================================
06/02/2026 10:23:56 >> >>> Epoch 6/20
06/02/2026 10:24:10 >> Epoch 6 completed | Avg Loss: 2.2148
06/02/2026 10:24:12 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8757 | AUPRC: 0.5630 | MinRP: 0.5533
06/02/2026 10:24:13 >> VAL          Epoch:     6 | AUROC: 0.8690 | AUPRC: 0.5469 | MinRP: 0.5405
06/02/2026 10:24:13 >> AUPRC improved: 0.5314 ---> 0.5469 (+0.0156)
06/02/2026 10:24:13 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
06/02/2026 10:24:13 >> ============================================================
06/02/2026 10:24:13 >> >>> Epoch 7/20
06/02/2026 10:24:28 >> Epoch 7 completed | Avg Loss: 2.2078
06/02/2026 10:24:29 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8779 | AUPRC: 0.5770 | MinRP: 0.5529
06/02/2026 10:24:30 >> VAL          Epoch:     7 | AUROC: 0.8706 | AUPRC: 0.5459 | MinRP: 0.5447
06/02/2026 10:24:30 >> No improvement. Wait: 4/5
06/02/2026 10:24:30 >> ============================================================
06/02/2026 10:24:30 >> >>> Epoch 8/20
06/02/2026 10:24:45 >> Epoch 8 completed | Avg Loss: 2.1843
06/02/2026 10:24:46 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8780 | AUPRC: 0.5753 | MinRP: 0.5326
06/02/2026 10:24:47 >> VAL          Epoch:     8 | AUROC: 0.8703 | AUPRC: 0.5424 | MinRP: 0.5488
06/02/2026 10:24:47 >> No improvement. Wait: 3/5
06/02/2026 10:24:47 >> ============================================================
06/02/2026 10:24:47 >> >>> Epoch 9/20
06/02/2026 10:25:01 >> Epoch 9 completed | Avg Loss: 2.1814
06/02/2026 10:25:03 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8803 | AUPRC: 0.5793 | MinRP: 0.5387
06/02/2026 10:25:04 >> VAL          Epoch:     9 | AUROC: 0.8739 | AUPRC: 0.5458 | MinRP: 0.5569
06/02/2026 10:25:04 >> No improvement. Wait: 2/5
06/02/2026 10:25:04 >> ============================================================
06/02/2026 10:25:04 >> >>> Epoch 10/20
06/02/2026 10:25:18 >> Epoch 10 completed | Avg Loss: 2.1845
06/02/2026 10:25:19 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8826 | AUPRC: 0.5833 | MinRP: 0.5421
06/02/2026 10:25:20 >> VAL          Epoch:    10 | AUROC: 0.8744 | AUPRC: 0.5503 | MinRP: 0.5547
06/02/2026 10:25:20 >> AUPRC improved: 0.5469 ---> 0.5503 (+0.0034)
06/02/2026 10:25:20 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
06/02/2026 10:25:20 >> ============================================================
06/02/2026 10:25:20 >> >>> Epoch 11/20
06/02/2026 10:25:35 >> Epoch 11 completed | Avg Loss: 2.1648
06/02/2026 10:25:36 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8823 | AUPRC: 0.5845 | MinRP: 0.5498
06/02/2026 10:25:37 >> VAL          Epoch:    11 | AUROC: 0.8749 | AUPRC: 0.5496 | MinRP: 0.5569
06/02/2026 10:25:37 >> No improvement. Wait: 4/5
06/02/2026 10:25:37 >> ============================================================
06/02/2026 10:25:37 >> >>> Epoch 12/20
06/02/2026 10:25:51 >> Epoch 12 completed | Avg Loss: 2.1447
06/02/2026 10:25:53 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8834 | AUPRC: 0.5841 | MinRP: 0.5442
06/02/2026 10:25:54 >> VAL          Epoch:    12 | AUROC: 0.8743 | AUPRC: 0.5583 | MinRP: 0.5485
06/02/2026 10:25:54 >> AUPRC improved: 0.5503 ---> 0.5583 (+0.0080)
06/02/2026 10:25:54 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
06/02/2026 10:25:54 >> ============================================================
06/02/2026 10:25:54 >> >>> Epoch 13/20
06/02/2026 10:26:08 >> Epoch 13 completed | Avg Loss: 2.1414
06/02/2026 10:26:09 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8836 | AUPRC: 0.5843 | MinRP: 0.5430
06/02/2026 10:26:11 >> VAL          Epoch:    13 | AUROC: 0.8740 | AUPRC: 0.5551 | MinRP: 0.5640
06/02/2026 10:26:11 >> No improvement. Wait: 4/5
06/02/2026 10:26:11 >> ============================================================
06/02/2026 10:26:11 >> >>> Epoch 14/20
06/02/2026 10:26:25 >> Epoch 14 completed | Avg Loss: 2.1480
06/02/2026 10:26:26 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8853 | AUPRC: 0.5861 | MinRP: 0.5367
06/02/2026 10:26:27 >> VAL          Epoch:    14 | AUROC: 0.8726 | AUPRC: 0.5549 | MinRP: 0.5472
06/02/2026 10:26:27 >> No improvement. Wait: 3/5
06/02/2026 10:26:27 >> ============================================================
06/02/2026 10:26:27 >> >>> Epoch 15/20
06/02/2026 10:26:41 >> Epoch 15 completed | Avg Loss: 2.1276
06/02/2026 10:26:43 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.8880 | AUPRC: 0.5978 | MinRP: 0.5369
06/02/2026 10:26:44 >> VAL          Epoch:    15 | AUROC: 0.8743 | AUPRC: 0.5577 | MinRP: 0.5605
06/02/2026 10:26:44 >> No improvement. Wait: 2/5
06/02/2026 10:26:44 >> ============================================================
06/02/2026 10:26:44 >> >>> Epoch 16/20
06/02/2026 10:26:58 >> Epoch 16 completed | Avg Loss: 2.1211
06/02/2026 10:26:59 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.8897 | AUPRC: 0.5948 | MinRP: 0.5498
06/02/2026 10:27:00 >> VAL          Epoch:    16 | AUROC: 0.8747 | AUPRC: 0.5641 | MinRP: 0.5528
06/02/2026 10:27:00 >> AUPRC improved: 0.5583 ---> 0.5641 (+0.0058)
06/02/2026 10:27:00 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
06/02/2026 10:27:00 >> ============================================================
06/02/2026 10:27:00 >> >>> Epoch 17/20
06/02/2026 10:27:15 >> Epoch 17 completed | Avg Loss: 2.0836
06/02/2026 10:27:16 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.8904 | AUPRC: 0.6044 | MinRP: 0.5563
06/02/2026 10:27:17 >> VAL          Epoch:    17 | AUROC: 0.8731 | AUPRC: 0.5541 | MinRP: 0.5444
06/02/2026 10:27:17 >> No improvement. Wait: 4/5
06/02/2026 10:27:17 >> ============================================================
06/02/2026 10:27:17 >> >>> Epoch 18/20
06/02/2026 10:27:31 >> Epoch 18 completed | Avg Loss: 2.1082
06/02/2026 10:27:33 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.8908 | AUPRC: 0.6040 | MinRP: 0.5567
06/02/2026 10:27:34 >> VAL          Epoch:    18 | AUROC: 0.8721 | AUPRC: 0.5563 | MinRP: 0.5325
06/02/2026 10:27:34 >> No improvement. Wait: 3/5
06/02/2026 10:27:34 >> ============================================================
06/02/2026 10:27:34 >> >>> Epoch 19/20
06/02/2026 10:27:48 >> Epoch 19 completed | Avg Loss: 2.1036
06/02/2026 10:27:49 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.8927 | AUPRC: 0.6030 | MinRP: 0.5601
06/02/2026 10:27:50 >> VAL          Epoch:    19 | AUROC: 0.8715 | AUPRC: 0.5603 | MinRP: 0.5366
06/02/2026 10:27:50 >> No improvement. Wait: 2/5
06/02/2026 10:27:50 >> ============================================================
06/02/2026 10:27:50 >> >>> Epoch 20/20
06/02/2026 10:28:05 >> Epoch 20 completed | Avg Loss: 2.0656
06/02/2026 10:28:06 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.8937 | AUPRC: 0.6060 | MinRP: 0.5704
06/02/2026 10:28:07 >> VAL          Epoch:    20 | AUROC: 0.8726 | AUPRC: 0.5599 | MinRP: 0.5238
06/02/2026 10:28:07 >> No improvement. Wait: 1/5
06/02/2026 10:28:07 >> ============================================================

06/02/2026 10:28:07 >> ============================================================
06/02/2026 10:28:07 >> TRAINING COMPLETED
06/02/2026 10:28:07 >> ============================================================
06/02/2026 10:28:07 >> Best Validation Results:
06/02/2026 10:28:07 >>   AUROC: 0.8747 | AUPRC: 0.5641 | MinRP: 0.5528
06/02/2026 10:28:07 >> Loading best model from ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
