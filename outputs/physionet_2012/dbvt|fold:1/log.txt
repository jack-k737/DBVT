07/02/2026 20:17:57 >> Namespace(dataset='physionet_2012', model_type='dbvt', split_file='physionet_2012_5fold.json', fold=1, root_dir='/home/xiejun/codeLib/miccai', output_dir='../outputs/physionet_2012/dbvt|fold:1', lr=0.0001, train_batch_size=32, eval_batch_size=64, max_epochs=20, patience=5, validate_every=None, grad_clip_norm=0.3, max_obs=880, max_timesteps=880, device='cuda:0', seed=2026, gru_hid_dim=128, gru_dropout=0.3, transformer_hid_dim=64, transformer_num_layers=2, transformer_num_heads=4, transformer_dropout=0.1, fusion_hid_dim=256, fusion_dropout=0.2, lambda_aux=0.8, lambda_cos=0.5, logger=<utils.logger.Logger object at 0x73939561e140>)

07/02/2026 20:17:57 >> Preparing dataset physionet_2012
07/02/2026 20:17:57 >> Using fold 1/5
07/02/2026 20:17:57 >> Loaded splits from physionet_2012_5fold.json
07/02/2026 20:17:58 >> # train, val, test TS: [7673, 1918, 2397]
07/02/2026 20:17:59 >> pos class weight: 6.0330
07/02/2026 20:17:59 >> % pos class in train, val, test splits: [0.1422, 0.1283, 0.1544]
07/02/2026 20:17:59 >> # static features: 8
07/02/2026 20:17:59 >> # TS variables (DBVT): 36
07/02/2026 20:18:01 >> # timesteps (DBVT): 49

07/02/2026 20:18:19 >> Model details:
07/02/2026 20:18:19 >> # parameters: 378283
07/02/2026 20:18:19 >> # trainable parameters: 378283, 100.0%
07/02/2026 20:18:19 >> #params by dtype:
07/02/2026 20:18:19 >> torch.float32: 378283, 100.0%

07/02/2026 20:18:19 >> No. of training batches per epoch = 240

07/02/2026 20:18:19 >> ============================================================
07/02/2026 20:18:19 >>                Starting training...
07/02/2026 20:18:19 >> ============================================================
07/02/2026 20:18:19 >> >>> Epoch 1/20
07/02/2026 20:18:46 >> Epoch 1 completed | Avg Loss: 2.8767
07/02/2026 20:18:50 >> EVAL_TRAIN   Epoch:     1 | AUROC: 0.8370 | AUPRC: 0.4673 | MinRP: 0.4730
07/02/2026 20:18:52 >> VAL          Epoch:     1 | AUROC: 0.8282 | AUPRC: 0.4462 | MinRP: 0.4777
07/02/2026 20:18:52 >> AUPRC improved: 0.0000 ---> 0.4462 (+0.4462)
07/02/2026 20:18:52 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:18:52 >> ============================================================
07/02/2026 20:18:52 >> >>> Epoch 2/20
07/02/2026 20:19:18 >> Epoch 2 completed | Avg Loss: 2.4711
07/02/2026 20:19:20 >> EVAL_TRAIN   Epoch:     2 | AUROC: 0.8597 | AUPRC: 0.5128 | MinRP: 0.5240
07/02/2026 20:19:22 >> VAL          Epoch:     2 | AUROC: 0.8595 | AUPRC: 0.5149 | MinRP: 0.5081
07/02/2026 20:19:22 >> AUPRC improved: 0.4462 ---> 0.5149 (+0.0686)
07/02/2026 20:19:22 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:19:22 >> ============================================================
07/02/2026 20:19:22 >> >>> Epoch 3/20
07/02/2026 20:19:48 >> Epoch 3 completed | Avg Loss: 2.3097
07/02/2026 20:19:50 >> EVAL_TRAIN   Epoch:     3 | AUROC: 0.8687 | AUPRC: 0.5403 | MinRP: 0.5430
07/02/2026 20:19:53 >> VAL          Epoch:     3 | AUROC: 0.8672 | AUPRC: 0.5309 | MinRP: 0.5163
07/02/2026 20:19:53 >> AUPRC improved: 0.5149 ---> 0.5309 (+0.0160)
07/02/2026 20:19:53 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:19:53 >> ============================================================
07/02/2026 20:19:53 >> >>> Epoch 4/20
07/02/2026 20:20:17 >> Epoch 4 completed | Avg Loss: 2.2748
07/02/2026 20:20:18 >> EVAL_TRAIN   Epoch:     4 | AUROC: 0.8697 | AUPRC: 0.5478 | MinRP: 0.5361
07/02/2026 20:20:20 >> VAL          Epoch:     4 | AUROC: 0.8660 | AUPRC: 0.5314 | MinRP: 0.5139
07/02/2026 20:20:20 >> AUPRC improved: 0.5309 ---> 0.5314 (+0.0005)
07/02/2026 20:20:20 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:20:20 >> ============================================================
07/02/2026 20:20:20 >> >>> Epoch 5/20
07/02/2026 20:20:41 >> Epoch 5 completed | Avg Loss: 2.2299
07/02/2026 20:20:44 >> EVAL_TRAIN   Epoch:     5 | AUROC: 0.8729 | AUPRC: 0.5647 | MinRP: 0.5436
07/02/2026 20:20:46 >> VAL          Epoch:     5 | AUROC: 0.8679 | AUPRC: 0.5285 | MinRP: 0.5301
07/02/2026 20:20:46 >> No improvement. Wait: 4/5
07/02/2026 20:20:46 >> ============================================================
07/02/2026 20:20:46 >> >>> Epoch 6/20
07/02/2026 20:21:10 >> Epoch 6 completed | Avg Loss: 2.2148
07/02/2026 20:21:12 >> EVAL_TRAIN   Epoch:     6 | AUROC: 0.8757 | AUPRC: 0.5630 | MinRP: 0.5533
07/02/2026 20:21:15 >> VAL          Epoch:     6 | AUROC: 0.8690 | AUPRC: 0.5469 | MinRP: 0.5405
07/02/2026 20:21:15 >> AUPRC improved: 0.5314 ---> 0.5469 (+0.0156)
07/02/2026 20:21:15 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:21:15 >> ============================================================
07/02/2026 20:21:15 >> >>> Epoch 7/20
07/02/2026 20:21:39 >> Epoch 7 completed | Avg Loss: 2.2078
07/02/2026 20:21:42 >> EVAL_TRAIN   Epoch:     7 | AUROC: 0.8779 | AUPRC: 0.5770 | MinRP: 0.5529
07/02/2026 20:21:44 >> VAL          Epoch:     7 | AUROC: 0.8706 | AUPRC: 0.5459 | MinRP: 0.5447
07/02/2026 20:21:44 >> No improvement. Wait: 4/5
07/02/2026 20:21:44 >> ============================================================
07/02/2026 20:21:44 >> >>> Epoch 8/20
07/02/2026 20:22:08 >> Epoch 8 completed | Avg Loss: 2.1843
07/02/2026 20:22:11 >> EVAL_TRAIN   Epoch:     8 | AUROC: 0.8780 | AUPRC: 0.5753 | MinRP: 0.5326
07/02/2026 20:22:13 >> VAL          Epoch:     8 | AUROC: 0.8703 | AUPRC: 0.5424 | MinRP: 0.5488
07/02/2026 20:22:13 >> No improvement. Wait: 3/5
07/02/2026 20:22:13 >> ============================================================
07/02/2026 20:22:13 >> >>> Epoch 9/20
07/02/2026 20:22:37 >> Epoch 9 completed | Avg Loss: 2.1814
07/02/2026 20:22:40 >> EVAL_TRAIN   Epoch:     9 | AUROC: 0.8803 | AUPRC: 0.5793 | MinRP: 0.5387
07/02/2026 20:22:42 >> VAL          Epoch:     9 | AUROC: 0.8739 | AUPRC: 0.5458 | MinRP: 0.5569
07/02/2026 20:22:42 >> No improvement. Wait: 2/5
07/02/2026 20:22:42 >> ============================================================
07/02/2026 20:22:42 >> >>> Epoch 10/20
07/02/2026 20:23:06 >> Epoch 10 completed | Avg Loss: 2.1845
07/02/2026 20:23:09 >> EVAL_TRAIN   Epoch:    10 | AUROC: 0.8826 | AUPRC: 0.5833 | MinRP: 0.5421
07/02/2026 20:23:11 >> VAL          Epoch:    10 | AUROC: 0.8744 | AUPRC: 0.5503 | MinRP: 0.5547
07/02/2026 20:23:11 >> AUPRC improved: 0.5469 ---> 0.5503 (+0.0034)
07/02/2026 20:23:11 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:23:11 >> ============================================================
07/02/2026 20:23:11 >> >>> Epoch 11/20
07/02/2026 20:23:36 >> Epoch 11 completed | Avg Loss: 2.1648
07/02/2026 20:23:38 >> EVAL_TRAIN   Epoch:    11 | AUROC: 0.8823 | AUPRC: 0.5845 | MinRP: 0.5498
07/02/2026 20:23:40 >> VAL          Epoch:    11 | AUROC: 0.8749 | AUPRC: 0.5496 | MinRP: 0.5569
07/02/2026 20:23:40 >> No improvement. Wait: 4/5
07/02/2026 20:23:40 >> ============================================================
07/02/2026 20:23:40 >> >>> Epoch 12/20
07/02/2026 20:24:02 >> Epoch 12 completed | Avg Loss: 2.1447
07/02/2026 20:24:04 >> EVAL_TRAIN   Epoch:    12 | AUROC: 0.8834 | AUPRC: 0.5841 | MinRP: 0.5442
07/02/2026 20:24:06 >> VAL          Epoch:    12 | AUROC: 0.8743 | AUPRC: 0.5583 | MinRP: 0.5485
07/02/2026 20:24:06 >> AUPRC improved: 0.5503 ---> 0.5583 (+0.0080)
07/02/2026 20:24:06 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:24:06 >> ============================================================
07/02/2026 20:24:06 >> >>> Epoch 13/20
07/02/2026 20:24:27 >> Epoch 13 completed | Avg Loss: 2.1414
07/02/2026 20:24:29 >> EVAL_TRAIN   Epoch:    13 | AUROC: 0.8836 | AUPRC: 0.5843 | MinRP: 0.5430
07/02/2026 20:24:31 >> VAL          Epoch:    13 | AUROC: 0.8740 | AUPRC: 0.5551 | MinRP: 0.5640
07/02/2026 20:24:31 >> No improvement. Wait: 4/5
07/02/2026 20:24:31 >> ============================================================
07/02/2026 20:24:31 >> >>> Epoch 14/20
07/02/2026 20:24:54 >> Epoch 14 completed | Avg Loss: 2.1480
07/02/2026 20:24:57 >> EVAL_TRAIN   Epoch:    14 | AUROC: 0.8853 | AUPRC: 0.5861 | MinRP: 0.5367
07/02/2026 20:24:59 >> VAL          Epoch:    14 | AUROC: 0.8726 | AUPRC: 0.5549 | MinRP: 0.5472
07/02/2026 20:24:59 >> No improvement. Wait: 3/5
07/02/2026 20:24:59 >> ============================================================
07/02/2026 20:24:59 >> >>> Epoch 15/20
07/02/2026 20:25:22 >> Epoch 15 completed | Avg Loss: 2.1276
07/02/2026 20:25:25 >> EVAL_TRAIN   Epoch:    15 | AUROC: 0.8880 | AUPRC: 0.5978 | MinRP: 0.5369
07/02/2026 20:25:27 >> VAL          Epoch:    15 | AUROC: 0.8743 | AUPRC: 0.5577 | MinRP: 0.5605
07/02/2026 20:25:27 >> No improvement. Wait: 2/5
07/02/2026 20:25:27 >> ============================================================
07/02/2026 20:25:27 >> >>> Epoch 16/20
07/02/2026 20:25:50 >> Epoch 16 completed | Avg Loss: 2.1211
07/02/2026 20:25:52 >> EVAL_TRAIN   Epoch:    16 | AUROC: 0.8897 | AUPRC: 0.5948 | MinRP: 0.5498
07/02/2026 20:25:54 >> VAL          Epoch:    16 | AUROC: 0.8747 | AUPRC: 0.5641 | MinRP: 0.5528
07/02/2026 20:25:54 >> AUPRC improved: 0.5583 ---> 0.5641 (+0.0058)
07/02/2026 20:25:54 >> Saving checkpoint to ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:25:54 >> ============================================================
07/02/2026 20:25:54 >> >>> Epoch 17/20
07/02/2026 20:26:18 >> Epoch 17 completed | Avg Loss: 2.0836
07/02/2026 20:26:20 >> EVAL_TRAIN   Epoch:    17 | AUROC: 0.8904 | AUPRC: 0.6044 | MinRP: 0.5563
07/02/2026 20:26:22 >> VAL          Epoch:    17 | AUROC: 0.8731 | AUPRC: 0.5541 | MinRP: 0.5444
07/02/2026 20:26:22 >> No improvement. Wait: 4/5
07/02/2026 20:26:22 >> ============================================================
07/02/2026 20:26:22 >> >>> Epoch 18/20
07/02/2026 20:26:45 >> Epoch 18 completed | Avg Loss: 2.1082
07/02/2026 20:26:48 >> EVAL_TRAIN   Epoch:    18 | AUROC: 0.8908 | AUPRC: 0.6040 | MinRP: 0.5567
07/02/2026 20:26:50 >> VAL          Epoch:    18 | AUROC: 0.8721 | AUPRC: 0.5563 | MinRP: 0.5325
07/02/2026 20:26:50 >> No improvement. Wait: 3/5
07/02/2026 20:26:50 >> ============================================================
07/02/2026 20:26:50 >> >>> Epoch 19/20
07/02/2026 20:27:13 >> Epoch 19 completed | Avg Loss: 2.1036
07/02/2026 20:27:15 >> EVAL_TRAIN   Epoch:    19 | AUROC: 0.8927 | AUPRC: 0.6030 | MinRP: 0.5601
07/02/2026 20:27:17 >> VAL          Epoch:    19 | AUROC: 0.8715 | AUPRC: 0.5603 | MinRP: 0.5366
07/02/2026 20:27:17 >> No improvement. Wait: 2/5
07/02/2026 20:27:17 >> ============================================================
07/02/2026 20:27:17 >> >>> Epoch 20/20
07/02/2026 20:27:40 >> Epoch 20 completed | Avg Loss: 2.0656
07/02/2026 20:27:42 >> EVAL_TRAIN   Epoch:    20 | AUROC: 0.8937 | AUPRC: 0.6060 | MinRP: 0.5704
07/02/2026 20:27:44 >> VAL          Epoch:    20 | AUROC: 0.8726 | AUPRC: 0.5599 | MinRP: 0.5238
07/02/2026 20:27:44 >> No improvement. Wait: 1/5
07/02/2026 20:27:44 >> ============================================================

07/02/2026 20:27:44 >> ============================================================
07/02/2026 20:27:44 >> TRAINING COMPLETED
07/02/2026 20:27:44 >> ============================================================
07/02/2026 20:27:44 >> Best Validation Results:
07/02/2026 20:27:44 >>   AUROC: 0.8747 | AUPRC: 0.5641 | MinRP: 0.5528
07/02/2026 20:27:44 >> Loading best model from ../outputs/physionet_2012/dbvt|fold:1/checkpoint_best.bin
07/02/2026 20:27:44 >> Evaluating on test set...
07/02/2026 20:27:47 >> TEST         AUROC: 0.8761 | AUPRC: 0.6274 | MinRP: 0.5845 | Accuracy: 0.7797

07/02/2026 20:27:47 >> ============================================================
07/02/2026 20:27:47 >> Classification Report:
07/02/2026 20:27:47 >>               precision    recall  f1-score   support
07/02/2026 20:27:47 >> 
07/02/2026 20:27:47 >>          0.0     0.9540    0.7770    0.8564      2027
07/02/2026 20:27:47 >>          1.0     0.3941    0.7946    0.5269       370
07/02/2026 20:27:47 >> 
07/02/2026 20:27:47 >>     accuracy                         0.7797      2397
07/02/2026 20:27:47 >>    macro avg     0.6740    0.7858    0.6917      2397
07/02/2026 20:27:47 >> weighted avg     0.8675    0.7797    0.8056      2397
07/02/2026 20:27:47 >> 
07/02/2026 20:27:47 >> Confusion Matrix:
07/02/2026 20:27:47 >> [1575, 452]
07/02/2026 20:27:47 >> [76, 294]
07/02/2026 20:27:47 >> ============================================================
07/02/2026 20:27:47 >> Final Test Results:
07/02/2026 20:27:47 >>   AUROC: 0.8761 | AUPRC: 0.6274 | MinRP: 0.5845 | Accuracy: 0.7797
07/02/2026 20:27:47 >> ============================================================
